import{j as S}from"./animation-BuvATFQ7.js";import{a as xf,r as T,g as wf,R as Sf}from"./react-vendor-F9Y4d3HK.js";import{R as Pu,O as Gr,P as Gl,S as an,a as gl,V as Ef,b as Rf,B as Mf,N as ku,A as zu,W as Wr,C as Cf,c as Le,d as Ce,e as ns,f as Wl,M as Vl,L as yl,T as Xl,g as _f,U as Mn,h as or,i as Tf,j as jr,k as Fl,l as bf,m as Pf,n as Ht,o as Yl,p as nt,q as Qe,r as kf,s as Or,t as Au,u as zf,v as Af,w as Nf,x as If,I as Lf,y as Ff,z as Bf,D as Uf,E as Df,F as Of,G as jf,H as Hf,J as Cn,K as Ki,Q as ke,X as rs,Y as Vi,Z as Gf,_ as ql,$ as Nu,a0 as Iu,a1 as cr,a2 as Lu,a3 as Wf,a4 as Io,a5 as Jt}from"./three-Je9VoXOv.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const f of o)if(f.type==="childList")for(const c of f.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function i(o){const f={};return o.integrity&&(f.integrity=o.integrity),o.referrerPolicy&&(f.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?f.credentials="include":o.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function a(o){if(o.ep)return;o.ep=!0;const f=i(o);fetch(o.href,f)}})();var Bl={},Lo=xf;Bl.createRoot=Lo.createRoot,Bl.hydrateRoot=Lo.hydrateRoot;function Hr(t){let e=t[0],i=t[1],a=t[2];return Math.sqrt(e*e+i*i+a*a)}function Ul(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Vf(t,e,i,a){return t[0]=e,t[1]=i,t[2]=a,t}function Fo(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t}function Bo(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t}function Xf(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t}function Yf(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t}function xl(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}function qf(t,e){let i=e[0]-t[0],a=e[1]-t[1],o=e[2]-t[2];return Math.sqrt(i*i+a*a+o*o)}function Qf(t,e){let i=e[0]-t[0],a=e[1]-t[1],o=e[2]-t[2];return i*i+a*a+o*o}function Uo(t){let e=t[0],i=t[1],a=t[2];return e*e+i*i+a*a}function Zf(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Kf(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function Dl(t,e){let i=e[0],a=e[1],o=e[2],f=i*i+a*a+o*o;return f>0&&(f=1/Math.sqrt(f)),t[0]=e[0]*f,t[1]=e[1]*f,t[2]=e[2]*f,t}function Fu(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Do(t,e,i){let a=e[0],o=e[1],f=e[2],c=i[0],p=i[1],d=i[2];return t[0]=o*d-f*p,t[1]=f*c-a*d,t[2]=a*p-o*c,t}function Jf(t,e,i,a){let o=e[0],f=e[1],c=e[2];return t[0]=o+a*(i[0]-o),t[1]=f+a*(i[1]-f),t[2]=c+a*(i[2]-c),t}function $f(t,e,i,a,o){const f=Math.exp(-a*o);let c=e[0],p=e[1],d=e[2];return t[0]=i[0]+(c-i[0])*f,t[1]=i[1]+(p-i[1])*f,t[2]=i[2]+(d-i[2])*f,t}function ed(t,e,i){let a=e[0],o=e[1],f=e[2],c=i[3]*a+i[7]*o+i[11]*f+i[15];return c=c||1,t[0]=(i[0]*a+i[4]*o+i[8]*f+i[12])/c,t[1]=(i[1]*a+i[5]*o+i[9]*f+i[13])/c,t[2]=(i[2]*a+i[6]*o+i[10]*f+i[14])/c,t}function td(t,e,i){let a=e[0],o=e[1],f=e[2],c=i[3]*a+i[7]*o+i[11]*f+i[15];return c=c||1,t[0]=(i[0]*a+i[4]*o+i[8]*f)/c,t[1]=(i[1]*a+i[5]*o+i[9]*f)/c,t[2]=(i[2]*a+i[6]*o+i[10]*f)/c,t}function nd(t,e,i){let a=e[0],o=e[1],f=e[2];return t[0]=a*i[0]+o*i[3]+f*i[6],t[1]=a*i[1]+o*i[4]+f*i[7],t[2]=a*i[2]+o*i[5]+f*i[8],t}function rd(t,e,i){let a=e[0],o=e[1],f=e[2],c=i[0],p=i[1],d=i[2],g=i[3],v=p*f-d*o,m=d*a-c*f,y=c*o-p*a,x=p*y-d*m,w=d*v-c*y,M=c*m-p*v,R=g*2;return v*=R,m*=R,y*=R,x*=2,w*=2,M*=2,t[0]=a+v+x,t[1]=o+m+w,t[2]=f+y+M,t}const id=function(){const t=[0,0,0],e=[0,0,0];return function(i,a){Ul(t,i),Ul(e,a),Dl(t,t),Dl(e,e);let o=Fu(t,e);return o>1?0:o<-1?Math.PI:Math.acos(o)}}();function sd(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}class jt extends Array{constructor(e=0,i=e,a=e){return super(e,i,a),this}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}set x(e){this[0]=e}set y(e){this[1]=e}set z(e){this[2]=e}set(e,i=e,a=e){return e.length?this.copy(e):(Vf(this,e,i,a),this)}copy(e){return Ul(this,e),this}add(e,i){return i?Fo(this,e,i):Fo(this,this,e),this}sub(e,i){return i?Bo(this,e,i):Bo(this,this,e),this}multiply(e){return e.length?Xf(this,this,e):xl(this,this,e),this}divide(e){return e.length?Yf(this,this,e):xl(this,this,1/e),this}inverse(e=this){return Kf(this,e),this}len(){return Hr(this)}distance(e){return e?qf(this,e):Hr(this)}squaredLen(){return Uo(this)}squaredDistance(e){return e?Qf(this,e):Uo(this)}negate(e=this){return Zf(this,e),this}cross(e,i){return i?Do(this,e,i):Do(this,this,e),this}scale(e){return xl(this,this,e),this}normalize(){return Dl(this,this),this}dot(e){return Fu(this,e)}equals(e){return sd(this,e)}applyMatrix3(e){return nd(this,this,e),this}applyMatrix4(e){return ed(this,this,e),this}scaleRotateMatrix4(e){return td(this,this,e),this}applyQuaternion(e){return rd(this,this,e),this}angle(e){return id(this,e)}lerp(e,i){return Jf(this,this,e,i),this}smoothLerp(e,i,a){return $f(this,this,e,i,a),this}clone(){return new jt(this[0],this[1],this[2])}fromArray(e,i=0){return this[0]=e[i],this[1]=e[i+1],this[2]=e[i+2],this}toArray(e=[],i=0){return e[i]=this[0],e[i+1]=this[1],e[i+2]=this[2],e}transformDirection(e){const i=this[0],a=this[1],o=this[2];return this[0]=e[0]*i+e[4]*a+e[8]*o,this[1]=e[1]*i+e[5]*a+e[9]*o,this[2]=e[2]*i+e[6]*a+e[10]*o,this.normalize()}}const Oo=new jt;let ld=1,ad=1,jo=!1;class od{constructor(e,i={}){e.canvas||console.error("gl not passed as first argument to Geometry"),this.gl=e,this.attributes=i,this.id=ld++,this.VAOs={},this.drawRange={start:0,count:0},this.instancedCount=0,this.gl.renderer.bindVertexArray(null),this.gl.renderer.currentGeometry=null,this.glState=this.gl.renderer.state;for(let a in i)this.addAttribute(a,i[a])}addAttribute(e,i){if(this.attributes[e]=i,i.id=ad++,i.size=i.size||1,i.type=i.type||(i.data.constructor===Float32Array?this.gl.FLOAT:i.data.constructor===Uint16Array?this.gl.UNSIGNED_SHORT:this.gl.UNSIGNED_INT),i.target=e==="index"?this.gl.ELEMENT_ARRAY_BUFFER:this.gl.ARRAY_BUFFER,i.normalized=i.normalized||!1,i.stride=i.stride||0,i.offset=i.offset||0,i.count=i.count||(i.stride?i.data.byteLength/i.stride:i.data.length/i.size),i.divisor=i.instanced||0,i.needsUpdate=!1,i.usage=i.usage||this.gl.STATIC_DRAW,i.buffer||this.updateAttribute(i),i.divisor){if(this.isInstanced=!0,this.instancedCount&&this.instancedCount!==i.count*i.divisor)return console.warn("geometry has multiple instanced buffers of different length"),this.instancedCount=Math.min(this.instancedCount,i.count*i.divisor);this.instancedCount=i.count*i.divisor}else e==="index"?this.drawRange.count=i.count:this.attributes.index||(this.drawRange.count=Math.max(this.drawRange.count,i.count))}updateAttribute(e){const i=!e.buffer;i&&(e.buffer=this.gl.createBuffer()),this.glState.boundBuffer!==e.buffer&&(this.gl.bindBuffer(e.target,e.buffer),this.glState.boundBuffer=e.buffer),i?this.gl.bufferData(e.target,e.data,e.usage):this.gl.bufferSubData(e.target,0,e.data),e.needsUpdate=!1}setIndex(e){this.addAttribute("index",e)}setDrawRange(e,i){this.drawRange.start=e,this.drawRange.count=i}setInstancedCount(e){this.instancedCount=e}createVAO(e){this.VAOs[e.attributeOrder]=this.gl.renderer.createVertexArray(),this.gl.renderer.bindVertexArray(this.VAOs[e.attributeOrder]),this.bindAttributes(e)}bindAttributes(e){e.attributeLocations.forEach((i,{name:a,type:o})=>{if(!this.attributes[a]){console.warn(`active attribute ${a} not being supplied`);return}const f=this.attributes[a];this.gl.bindBuffer(f.target,f.buffer),this.glState.boundBuffer=f.buffer;let c=1;o===35674&&(c=2),o===35675&&(c=3),o===35676&&(c=4);const p=f.size/c,d=c===1?0:c*c*4,g=c===1?0:c*4;for(let v=0;v<c;v++)this.gl.vertexAttribPointer(i+v,p,f.type,f.normalized,f.stride+d,f.offset+v*g),this.gl.enableVertexAttribArray(i+v),this.gl.renderer.vertexAttribDivisor(i+v,f.divisor)}),this.attributes.index&&this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.attributes.index.buffer)}draw({program:e,mode:i=this.gl.TRIANGLES}){var o;this.gl.renderer.currentGeometry!==`${this.id}_${e.attributeOrder}`&&(this.VAOs[e.attributeOrder]||this.createVAO(e),this.gl.renderer.bindVertexArray(this.VAOs[e.attributeOrder]),this.gl.renderer.currentGeometry=`${this.id}_${e.attributeOrder}`),e.attributeLocations.forEach((f,{name:c})=>{const p=this.attributes[c];p.needsUpdate&&this.updateAttribute(p)});let a=2;((o=this.attributes.index)==null?void 0:o.type)===this.gl.UNSIGNED_INT&&(a=4),this.isInstanced?this.attributes.index?this.gl.renderer.drawElementsInstanced(i,this.drawRange.count,this.attributes.index.type,this.attributes.index.offset+this.drawRange.start*a,this.instancedCount):this.gl.renderer.drawArraysInstanced(i,this.drawRange.start,this.drawRange.count,this.instancedCount):this.attributes.index?this.gl.drawElements(i,this.drawRange.count,this.attributes.index.type,this.attributes.index.offset+this.drawRange.start*a):this.gl.drawArrays(i,this.drawRange.start,this.drawRange.count)}getPosition(){const e=this.attributes.position;if(e.data)return e;if(!jo)return console.warn("No position buffer data found to compute bounds"),jo=!0}computeBoundingBox(e){e||(e=this.getPosition());const i=e.data,a=e.size;this.bounds||(this.bounds={min:new jt,max:new jt,center:new jt,scale:new jt,radius:1/0});const o=this.bounds.min,f=this.bounds.max,c=this.bounds.center,p=this.bounds.scale;o.set(1/0),f.set(-1/0);for(let d=0,g=i.length;d<g;d+=a){const v=i[d],m=i[d+1],y=i[d+2];o.x=Math.min(v,o.x),o.y=Math.min(m,o.y),o.z=Math.min(y,o.z),f.x=Math.max(v,f.x),f.y=Math.max(m,f.y),f.z=Math.max(y,f.z)}p.sub(f,o),c.add(o,f).divide(2)}computeBoundingSphere(e){e||(e=this.getPosition());const i=e.data,a=e.size;this.bounds||this.computeBoundingBox(e);let o=0;for(let f=0,c=i.length;f<c;f+=a)Oo.fromArray(i,f),o=Math.max(o,this.bounds.center.squaredDistance(Oo));this.bounds.radius=Math.sqrt(o)}remove(){for(let e in this.VAOs)this.gl.renderer.deleteVertexArray(this.VAOs[e]),delete this.VAOs[e];for(let e in this.attributes)this.gl.deleteBuffer(this.attributes[e].buffer),delete this.attributes[e]}}let ud=1;const Ho={};class fr{constructor(e,{vertex:i,fragment:a,uniforms:o={},transparent:f=!1,cullFace:c=e.BACK,frontFace:p=e.CCW,depthTest:d=!0,depthWrite:g=!0,depthFunc:v=e.LEQUAL}={}){e.canvas||console.error("gl not passed as first argument to Program"),this.gl=e,this.uniforms=o,this.id=ud++,i||console.warn("vertex shader not supplied"),a||console.warn("fragment shader not supplied"),this.transparent=f,this.cullFace=c,this.frontFace=p,this.depthTest=d,this.depthWrite=g,this.depthFunc=v,this.blendFunc={},this.blendEquation={},this.stencilFunc={},this.stencilOp={},this.transparent&&!this.blendFunc.src&&(this.gl.renderer.premultipliedAlpha?this.setBlendFunc(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA):this.setBlendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA)),this.vertexShader=e.createShader(e.VERTEX_SHADER),this.fragmentShader=e.createShader(e.FRAGMENT_SHADER),this.program=e.createProgram(),e.attachShader(this.program,this.vertexShader),e.attachShader(this.program,this.fragmentShader),this.setShaders({vertex:i,fragment:a})}setShaders({vertex:e,fragment:i}){if(e&&(this.gl.shaderSource(this.vertexShader,e),this.gl.compileShader(this.vertexShader),this.gl.getShaderInfoLog(this.vertexShader)!==""&&console.warn(`${this.gl.getShaderInfoLog(this.vertexShader)}
Vertex Shader
${Go(e)}`)),i&&(this.gl.shaderSource(this.fragmentShader,i),this.gl.compileShader(this.fragmentShader),this.gl.getShaderInfoLog(this.fragmentShader)!==""&&console.warn(`${this.gl.getShaderInfoLog(this.fragmentShader)}
Fragment Shader
${Go(i)}`)),this.gl.linkProgram(this.program),!this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS))return console.warn(this.gl.getProgramInfoLog(this.program));this.uniformLocations=new Map;let a=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_UNIFORMS);for(let c=0;c<a;c++){let p=this.gl.getActiveUniform(this.program,c);this.uniformLocations.set(p,this.gl.getUniformLocation(this.program,p.name));const d=p.name.match(/(\w+)/g);p.uniformName=d[0],p.nameComponents=d.slice(1)}this.attributeLocations=new Map;const o=[],f=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES);for(let c=0;c<f;c++){const p=this.gl.getActiveAttrib(this.program,c),d=this.gl.getAttribLocation(this.program,p.name);d!==-1&&(o[d]=p.name,this.attributeLocations.set(p,d))}this.attributeOrder=o.join("")}setBlendFunc(e,i,a,o){this.blendFunc.src=e,this.blendFunc.dst=i,this.blendFunc.srcAlpha=a,this.blendFunc.dstAlpha=o,e&&(this.transparent=!0)}setBlendEquation(e,i){this.blendEquation.modeRGB=e,this.blendEquation.modeAlpha=i}setStencilFunc(e,i,a){this.stencilRef=i,this.stencilFunc.func=e,this.stencilFunc.ref=i,this.stencilFunc.mask=a}setStencilOp(e,i,a){this.stencilOp.stencilFail=e,this.stencilOp.depthFail=i,this.stencilOp.depthPass=a}applyState(){this.depthTest?this.gl.renderer.enable(this.gl.DEPTH_TEST):this.gl.renderer.disable(this.gl.DEPTH_TEST),this.cullFace?this.gl.renderer.enable(this.gl.CULL_FACE):this.gl.renderer.disable(this.gl.CULL_FACE),this.blendFunc.src?this.gl.renderer.enable(this.gl.BLEND):this.gl.renderer.disable(this.gl.BLEND),this.cullFace&&this.gl.renderer.setCullFace(this.cullFace),this.gl.renderer.setFrontFace(this.frontFace),this.gl.renderer.setDepthMask(this.depthWrite),this.gl.renderer.setDepthFunc(this.depthFunc),this.blendFunc.src&&this.gl.renderer.setBlendFunc(this.blendFunc.src,this.blendFunc.dst,this.blendFunc.srcAlpha,this.blendFunc.dstAlpha),this.gl.renderer.setBlendEquation(this.blendEquation.modeRGB,this.blendEquation.modeAlpha),this.stencilFunc.func||this.stencilOp.stencilFail?this.gl.renderer.enable(this.gl.STENCIL_TEST):this.gl.renderer.disable(this.gl.STENCIL_TEST),this.gl.renderer.setStencilFunc(this.stencilFunc.func,this.stencilFunc.ref,this.stencilFunc.mask),this.gl.renderer.setStencilOp(this.stencilOp.stencilFail,this.stencilOp.depthFail,this.stencilOp.depthPass)}use({flipFaces:e=!1}={}){let i=-1;this.gl.renderer.state.currentProgram===this.id||(this.gl.useProgram(this.program),this.gl.renderer.state.currentProgram=this.id),this.uniformLocations.forEach((o,f)=>{let c=this.uniforms[f.uniformName];for(const p of f.nameComponents){if(!c)break;if(p in c)c=c[p];else{if(Array.isArray(c.value))break;c=void 0;break}}if(!c)return Wo(`Active uniform ${f.name} has not been supplied`);if(c&&c.value===void 0)return Wo(`${f.name} uniform is missing a value parameter`);if(c.value.texture)return i=i+1,c.value.update(i),wl(this.gl,f.type,o,i);if(c.value.length&&c.value[0].texture){const p=[];return c.value.forEach(d=>{i=i+1,d.update(i),p.push(i)}),wl(this.gl,f.type,o,p)}wl(this.gl,f.type,o,c.value)}),this.applyState(),e&&this.gl.renderer.setFrontFace(this.frontFace===this.gl.CCW?this.gl.CW:this.gl.CCW)}remove(){this.gl.deleteProgram(this.program)}}function wl(t,e,i,a){a=a.length?cd(a):a;const o=t.renderer.state.uniformLocations.get(i);if(a.length)if(o===void 0||o.length!==a.length)t.renderer.state.uniformLocations.set(i,a.slice(0));else{if(fd(o,a))return;o.set?o.set(a):dd(o,a),t.renderer.state.uniformLocations.set(i,o)}else{if(o===a)return;t.renderer.state.uniformLocations.set(i,a)}switch(e){case 5126:return a.length?t.uniform1fv(i,a):t.uniform1f(i,a);case 35664:return t.uniform2fv(i,a);case 35665:return t.uniform3fv(i,a);case 35666:return t.uniform4fv(i,a);case 35670:case 5124:case 35678:case 36306:case 35680:case 36289:return a.length?t.uniform1iv(i,a):t.uniform1i(i,a);case 35671:case 35667:return t.uniform2iv(i,a);case 35672:case 35668:return t.uniform3iv(i,a);case 35673:case 35669:return t.uniform4iv(i,a);case 35674:return t.uniformMatrix2fv(i,!1,a);case 35675:return t.uniformMatrix3fv(i,!1,a);case 35676:return t.uniformMatrix4fv(i,!1,a)}}function Go(t){let e=t.split(`
`);for(let i=0;i<e.length;i++)e[i]=i+1+": "+e[i];return e.join(`
`)}function cd(t){const e=t.length,i=t[0].length;if(i===void 0)return t;const a=e*i;let o=Ho[a];o||(Ho[a]=o=new Float32Array(a));for(let f=0;f<e;f++)o.set(t[f],f*i);return o}function fd(t,e){if(t.length!==e.length)return!1;for(let i=0,a=t.length;i<a;i++)if(t[i]!==e[i])return!1;return!0}function dd(t,e){for(let i=0,a=t.length;i<a;i++)t[i]=e[i]}let Sl=0;function Wo(t){Sl>100||(console.warn(t),Sl++,Sl>100&&console.warn("More than 100 program warnings - stopping logs."))}const El=new jt;let hd=1;class dr{constructor({canvas:e=document.createElement("canvas"),width:i=300,height:a=150,dpr:o=1,alpha:f=!1,depth:c=!0,stencil:p=!1,antialias:d=!1,premultipliedAlpha:g=!1,preserveDrawingBuffer:v=!1,powerPreference:m="default",autoClear:y=!0,webgl:x=2}={}){const w={alpha:f,depth:c,stencil:p,antialias:d,premultipliedAlpha:g,preserveDrawingBuffer:v,powerPreference:m};this.dpr=o,this.alpha=f,this.color=!0,this.depth=c,this.stencil=p,this.premultipliedAlpha=g,this.autoClear=y,this.id=hd++,x===2&&(this.gl=e.getContext("webgl2",w)),this.isWebgl2=!!this.gl,this.gl||(this.gl=e.getContext("webgl",w)),this.gl||console.error("unable to create webgl context"),this.gl.renderer=this,this.setSize(i,a),this.state={},this.state.blendFunc={src:this.gl.ONE,dst:this.gl.ZERO},this.state.blendEquation={modeRGB:this.gl.FUNC_ADD},this.state.cullFace=!1,this.state.frontFace=this.gl.CCW,this.state.depthMask=!0,this.state.depthFunc=this.gl.LEQUAL,this.state.premultiplyAlpha=!1,this.state.flipY=!1,this.state.unpackAlignment=4,this.state.framebuffer=null,this.state.viewport={x:0,y:0,width:null,height:null},this.state.textureUnits=[],this.state.activeTextureUnit=0,this.state.boundBuffer=null,this.state.uniformLocations=new Map,this.state.currentProgram=null,this.extensions={},this.isWebgl2?(this.getExtension("EXT_color_buffer_float"),this.getExtension("OES_texture_float_linear")):(this.getExtension("OES_texture_float"),this.getExtension("OES_texture_float_linear"),this.getExtension("OES_texture_half_float"),this.getExtension("OES_texture_half_float_linear"),this.getExtension("OES_element_index_uint"),this.getExtension("OES_standard_derivatives"),this.getExtension("EXT_sRGB"),this.getExtension("WEBGL_depth_texture"),this.getExtension("WEBGL_draw_buffers")),this.getExtension("WEBGL_compressed_texture_astc"),this.getExtension("EXT_texture_compression_bptc"),this.getExtension("WEBGL_compressed_texture_s3tc"),this.getExtension("WEBGL_compressed_texture_etc1"),this.getExtension("WEBGL_compressed_texture_pvrtc"),this.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),this.vertexAttribDivisor=this.getExtension("ANGLE_instanced_arrays","vertexAttribDivisor","vertexAttribDivisorANGLE"),this.drawArraysInstanced=this.getExtension("ANGLE_instanced_arrays","drawArraysInstanced","drawArraysInstancedANGLE"),this.drawElementsInstanced=this.getExtension("ANGLE_instanced_arrays","drawElementsInstanced","drawElementsInstancedANGLE"),this.createVertexArray=this.getExtension("OES_vertex_array_object","createVertexArray","createVertexArrayOES"),this.bindVertexArray=this.getExtension("OES_vertex_array_object","bindVertexArray","bindVertexArrayOES"),this.deleteVertexArray=this.getExtension("OES_vertex_array_object","deleteVertexArray","deleteVertexArrayOES"),this.drawBuffers=this.getExtension("WEBGL_draw_buffers","drawBuffers","drawBuffersWEBGL"),this.parameters={},this.parameters.maxTextureUnits=this.gl.getParameter(this.gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS),this.parameters.maxAnisotropy=this.getExtension("EXT_texture_filter_anisotropic")?this.gl.getParameter(this.getExtension("EXT_texture_filter_anisotropic").MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}setSize(e,i){this.width=e,this.height=i,this.gl.canvas.width=e*this.dpr,this.gl.canvas.height=i*this.dpr,this.gl.canvas.style&&Object.assign(this.gl.canvas.style,{width:e+"px",height:i+"px"})}setViewport(e,i,a=0,o=0){this.state.viewport.width===e&&this.state.viewport.height===i||(this.state.viewport.width=e,this.state.viewport.height=i,this.state.viewport.x=a,this.state.viewport.y=o,this.gl.viewport(a,o,e,i))}setScissor(e,i,a=0,o=0){this.gl.scissor(a,o,e,i)}enable(e){this.state[e]!==!0&&(this.gl.enable(e),this.state[e]=!0)}disable(e){this.state[e]!==!1&&(this.gl.disable(e),this.state[e]=!1)}setBlendFunc(e,i,a,o){this.state.blendFunc.src===e&&this.state.blendFunc.dst===i&&this.state.blendFunc.srcAlpha===a&&this.state.blendFunc.dstAlpha===o||(this.state.blendFunc.src=e,this.state.blendFunc.dst=i,this.state.blendFunc.srcAlpha=a,this.state.blendFunc.dstAlpha=o,a!==void 0?this.gl.blendFuncSeparate(e,i,a,o):this.gl.blendFunc(e,i))}setBlendEquation(e,i){e=e||this.gl.FUNC_ADD,!(this.state.blendEquation.modeRGB===e&&this.state.blendEquation.modeAlpha===i)&&(this.state.blendEquation.modeRGB=e,this.state.blendEquation.modeAlpha=i,i!==void 0?this.gl.blendEquationSeparate(e,i):this.gl.blendEquation(e))}setCullFace(e){this.state.cullFace!==e&&(this.state.cullFace=e,this.gl.cullFace(e))}setFrontFace(e){this.state.frontFace!==e&&(this.state.frontFace=e,this.gl.frontFace(e))}setDepthMask(e){this.state.depthMask!==e&&(this.state.depthMask=e,this.gl.depthMask(e))}setDepthFunc(e){this.state.depthFunc!==e&&(this.state.depthFunc=e,this.gl.depthFunc(e))}setStencilMask(e){this.state.stencilMask!==e&&(this.state.stencilMask=e,this.gl.stencilMask(e))}setStencilFunc(e,i,a){this.state.stencilFunc===e&&this.state.stencilRef===i&&this.state.stencilFuncMask===a||(this.state.stencilFunc=e||this.gl.ALWAYS,this.state.stencilRef=i||0,this.state.stencilFuncMask=a||0,this.gl.stencilFunc(e||this.gl.ALWAYS,i||0,a||0))}setStencilOp(e,i,a){this.state.stencilFail===e&&this.state.stencilDepthFail===i&&this.state.stencilDepthPass===a||(this.state.stencilFail=e,this.state.stencilDepthFail=i,this.state.stencilDepthPass=a,this.gl.stencilOp(e,i,a))}activeTexture(e){this.state.activeTextureUnit!==e&&(this.state.activeTextureUnit=e,this.gl.activeTexture(this.gl.TEXTURE0+e))}bindFramebuffer({target:e=this.gl.FRAMEBUFFER,buffer:i=null}={}){this.state.framebuffer!==i&&(this.state.framebuffer=i,this.gl.bindFramebuffer(e,i))}getExtension(e,i,a){return i&&this.gl[i]?this.gl[i].bind(this.gl):(this.extensions[e]||(this.extensions[e]=this.gl.getExtension(e)),i?this.extensions[e]?this.extensions[e][a].bind(this.extensions[e]):null:this.extensions[e])}sortOpaque(e,i){return e.renderOrder!==i.renderOrder?e.renderOrder-i.renderOrder:e.program.id!==i.program.id?e.program.id-i.program.id:e.zDepth!==i.zDepth?e.zDepth-i.zDepth:i.id-e.id}sortTransparent(e,i){return e.renderOrder!==i.renderOrder?e.renderOrder-i.renderOrder:e.zDepth!==i.zDepth?i.zDepth-e.zDepth:i.id-e.id}sortUI(e,i){return e.renderOrder!==i.renderOrder?e.renderOrder-i.renderOrder:e.program.id!==i.program.id?e.program.id-i.program.id:i.id-e.id}getRenderList({scene:e,camera:i,frustumCull:a,sort:o}){let f=[];if(i&&a&&i.updateFrustum(),e.traverse(c=>{if(!c.visible)return!0;c.draw&&(a&&c.frustumCulled&&i&&!i.frustumIntersectsMesh(c)||f.push(c))}),o){const c=[],p=[],d=[];f.forEach(g=>{g.program.transparent?g.program.depthTest?p.push(g):d.push(g):c.push(g),g.zDepth=0,!(g.renderOrder!==0||!g.program.depthTest||!i)&&(g.worldMatrix.getTranslation(El),El.applyMatrix4(i.projectionViewMatrix),g.zDepth=El.z)}),c.sort(this.sortOpaque),p.sort(this.sortTransparent),d.sort(this.sortUI),f=c.concat(p,d)}return f}render({scene:e,camera:i,target:a=null,update:o=!0,sort:f=!0,frustumCull:c=!0,clear:p}){a===null?(this.bindFramebuffer(),this.setViewport(this.width*this.dpr,this.height*this.dpr)):(this.bindFramebuffer(a),this.setViewport(a.width,a.height)),(p||this.autoClear&&p!==!1)&&(this.depth&&(!a||a.depth)&&(this.enable(this.gl.DEPTH_TEST),this.setDepthMask(!0)),(this.stencil||!a||a.stencil)&&(this.enable(this.gl.STENCIL_TEST),this.setStencilMask(255)),this.gl.clear((this.color?this.gl.COLOR_BUFFER_BIT:0)|(this.depth?this.gl.DEPTH_BUFFER_BIT:0)|(this.stencil?this.gl.STENCIL_BUFFER_BIT:0))),o&&e.updateMatrixWorld(),i&&i.updateMatrixWorld(),this.getRenderList({scene:e,camera:i,frustumCull:c,sort:f}).forEach(g=>{g.draw({camera:i})})}}function pd(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function md(t,e,i,a,o){return t[0]=e,t[1]=i,t[2]=a,t[3]=o,t}function vd(t,e){let i=e[0],a=e[1],o=e[2],f=e[3],c=i*i+a*a+o*o+f*f;return c>0&&(c=1/Math.sqrt(c)),t[0]=i*c,t[1]=a*c,t[2]=o*c,t[3]=f*c,t}function gd(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function yd(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function xd(t,e,i){i=i*.5;let a=Math.sin(i);return t[0]=a*e[0],t[1]=a*e[1],t[2]=a*e[2],t[3]=Math.cos(i),t}function Vo(t,e,i){let a=e[0],o=e[1],f=e[2],c=e[3],p=i[0],d=i[1],g=i[2],v=i[3];return t[0]=a*v+c*p+o*g-f*d,t[1]=o*v+c*d+f*p-a*g,t[2]=f*v+c*g+a*d-o*p,t[3]=c*v-a*p-o*d-f*g,t}function wd(t,e,i){i*=.5;let a=e[0],o=e[1],f=e[2],c=e[3],p=Math.sin(i),d=Math.cos(i);return t[0]=a*d+c*p,t[1]=o*d+f*p,t[2]=f*d-o*p,t[3]=c*d-a*p,t}function Sd(t,e,i){i*=.5;let a=e[0],o=e[1],f=e[2],c=e[3],p=Math.sin(i),d=Math.cos(i);return t[0]=a*d-f*p,t[1]=o*d+c*p,t[2]=f*d+a*p,t[3]=c*d-o*p,t}function Ed(t,e,i){i*=.5;let a=e[0],o=e[1],f=e[2],c=e[3],p=Math.sin(i),d=Math.cos(i);return t[0]=a*d+o*p,t[1]=o*d-a*p,t[2]=f*d+c*p,t[3]=c*d-f*p,t}function Rd(t,e,i,a){let o=e[0],f=e[1],c=e[2],p=e[3],d=i[0],g=i[1],v=i[2],m=i[3],y,x,w,M,R;return x=o*d+f*g+c*v+p*m,x<0&&(x=-x,d=-d,g=-g,v=-v,m=-m),1-x>1e-6?(y=Math.acos(x),w=Math.sin(y),M=Math.sin((1-a)*y)/w,R=Math.sin(a*y)/w):(M=1-a,R=a),t[0]=M*o+R*d,t[1]=M*f+R*g,t[2]=M*c+R*v,t[3]=M*p+R*m,t}function Md(t,e){let i=e[0],a=e[1],o=e[2],f=e[3],c=i*i+a*a+o*o+f*f,p=c?1/c:0;return t[0]=-i*p,t[1]=-a*p,t[2]=-o*p,t[3]=f*p,t}function Cd(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function _d(t,e){let i=e[0]+e[4]+e[8],a;if(i>0)a=Math.sqrt(i+1),t[3]=.5*a,a=.5/a,t[0]=(e[5]-e[7])*a,t[1]=(e[6]-e[2])*a,t[2]=(e[1]-e[3])*a;else{let o=0;e[4]>e[0]&&(o=1),e[8]>e[o*3+o]&&(o=2);let f=(o+1)%3,c=(o+2)%3;a=Math.sqrt(e[o*3+o]-e[f*3+f]-e[c*3+c]+1),t[o]=.5*a,a=.5/a,t[3]=(e[f*3+c]-e[c*3+f])*a,t[f]=(e[f*3+o]+e[o*3+f])*a,t[c]=(e[c*3+o]+e[o*3+c])*a}return t}function Td(t,e,i="YXZ"){let a=Math.sin(e[0]*.5),o=Math.cos(e[0]*.5),f=Math.sin(e[1]*.5),c=Math.cos(e[1]*.5),p=Math.sin(e[2]*.5),d=Math.cos(e[2]*.5);return i==="XYZ"?(t[0]=a*c*d+o*f*p,t[1]=o*f*d-a*c*p,t[2]=o*c*p+a*f*d,t[3]=o*c*d-a*f*p):i==="YXZ"?(t[0]=a*c*d+o*f*p,t[1]=o*f*d-a*c*p,t[2]=o*c*p-a*f*d,t[3]=o*c*d+a*f*p):i==="ZXY"?(t[0]=a*c*d-o*f*p,t[1]=o*f*d+a*c*p,t[2]=o*c*p+a*f*d,t[3]=o*c*d-a*f*p):i==="ZYX"?(t[0]=a*c*d-o*f*p,t[1]=o*f*d+a*c*p,t[2]=o*c*p-a*f*d,t[3]=o*c*d+a*f*p):i==="YZX"?(t[0]=a*c*d+o*f*p,t[1]=o*f*d+a*c*p,t[2]=o*c*p-a*f*d,t[3]=o*c*d-a*f*p):i==="XZY"&&(t[0]=a*c*d-o*f*p,t[1]=o*f*d-a*c*p,t[2]=o*c*p+a*f*d,t[3]=o*c*d+a*f*p),t}const bd=pd,Pd=md,kd=gd,zd=vd;class Ad extends Array{constructor(e=0,i=0,a=0,o=1){super(e,i,a,o),this.onChange=()=>{},this._target=this;const f=["0","1","2","3"];return new Proxy(this,{set(c,p){const d=Reflect.set(...arguments);return d&&f.includes(p)&&c.onChange(),d}})}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}get w(){return this[3]}set x(e){this._target[0]=e,this.onChange()}set y(e){this._target[1]=e,this.onChange()}set z(e){this._target[2]=e,this.onChange()}set w(e){this._target[3]=e,this.onChange()}identity(){return yd(this._target),this.onChange(),this}set(e,i,a,o){return e.length?this.copy(e):(Pd(this._target,e,i,a,o),this.onChange(),this)}rotateX(e){return wd(this._target,this._target,e),this.onChange(),this}rotateY(e){return Sd(this._target,this._target,e),this.onChange(),this}rotateZ(e){return Ed(this._target,this._target,e),this.onChange(),this}inverse(e=this._target){return Md(this._target,e),this.onChange(),this}conjugate(e=this._target){return Cd(this._target,e),this.onChange(),this}copy(e){return bd(this._target,e),this.onChange(),this}normalize(e=this._target){return zd(this._target,e),this.onChange(),this}multiply(e,i){return i?Vo(this._target,e,i):Vo(this._target,this._target,e),this.onChange(),this}dot(e){return kd(this._target,e)}fromMatrix3(e){return _d(this._target,e),this.onChange(),this}fromEuler(e,i){return Td(this._target,e,e.order),i||this.onChange(),this}fromAxisAngle(e,i){return xd(this._target,e,i),this.onChange(),this}slerp(e,i){return Rd(this._target,this._target,e,i),this.onChange(),this}fromArray(e,i=0){return this._target[0]=e[i],this._target[1]=e[i+1],this._target[2]=e[i+2],this._target[3]=e[i+3],this.onChange(),this}toArray(e=[],i=0){return e[i]=this[0],e[i+1]=this[1],e[i+2]=this[2],e[i+3]=this[3],e}}const Nd=1e-6;function Id(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Ld(t,e,i,a,o,f,c,p,d,g,v,m,y,x,w,M,R){return t[0]=e,t[1]=i,t[2]=a,t[3]=o,t[4]=f,t[5]=c,t[6]=p,t[7]=d,t[8]=g,t[9]=v,t[10]=m,t[11]=y,t[12]=x,t[13]=w,t[14]=M,t[15]=R,t}function Fd(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Bd(t,e){let i=e[0],a=e[1],o=e[2],f=e[3],c=e[4],p=e[5],d=e[6],g=e[7],v=e[8],m=e[9],y=e[10],x=e[11],w=e[12],M=e[13],R=e[14],E=e[15],_=i*p-a*c,b=i*d-o*c,A=i*g-f*c,D=a*d-o*p,L=a*g-f*p,O=o*g-f*d,G=v*M-m*w,W=v*R-y*w,P=v*E-x*w,z=m*R-y*M,V=m*E-x*M,X=y*E-x*R,N=_*X-b*V+A*z+D*P-L*W+O*G;return N?(N=1/N,t[0]=(p*X-d*V+g*z)*N,t[1]=(o*V-a*X-f*z)*N,t[2]=(M*O-R*L+E*D)*N,t[3]=(y*L-m*O-x*D)*N,t[4]=(d*P-c*X-g*W)*N,t[5]=(i*X-o*P+f*W)*N,t[6]=(R*A-w*O-E*b)*N,t[7]=(v*O-y*A+x*b)*N,t[8]=(c*V-p*P+g*G)*N,t[9]=(a*P-i*V-f*G)*N,t[10]=(w*L-M*A+E*_)*N,t[11]=(m*A-v*L-x*_)*N,t[12]=(p*W-c*z-d*G)*N,t[13]=(i*z-a*W+o*G)*N,t[14]=(M*b-w*D-R*_)*N,t[15]=(v*D-m*b+y*_)*N,t):null}function Bu(t){let e=t[0],i=t[1],a=t[2],o=t[3],f=t[4],c=t[5],p=t[6],d=t[7],g=t[8],v=t[9],m=t[10],y=t[11],x=t[12],w=t[13],M=t[14],R=t[15],E=e*c-i*f,_=e*p-a*f,b=e*d-o*f,A=i*p-a*c,D=i*d-o*c,L=a*d-o*p,O=g*w-v*x,G=g*M-m*x,W=g*R-y*x,P=v*M-m*w,z=v*R-y*w,V=m*R-y*M;return E*V-_*z+b*P+A*W-D*G+L*O}function Xo(t,e,i){let a=e[0],o=e[1],f=e[2],c=e[3],p=e[4],d=e[5],g=e[6],v=e[7],m=e[8],y=e[9],x=e[10],w=e[11],M=e[12],R=e[13],E=e[14],_=e[15],b=i[0],A=i[1],D=i[2],L=i[3];return t[0]=b*a+A*p+D*m+L*M,t[1]=b*o+A*d+D*y+L*R,t[2]=b*f+A*g+D*x+L*E,t[3]=b*c+A*v+D*w+L*_,b=i[4],A=i[5],D=i[6],L=i[7],t[4]=b*a+A*p+D*m+L*M,t[5]=b*o+A*d+D*y+L*R,t[6]=b*f+A*g+D*x+L*E,t[7]=b*c+A*v+D*w+L*_,b=i[8],A=i[9],D=i[10],L=i[11],t[8]=b*a+A*p+D*m+L*M,t[9]=b*o+A*d+D*y+L*R,t[10]=b*f+A*g+D*x+L*E,t[11]=b*c+A*v+D*w+L*_,b=i[12],A=i[13],D=i[14],L=i[15],t[12]=b*a+A*p+D*m+L*M,t[13]=b*o+A*d+D*y+L*R,t[14]=b*f+A*g+D*x+L*E,t[15]=b*c+A*v+D*w+L*_,t}function Ud(t,e,i){let a=i[0],o=i[1],f=i[2],c,p,d,g,v,m,y,x,w,M,R,E;return e===t?(t[12]=e[0]*a+e[4]*o+e[8]*f+e[12],t[13]=e[1]*a+e[5]*o+e[9]*f+e[13],t[14]=e[2]*a+e[6]*o+e[10]*f+e[14],t[15]=e[3]*a+e[7]*o+e[11]*f+e[15]):(c=e[0],p=e[1],d=e[2],g=e[3],v=e[4],m=e[5],y=e[6],x=e[7],w=e[8],M=e[9],R=e[10],E=e[11],t[0]=c,t[1]=p,t[2]=d,t[3]=g,t[4]=v,t[5]=m,t[6]=y,t[7]=x,t[8]=w,t[9]=M,t[10]=R,t[11]=E,t[12]=c*a+v*o+w*f+e[12],t[13]=p*a+m*o+M*f+e[13],t[14]=d*a+y*o+R*f+e[14],t[15]=g*a+x*o+E*f+e[15]),t}function Dd(t,e,i){let a=i[0],o=i[1],f=i[2];return t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t[3]=e[3]*a,t[4]=e[4]*o,t[5]=e[5]*o,t[6]=e[6]*o,t[7]=e[7]*o,t[8]=e[8]*f,t[9]=e[9]*f,t[10]=e[10]*f,t[11]=e[11]*f,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Od(t,e,i,a){let o=a[0],f=a[1],c=a[2],p=Math.hypot(o,f,c),d,g,v,m,y,x,w,M,R,E,_,b,A,D,L,O,G,W,P,z,V,X,N,Z;return Math.abs(p)<Nd?null:(p=1/p,o*=p,f*=p,c*=p,d=Math.sin(i),g=Math.cos(i),v=1-g,m=e[0],y=e[1],x=e[2],w=e[3],M=e[4],R=e[5],E=e[6],_=e[7],b=e[8],A=e[9],D=e[10],L=e[11],O=o*o*v+g,G=f*o*v+c*d,W=c*o*v-f*d,P=o*f*v-c*d,z=f*f*v+g,V=c*f*v+o*d,X=o*c*v+f*d,N=f*c*v-o*d,Z=c*c*v+g,t[0]=m*O+M*G+b*W,t[1]=y*O+R*G+A*W,t[2]=x*O+E*G+D*W,t[3]=w*O+_*G+L*W,t[4]=m*P+M*z+b*V,t[5]=y*P+R*z+A*V,t[6]=x*P+E*z+D*V,t[7]=w*P+_*z+L*V,t[8]=m*X+M*N+b*Z,t[9]=y*X+R*N+A*Z,t[10]=x*X+E*N+D*Z,t[11]=w*X+_*N+L*Z,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function jd(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function Uu(t,e){let i=e[0],a=e[1],o=e[2],f=e[4],c=e[5],p=e[6],d=e[8],g=e[9],v=e[10];return t[0]=Math.hypot(i,a,o),t[1]=Math.hypot(f,c,p),t[2]=Math.hypot(d,g,v),t}function Hd(t){let e=t[0],i=t[1],a=t[2],o=t[4],f=t[5],c=t[6],p=t[8],d=t[9],g=t[10];const v=e*e+i*i+a*a,m=o*o+f*f+c*c,y=p*p+d*d+g*g;return Math.sqrt(Math.max(v,m,y))}const Du=function(){const t=[1,1,1];return function(e,i){let a=t;Uu(a,i);let o=1/a[0],f=1/a[1],c=1/a[2],p=i[0]*o,d=i[1]*f,g=i[2]*c,v=i[4]*o,m=i[5]*f,y=i[6]*c,x=i[8]*o,w=i[9]*f,M=i[10]*c,R=p+m+M,E=0;return R>0?(E=Math.sqrt(R+1)*2,e[3]=.25*E,e[0]=(y-w)/E,e[1]=(x-g)/E,e[2]=(d-v)/E):p>m&&p>M?(E=Math.sqrt(1+p-m-M)*2,e[3]=(y-w)/E,e[0]=.25*E,e[1]=(d+v)/E,e[2]=(x+g)/E):m>M?(E=Math.sqrt(1+m-p-M)*2,e[3]=(x-g)/E,e[0]=(d+v)/E,e[1]=.25*E,e[2]=(y+w)/E):(E=Math.sqrt(1+M-p-m)*2,e[3]=(d-v)/E,e[0]=(x+g)/E,e[1]=(y+w)/E,e[2]=.25*E),e}}();function Gd(t,e,i,a){let o=Hr([t[0],t[1],t[2]]);const f=Hr([t[4],t[5],t[6]]),c=Hr([t[8],t[9],t[10]]);Bu(t)<0&&(o=-o),i[0]=t[12],i[1]=t[13],i[2]=t[14];const d=t.slice(),g=1/o,v=1/f,m=1/c;d[0]*=g,d[1]*=g,d[2]*=g,d[4]*=v,d[5]*=v,d[6]*=v,d[8]*=m,d[9]*=m,d[10]*=m,Du(e,d),a[0]=o,a[1]=f,a[2]=c}function Wd(t,e,i,a){const o=t,f=e[0],c=e[1],p=e[2],d=e[3],g=f+f,v=c+c,m=p+p,y=f*g,x=f*v,w=f*m,M=c*v,R=c*m,E=p*m,_=d*g,b=d*v,A=d*m,D=a[0],L=a[1],O=a[2];return o[0]=(1-(M+E))*D,o[1]=(x+A)*D,o[2]=(w-b)*D,o[3]=0,o[4]=(x-A)*L,o[5]=(1-(y+E))*L,o[6]=(R+_)*L,o[7]=0,o[8]=(w+b)*O,o[9]=(R-_)*O,o[10]=(1-(y+M))*O,o[11]=0,o[12]=i[0],o[13]=i[1],o[14]=i[2],o[15]=1,o}function Vd(t,e){let i=e[0],a=e[1],o=e[2],f=e[3],c=i+i,p=a+a,d=o+o,g=i*c,v=a*c,m=a*p,y=o*c,x=o*p,w=o*d,M=f*c,R=f*p,E=f*d;return t[0]=1-m-w,t[1]=v+E,t[2]=y-R,t[3]=0,t[4]=v-E,t[5]=1-g-w,t[6]=x+M,t[7]=0,t[8]=y+R,t[9]=x-M,t[10]=1-g-m,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Xd(t,e,i,a,o){let f=1/Math.tan(e/2),c=1/(a-o);return t[0]=f/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=f,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(o+a)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*o*a*c,t[15]=0,t}function Yd(t,e,i,a,o,f,c){let p=1/(e-i),d=1/(a-o),g=1/(f-c);return t[0]=-2*p,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*d,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*g,t[11]=0,t[12]=(e+i)*p,t[13]=(o+a)*d,t[14]=(c+f)*g,t[15]=1,t}function qd(t,e,i,a){let o=e[0],f=e[1],c=e[2],p=a[0],d=a[1],g=a[2],v=o-i[0],m=f-i[1],y=c-i[2],x=v*v+m*m+y*y;x===0?y=1:(x=1/Math.sqrt(x),v*=x,m*=x,y*=x);let w=d*y-g*m,M=g*v-p*y,R=p*m-d*v;return x=w*w+M*M+R*R,x===0&&(g?p+=1e-6:d?g+=1e-6:d+=1e-6,w=d*y-g*m,M=g*v-p*y,R=p*m-d*v,x=w*w+M*M+R*R),x=1/Math.sqrt(x),w*=x,M*=x,R*=x,t[0]=w,t[1]=M,t[2]=R,t[3]=0,t[4]=m*R-y*M,t[5]=y*w-v*R,t[6]=v*M-m*w,t[7]=0,t[8]=v,t[9]=m,t[10]=y,t[11]=0,t[12]=o,t[13]=f,t[14]=c,t[15]=1,t}function Yo(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t[6]=e[6]+i[6],t[7]=e[7]+i[7],t[8]=e[8]+i[8],t[9]=e[9]+i[9],t[10]=e[10]+i[10],t[11]=e[11]+i[11],t[12]=e[12]+i[12],t[13]=e[13]+i[13],t[14]=e[14]+i[14],t[15]=e[15]+i[15],t}function qo(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t[6]=e[6]-i[6],t[7]=e[7]-i[7],t[8]=e[8]-i[8],t[9]=e[9]-i[9],t[10]=e[10]-i[10],t[11]=e[11]-i[11],t[12]=e[12]-i[12],t[13]=e[13]-i[13],t[14]=e[14]-i[14],t[15]=e[15]-i[15],t}function Qd(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12]*i,t[13]=e[13]*i,t[14]=e[14]*i,t[15]=e[15]*i,t}class Ji extends Array{constructor(e=1,i=0,a=0,o=0,f=0,c=1,p=0,d=0,g=0,v=0,m=1,y=0,x=0,w=0,M=0,R=1){return super(e,i,a,o,f,c,p,d,g,v,m,y,x,w,M,R),this}get x(){return this[12]}get y(){return this[13]}get z(){return this[14]}get w(){return this[15]}set x(e){this[12]=e}set y(e){this[13]=e}set z(e){this[14]=e}set w(e){this[15]=e}set(e,i,a,o,f,c,p,d,g,v,m,y,x,w,M,R){return e.length?this.copy(e):(Ld(this,e,i,a,o,f,c,p,d,g,v,m,y,x,w,M,R),this)}translate(e,i=this){return Ud(this,i,e),this}rotate(e,i,a=this){return Od(this,a,e,i),this}scale(e,i=this){return Dd(this,i,typeof e=="number"?[e,e,e]:e),this}add(e,i){return i?Yo(this,e,i):Yo(this,this,e),this}sub(e,i){return i?qo(this,e,i):qo(this,this,e),this}multiply(e,i){return e.length?i?Xo(this,e,i):Xo(this,this,e):Qd(this,this,e),this}identity(){return Fd(this),this}copy(e){return Id(this,e),this}fromPerspective({fov:e,aspect:i,near:a,far:o}={}){return Xd(this,e,i,a,o),this}fromOrthogonal({left:e,right:i,bottom:a,top:o,near:f,far:c}){return Yd(this,e,i,a,o,f,c),this}fromQuaternion(e){return Vd(this,e),this}setPosition(e){return this.x=e[0],this.y=e[1],this.z=e[2],this}inverse(e=this){return Bd(this,e),this}compose(e,i,a){return Wd(this,e,i,a),this}decompose(e,i,a){return Gd(this,e,i,a),this}getRotation(e){return Du(e,this),this}getTranslation(e){return jd(e,this),this}getScaling(e){return Uu(e,this),this}getMaxScaleOnAxis(){return Hd(this)}lookAt(e,i,a){return qd(this,e,i,a),this}determinant(){return Bu(this)}fromArray(e,i=0){return this[0]=e[i],this[1]=e[i+1],this[2]=e[i+2],this[3]=e[i+3],this[4]=e[i+4],this[5]=e[i+5],this[6]=e[i+6],this[7]=e[i+7],this[8]=e[i+8],this[9]=e[i+9],this[10]=e[i+10],this[11]=e[i+11],this[12]=e[i+12],this[13]=e[i+13],this[14]=e[i+14],this[15]=e[i+15],this}toArray(e=[],i=0){return e[i]=this[0],e[i+1]=this[1],e[i+2]=this[2],e[i+3]=this[3],e[i+4]=this[4],e[i+5]=this[5],e[i+6]=this[6],e[i+7]=this[7],e[i+8]=this[8],e[i+9]=this[9],e[i+10]=this[10],e[i+11]=this[11],e[i+12]=this[12],e[i+13]=this[13],e[i+14]=this[14],e[i+15]=this[15],e}}function Zd(t,e,i="YXZ"){return i==="XYZ"?(t[1]=Math.asin(Math.min(Math.max(e[8],-1),1)),Math.abs(e[8])<.99999?(t[0]=Math.atan2(-e[9],e[10]),t[2]=Math.atan2(-e[4],e[0])):(t[0]=Math.atan2(e[6],e[5]),t[2]=0)):i==="YXZ"?(t[0]=Math.asin(-Math.min(Math.max(e[9],-1),1)),Math.abs(e[9])<.99999?(t[1]=Math.atan2(e[8],e[10]),t[2]=Math.atan2(e[1],e[5])):(t[1]=Math.atan2(-e[2],e[0]),t[2]=0)):i==="ZXY"?(t[0]=Math.asin(Math.min(Math.max(e[6],-1),1)),Math.abs(e[6])<.99999?(t[1]=Math.atan2(-e[2],e[10]),t[2]=Math.atan2(-e[4],e[5])):(t[1]=0,t[2]=Math.atan2(e[1],e[0]))):i==="ZYX"?(t[1]=Math.asin(-Math.min(Math.max(e[2],-1),1)),Math.abs(e[2])<.99999?(t[0]=Math.atan2(e[6],e[10]),t[2]=Math.atan2(e[1],e[0])):(t[0]=0,t[2]=Math.atan2(-e[4],e[5]))):i==="YZX"?(t[2]=Math.asin(Math.min(Math.max(e[1],-1),1)),Math.abs(e[1])<.99999?(t[0]=Math.atan2(-e[9],e[5]),t[1]=Math.atan2(-e[2],e[0])):(t[0]=0,t[1]=Math.atan2(e[8],e[10]))):i==="XZY"&&(t[2]=Math.asin(-Math.min(Math.max(e[4],-1),1)),Math.abs(e[4])<.99999?(t[0]=Math.atan2(e[6],e[5]),t[1]=Math.atan2(e[8],e[0])):(t[0]=Math.atan2(-e[9],e[10]),t[1]=0)),t}const Qo=new Ji;class Kd extends Array{constructor(e=0,i=e,a=e,o="YXZ"){super(e,i,a),this.order=o,this.onChange=()=>{},this._target=this;const f=["0","1","2"];return new Proxy(this,{set(c,p){const d=Reflect.set(...arguments);return d&&f.includes(p)&&c.onChange(),d}})}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}set x(e){this._target[0]=e,this.onChange()}set y(e){this._target[1]=e,this.onChange()}set z(e){this._target[2]=e,this.onChange()}set(e,i=e,a=e){return e.length?this.copy(e):(this._target[0]=e,this._target[1]=i,this._target[2]=a,this.onChange(),this)}copy(e){return this._target[0]=e[0],this._target[1]=e[1],this._target[2]=e[2],this.onChange(),this}reorder(e){return this._target.order=e,this.onChange(),this}fromRotationMatrix(e,i=this.order){return Zd(this._target,e,i),this.onChange(),this}fromQuaternion(e,i=this.order,a){return Qo.fromQuaternion(e),this._target.fromRotationMatrix(Qo,i),a||this.onChange(),this}fromArray(e,i=0){return this._target[0]=e[i],this._target[1]=e[i+1],this._target[2]=e[i+2],this}toArray(e=[],i=0){return e[i]=this[0],e[i+1]=this[1],e[i+2]=this[2],e}}class Jd{constructor(){this.parent=null,this.children=[],this.visible=!0,this.matrix=new Ji,this.worldMatrix=new Ji,this.matrixAutoUpdate=!0,this.worldMatrixNeedsUpdate=!1,this.position=new jt,this.quaternion=new Ad,this.scale=new jt(1),this.rotation=new Kd,this.up=new jt(0,1,0),this.rotation._target.onChange=()=>this.quaternion.fromEuler(this.rotation,!0),this.quaternion._target.onChange=()=>this.rotation.fromQuaternion(this.quaternion,void 0,!0)}setParent(e,i=!0){this.parent&&e!==this.parent&&this.parent.removeChild(this,!1),this.parent=e,i&&e&&e.addChild(this,!1)}addChild(e,i=!0){~this.children.indexOf(e)||this.children.push(e),i&&e.setParent(this,!1)}removeChild(e,i=!0){~this.children.indexOf(e)&&this.children.splice(this.children.indexOf(e),1),i&&e.setParent(null,!1)}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.worldMatrixNeedsUpdate||e)&&(this.parent===null?this.worldMatrix.copy(this.matrix):this.worldMatrix.multiply(this.parent.worldMatrix,this.matrix),this.worldMatrixNeedsUpdate=!1,e=!0);for(let i=0,a=this.children.length;i<a;i++)this.children[i].updateMatrixWorld(e)}updateMatrix(){this.matrix.compose(this.quaternion,this.position,this.scale),this.worldMatrixNeedsUpdate=!0}traverse(e){if(!e(this))for(let i=0,a=this.children.length;i<a;i++)this.children[i].traverse(e)}decompose(){this.matrix.decompose(this.quaternion._target,this.position,this.scale),this.rotation.fromQuaternion(this.quaternion)}lookAt(e,i=!1){i?this.matrix.lookAt(this.position,e,this.up):this.matrix.lookAt(e,this.position,this.up),this.matrix.getRotation(this.quaternion._target),this.rotation.fromQuaternion(this.quaternion)}}function $d(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function eh(t,e){let i=e[0],a=e[1],o=e[2],f=e[3],c=i+i,p=a+a,d=o+o,g=i*c,v=a*c,m=a*p,y=o*c,x=o*p,w=o*d,M=f*c,R=f*p,E=f*d;return t[0]=1-m-w,t[3]=v-E,t[6]=y+R,t[1]=v+E,t[4]=1-g-w,t[7]=x-M,t[2]=y-R,t[5]=x+M,t[8]=1-g-m,t}function th(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function nh(t,e,i,a,o,f,c,p,d,g){return t[0]=e,t[1]=i,t[2]=a,t[3]=o,t[4]=f,t[5]=c,t[6]=p,t[7]=d,t[8]=g,t}function rh(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function ih(t,e){let i=e[0],a=e[1],o=e[2],f=e[3],c=e[4],p=e[5],d=e[6],g=e[7],v=e[8],m=v*c-p*g,y=-v*f+p*d,x=g*f-c*d,w=i*m+a*y+o*x;return w?(w=1/w,t[0]=m*w,t[1]=(-v*a+o*g)*w,t[2]=(p*a-o*c)*w,t[3]=y*w,t[4]=(v*i-o*d)*w,t[5]=(-p*i+o*f)*w,t[6]=x*w,t[7]=(-g*i+a*d)*w,t[8]=(c*i-a*f)*w,t):null}function Zo(t,e,i){let a=e[0],o=e[1],f=e[2],c=e[3],p=e[4],d=e[5],g=e[6],v=e[7],m=e[8],y=i[0],x=i[1],w=i[2],M=i[3],R=i[4],E=i[5],_=i[6],b=i[7],A=i[8];return t[0]=y*a+x*c+w*g,t[1]=y*o+x*p+w*v,t[2]=y*f+x*d+w*m,t[3]=M*a+R*c+E*g,t[4]=M*o+R*p+E*v,t[5]=M*f+R*d+E*m,t[6]=_*a+b*c+A*g,t[7]=_*o+b*p+A*v,t[8]=_*f+b*d+A*m,t}function sh(t,e,i){let a=e[0],o=e[1],f=e[2],c=e[3],p=e[4],d=e[5],g=e[6],v=e[7],m=e[8],y=i[0],x=i[1];return t[0]=a,t[1]=o,t[2]=f,t[3]=c,t[4]=p,t[5]=d,t[6]=y*a+x*c+g,t[7]=y*o+x*p+v,t[8]=y*f+x*d+m,t}function lh(t,e,i){let a=e[0],o=e[1],f=e[2],c=e[3],p=e[4],d=e[5],g=e[6],v=e[7],m=e[8],y=Math.sin(i),x=Math.cos(i);return t[0]=x*a+y*c,t[1]=x*o+y*p,t[2]=x*f+y*d,t[3]=x*c-y*a,t[4]=x*p-y*o,t[5]=x*d-y*f,t[6]=g,t[7]=v,t[8]=m,t}function ah(t,e,i){let a=i[0],o=i[1];return t[0]=a*e[0],t[1]=a*e[1],t[2]=a*e[2],t[3]=o*e[3],t[4]=o*e[4],t[5]=o*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function oh(t,e){let i=e[0],a=e[1],o=e[2],f=e[3],c=e[4],p=e[5],d=e[6],g=e[7],v=e[8],m=e[9],y=e[10],x=e[11],w=e[12],M=e[13],R=e[14],E=e[15],_=i*p-a*c,b=i*d-o*c,A=i*g-f*c,D=a*d-o*p,L=a*g-f*p,O=o*g-f*d,G=v*M-m*w,W=v*R-y*w,P=v*E-x*w,z=m*R-y*M,V=m*E-x*M,X=y*E-x*R,N=_*X-b*V+A*z+D*P-L*W+O*G;return N?(N=1/N,t[0]=(p*X-d*V+g*z)*N,t[1]=(d*P-c*X-g*W)*N,t[2]=(c*V-p*P+g*G)*N,t[3]=(o*V-a*X-f*z)*N,t[4]=(i*X-o*P+f*W)*N,t[5]=(a*P-i*V-f*G)*N,t[6]=(M*O-R*L+E*D)*N,t[7]=(R*A-w*O-E*b)*N,t[8]=(w*L-M*A+E*_)*N,t):null}class uh extends Array{constructor(e=1,i=0,a=0,o=0,f=1,c=0,p=0,d=0,g=1){return super(e,i,a,o,f,c,p,d,g),this}set(e,i,a,o,f,c,p,d,g){return e.length?this.copy(e):(nh(this,e,i,a,o,f,c,p,d,g),this)}translate(e,i=this){return sh(this,i,e),this}rotate(e,i=this){return lh(this,i,e),this}scale(e,i=this){return ah(this,i,e),this}multiply(e,i){return i?Zo(this,e,i):Zo(this,this,e),this}identity(){return rh(this),this}copy(e){return th(this,e),this}fromMatrix4(e){return $d(this,e),this}fromQuaternion(e){return eh(this,e),this}fromBasis(e,i,a){return this.set(e[0],e[1],e[2],i[0],i[1],i[2],a[0],a[1],a[2]),this}inverse(e=this){return ih(this,e),this}getNormalMatrix(e){return oh(this,e),this}}let ch=0;class hr extends Jd{constructor(e,{geometry:i,program:a,mode:o=e.TRIANGLES,frustumCulled:f=!0,renderOrder:c=0}={}){super(),e.canvas||console.error("gl not passed as first argument to Mesh"),this.gl=e,this.id=ch++,this.geometry=i,this.program=a,this.mode=o,this.frustumCulled=f,this.renderOrder=c,this.modelViewMatrix=new Ji,this.normalMatrix=new uh,this.beforeRenderCallbacks=[],this.afterRenderCallbacks=[]}onBeforeRender(e){return this.beforeRenderCallbacks.push(e),this}onAfterRender(e){return this.afterRenderCallbacks.push(e),this}draw({camera:e}={}){e&&(this.program.uniforms.modelMatrix||Object.assign(this.program.uniforms,{modelMatrix:{value:null},viewMatrix:{value:null},modelViewMatrix:{value:null},normalMatrix:{value:null},projectionMatrix:{value:null},cameraPosition:{value:null}}),this.program.uniforms.projectionMatrix.value=e.projectionMatrix,this.program.uniforms.cameraPosition.value=e.worldPosition,this.program.uniforms.viewMatrix.value=e.viewMatrix,this.modelViewMatrix.multiply(e.viewMatrix,this.worldMatrix),this.normalMatrix.getNormalMatrix(this.modelViewMatrix),this.program.uniforms.modelMatrix.value=this.worldMatrix,this.program.uniforms.modelViewMatrix.value=this.modelViewMatrix,this.program.uniforms.normalMatrix.value=this.normalMatrix),this.beforeRenderCallbacks.forEach(a=>a&&a({mesh:this,camera:e}));let i=this.program.cullFace&&this.worldMatrix.determinant()<0;this.program.use({flipFaces:i}),this.geometry.draw({mode:this.mode,program:this.program}),this.afterRenderCallbacks.forEach(a=>a&&a({mesh:this,camera:e}))}}const Ko=new Uint8Array(4);function Jo(t){return(t&t-1)===0}let fh=1;class dh{constructor(e,{image:i,target:a=e.TEXTURE_2D,type:o=e.UNSIGNED_BYTE,format:f=e.RGBA,internalFormat:c=f,wrapS:p=e.CLAMP_TO_EDGE,wrapT:d=e.CLAMP_TO_EDGE,wrapR:g=e.CLAMP_TO_EDGE,generateMipmaps:v=a===(e.TEXTURE_2D||e.TEXTURE_CUBE_MAP),minFilter:m=v?e.NEAREST_MIPMAP_LINEAR:e.LINEAR,magFilter:y=e.LINEAR,premultiplyAlpha:x=!1,unpackAlignment:w=4,flipY:M=a==(e.TEXTURE_2D||e.TEXTURE_3D),anisotropy:R=0,level:E=0,width:_,height:b=_,length:A=1}={}){this.gl=e,this.id=fh++,this.image=i,this.target=a,this.type=o,this.format=f,this.internalFormat=c,this.minFilter=m,this.magFilter=y,this.wrapS=p,this.wrapT=d,this.wrapR=g,this.generateMipmaps=v,this.premultiplyAlpha=x,this.unpackAlignment=w,this.flipY=M,this.anisotropy=Math.min(R,this.gl.renderer.parameters.maxAnisotropy),this.level=E,this.width=_,this.height=b,this.length=A,this.texture=this.gl.createTexture(),this.store={image:null},this.glState=this.gl.renderer.state,this.state={},this.state.minFilter=this.gl.NEAREST_MIPMAP_LINEAR,this.state.magFilter=this.gl.LINEAR,this.state.wrapS=this.gl.REPEAT,this.state.wrapT=this.gl.REPEAT,this.state.anisotropy=0}bind(){this.glState.textureUnits[this.glState.activeTextureUnit]!==this.id&&(this.gl.bindTexture(this.target,this.texture),this.glState.textureUnits[this.glState.activeTextureUnit]=this.id)}update(e=0){const i=!(this.image===this.store.image&&!this.needsUpdate);if((i||this.glState.textureUnits[e]!==this.id)&&(this.gl.renderer.activeTexture(e),this.bind()),!!i){if(this.needsUpdate=!1,this.flipY!==this.glState.flipY&&(this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,this.flipY),this.glState.flipY=this.flipY),this.premultiplyAlpha!==this.glState.premultiplyAlpha&&(this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),this.glState.premultiplyAlpha=this.premultiplyAlpha),this.unpackAlignment!==this.glState.unpackAlignment&&(this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,this.unpackAlignment),this.glState.unpackAlignment=this.unpackAlignment),this.minFilter!==this.state.minFilter&&(this.gl.texParameteri(this.target,this.gl.TEXTURE_MIN_FILTER,this.minFilter),this.state.minFilter=this.minFilter),this.magFilter!==this.state.magFilter&&(this.gl.texParameteri(this.target,this.gl.TEXTURE_MAG_FILTER,this.magFilter),this.state.magFilter=this.magFilter),this.wrapS!==this.state.wrapS&&(this.gl.texParameteri(this.target,this.gl.TEXTURE_WRAP_S,this.wrapS),this.state.wrapS=this.wrapS),this.wrapT!==this.state.wrapT&&(this.gl.texParameteri(this.target,this.gl.TEXTURE_WRAP_T,this.wrapT),this.state.wrapT=this.wrapT),this.wrapR!==this.state.wrapR&&(this.gl.texParameteri(this.target,this.gl.TEXTURE_WRAP_R,this.wrapR),this.state.wrapR=this.wrapR),this.anisotropy&&this.anisotropy!==this.state.anisotropy&&(this.gl.texParameterf(this.target,this.gl.renderer.getExtension("EXT_texture_filter_anisotropic").TEXTURE_MAX_ANISOTROPY_EXT,this.anisotropy),this.state.anisotropy=this.anisotropy),this.image){if(this.image.width&&(this.width=this.image.width,this.height=this.image.height),this.target===this.gl.TEXTURE_CUBE_MAP)for(let a=0;a<6;a++)this.gl.texImage2D(this.gl.TEXTURE_CUBE_MAP_POSITIVE_X+a,this.level,this.internalFormat,this.format,this.type,this.image[a]);else if(ArrayBuffer.isView(this.image))this.target===this.gl.TEXTURE_2D?this.gl.texImage2D(this.target,this.level,this.internalFormat,this.width,this.height,0,this.format,this.type,this.image):(this.target===this.gl.TEXTURE_2D_ARRAY||this.target===this.gl.TEXTURE_3D)&&this.gl.texImage3D(this.target,this.level,this.internalFormat,this.width,this.height,this.length,0,this.format,this.type,this.image);else if(this.image.isCompressedTexture)for(let a=0;a<this.image.length;a++)this.gl.compressedTexImage2D(this.target,a,this.internalFormat,this.image[a].width,this.image[a].height,0,this.image[a].data);else this.target===this.gl.TEXTURE_2D?this.gl.texImage2D(this.target,this.level,this.internalFormat,this.format,this.type,this.image):this.gl.texImage3D(this.target,this.level,this.internalFormat,this.width,this.height,this.length,0,this.format,this.type,this.image);this.generateMipmaps&&(!this.gl.renderer.isWebgl2&&(!Jo(this.image.width)||!Jo(this.image.height))?(this.generateMipmaps=!1,this.wrapS=this.wrapT=this.gl.CLAMP_TO_EDGE,this.minFilter=this.gl.LINEAR):this.gl.generateMipmap(this.target)),this.onUpdate&&this.onUpdate()}else if(this.target===this.gl.TEXTURE_CUBE_MAP)for(let a=0;a<6;a++)this.gl.texImage2D(this.gl.TEXTURE_CUBE_MAP_POSITIVE_X+a,0,this.gl.RGBA,1,1,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,Ko);else this.width?this.target===this.gl.TEXTURE_2D?this.gl.texImage2D(this.target,this.level,this.internalFormat,this.width,this.height,0,this.format,this.type,null):this.gl.texImage3D(this.target,this.level,this.internalFormat,this.width,this.height,this.length,0,this.format,this.type,null):this.gl.texImage2D(this.target,0,this.gl.RGBA,1,1,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,Ko);this.store.image=this.image}}}const $o={black:"#000000",white:"#ffffff",red:"#ff0000",green:"#00ff00",blue:"#0000ff",fuchsia:"#ff00ff",cyan:"#00ffff",yellow:"#ffff00",orange:"#ff8000"};function eu(t){t.length===4&&(t=t[0]+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]);const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e||console.warn(`Unable to convert hex string ${t} to rgb values`),[parseInt(e[1],16)/255,parseInt(e[2],16)/255,parseInt(e[3],16)/255]}function hh(t){return t=parseInt(t),[(t>>16&255)/255,(t>>8&255)/255,(t&255)/255]}function tu(t){return t===void 0?[0,0,0]:arguments.length===3?arguments:isNaN(t)?t[0]==="#"?eu(t):$o[t.toLowerCase()]?eu($o[t.toLowerCase()]):(console.warn("Color format not recognised"),[0,0,0]):hh(t)}class $i extends Array{constructor(e){return Array.isArray(e)?super(...e):super(...tu(...arguments))}get r(){return this[0]}get g(){return this[1]}get b(){return this[2]}set r(e){this[0]=e}set g(e){this[1]=e}set b(e){this[2]=e}set(e){return Array.isArray(e)?this.copy(e):this.copy(tu(...arguments))}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this}}class pr extends od{constructor(e,{attributes:i={}}={}){Object.assign(i,{position:{size:2,data:new Float32Array([-1,-1,3,-1,-1,3])},uv:{size:2,data:new Float32Array([0,0,2,0,0,2])}}),super(e,i)}}const ph=`#version 300 es
in vec2 position;
void main() {
  gl_Position = vec4(position, 0.0, 1.0);
}
`,mh=`#version 300 es
precision highp float;

uniform float uTime;
uniform float uAmplitude;
uniform vec3 uColorStops[3];
uniform vec2 uResolution;
uniform float uBlend;

out vec4 fragColor;

vec3 permute(vec3 x) {
  return mod(((x * 34.0) + 1.0) * x, 289.0);
}

float snoise(vec2 v){
  const vec4 C = vec4(
      0.211324865405187, 0.366025403784439,
      -0.577350269189626, 0.024390243902439
  );
  vec2 i  = floor(v + dot(v, C.yy));
  vec2 x0 = v - i + dot(i, C.xx);
  vec2 i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);
  vec4 x12 = x0.xyxy + C.xxzz;
  x12.xy -= i1;
  i = mod(i, 289.0);

  vec3 p = permute(
      permute(i.y + vec3(0.0, i1.y, 1.0))
    + i.x + vec3(0.0, i1.x, 1.0)
  );

  vec3 m = max(
      0.5 - vec3(
          dot(x0, x0),
          dot(x12.xy, x12.xy),
          dot(x12.zw, x12.zw)
      ), 
      0.0
  );
  m = m * m;
  m = m * m;

  vec3 x = 2.0 * fract(p * C.www) - 1.0;
  vec3 h = abs(x) - 0.5;
  vec3 ox = floor(x + 0.5);
  vec3 a0 = x - ox;
  m *= 1.79284291400159 - 0.85373472095314 * (a0*a0 + h*h);

  vec3 g;
  g.x  = a0.x  * x0.x  + h.x  * x0.y;
  g.yz = a0.yz * x12.xz + h.yz * x12.yw;
  return 130.0 * dot(m, g);
}

struct ColorStop {
  vec3 color;
  float position;
};

#define COLOR_RAMP(colors, factor, finalColor) {   int index = 0;   for (int i = 0; i < 2; i++) {      ColorStop currentColor = colors[i];      bool isInBetween = currentColor.position <= factor;      index = int(mix(float(index), float(i), float(isInBetween)));   }   ColorStop currentColor = colors[index];   ColorStop nextColor = colors[index + 1];   float range = nextColor.position - currentColor.position;   float lerpFactor = (factor - currentColor.position) / range;   finalColor = mix(currentColor.color, nextColor.color, lerpFactor); }

void main() {
  vec2 uv = gl_FragCoord.xy / uResolution;
  
  ColorStop colors[3];
  colors[0] = ColorStop(uColorStops[0], 0.0);
  colors[1] = ColorStop(uColorStops[1], 0.5);
  colors[2] = ColorStop(uColorStops[2], 1.0);
  
  vec3 rampColor;
  COLOR_RAMP(colors, uv.x, rampColor);
  
  float height = snoise(vec2(uv.x * 2.0 + uTime * 0.1, uTime * 0.25)) * 0.5 * uAmplitude;
  height = exp(height);
  height = (uv.y * 2.0 - height + 0.2);
  float intensity = 0.6 * height;
  
  float midPoint = 0.20;
  float auroraAlpha = smoothstep(midPoint - uBlend * 0.5, midPoint + uBlend * 0.5, intensity);
  
  vec3 auroraColor = intensity * rampColor;
  
  fragColor = vec4(auroraColor * auroraAlpha, auroraAlpha);
}
`,vh=({colorStops:t=["#00d8ff","#7cff67","#00d8ff"],amplitude:e=1,blend:i=.5,speed:a=1,time:o,frozen:f=!1})=>{const c=T.useRef({colorStops:t,amplitude:e,blend:i,speed:a,time:o});c.current={colorStops:t,amplitude:e,blend:i,speed:a,time:o};const p=T.useRef(f);p.current=f;const d=T.useRef(null);return T.useEffect(()=>{const g=d.current;if(!g)return;const v=new dr({alpha:!0,premultipliedAlpha:!0,antialias:!0,preserveDrawingBuffer:!0}),m=v.gl;m.clearColor(0,0,0,0),m.enable(m.BLEND),m.blendFunc(m.ONE,m.ONE_MINUS_SRC_ALPHA),m.canvas.style.backgroundColor="transparent";let y;function x(){if(!g)return;const b=g.offsetWidth,A=g.offsetHeight;v.setSize(b,A),y&&(y.uniforms.uResolution.value=[b,A])}window.addEventListener("resize",x);const w=new pr(m);w.attributes.uv&&delete w.attributes.uv;const M=c.current.colorStops.map(b=>{const A=new $i(b);return[A.r,A.g,A.b]});y=new fr(m,{vertex:ph,fragment:mh,uniforms:{uTime:{value:0},uAmplitude:{value:c.current.amplitude},uColorStops:{value:M},uResolution:{value:[g.offsetWidth,g.offsetHeight]},uBlend:{value:c.current.blend}}});const R=new hr(m,{geometry:w,program:y});g.appendChild(m.canvas);let E=0;const _=b=>{if(E=requestAnimationFrame(_),p.current){v.render({scene:R});return}const{time:A,speed:D=1}=c.current;y.uniforms.uTime.value=(A??b*.01)*D*.1,y.uniforms.uAmplitude.value=c.current.amplitude??1,y.uniforms.uBlend.value=c.current.blend??.5;const L=c.current.colorStops??t;y.uniforms.uColorStops.value=L.map(O=>{const G=new $i(O);return[G.r,G.g,G.b]}),v.render({scene:R})};return E=requestAnimationFrame(_),x(),()=>{var b;cancelAnimationFrame(E),window.removeEventListener("resize",x),g&&m.canvas.parentNode===g&&g.removeChild(m.canvas),(b=m.getExtension("WEBGL_lose_context"))==null||b.loseContext()}},[]),S.jsx("div",{ref:d,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"linear-gradient(to bottom, #000814 0%, #001d3d 100%)"}})},gh={name:"Aurora",nameCn:"",icon:"",description:" (WebGL)",params:[{key:"speed",label:"",type:"range",min:.1,max:3,step:.1,default:1},{key:"amplitude",label:"",type:"range",min:.1,max:3,step:.1,default:1},{key:"blend",label:"",type:"range",min:.1,max:1,step:.05,default:.5},{key:"colorStops",label:"",type:"colors",default:["#00d8ff","#7cff67","#00d8ff"]}]},yh=({height:t=5,baseWidth:e=6.9,animationType:i="hover",glow:a=.5,offset:o={x:0,y:0},noise:f=.32,transparent:c=!0,scale:p=1.5,hueShift:d=.1,colorFrequency:g=1.5,hoverStrength:v=3.4,inertia:m=.12,bloom:y=2.7,suspendWhenOffscreen:x=!1,cycleDuration:w=60,frozen:M=!1})=>{const R=T.useRef(null),E=T.useRef(M);return T.useEffect(()=>{E.current=M},[M]),T.useEffect(()=>{const _=R.current;if(!_)return;const b=Math.max(.001,t),D=Math.max(.001,e)*.5,L=Math.max(0,a),O=Math.max(0,f),G=(o==null?void 0:o.x)??0,W=(o==null?void 0:o.y)??0,P=c?1.5:1,z=Math.max(.001,p),V=d||0,X=Math.max(0,g||1),N=Math.max(0,y||1),Z=1,J=1,te=1,k=Math.max(1,w||60),F=2*Math.PI/k,U=Math.max(0,v||1),j=Math.max(0,Math.min(1,m||.12)),q=Math.min(2,window.devicePixelRatio||1),$=new dr({dpr:q,alpha:c,antialias:!1,preserveDrawingBuffer:!0}),K=$.gl;K.disable(K.DEPTH_TEST),K.disable(K.CULL_FACE),K.disable(K.BLEND),Object.assign(K.canvas.style,{position:"absolute",inset:"0",width:"100%",height:"100%",display:"block"}),_.appendChild(K.canvas);const ie=`
      attribute vec2 position;
      void main() {
        gl_Position = vec4(position, 0.0, 1.0);
      }
    `,oe=`
      precision highp float;

      uniform vec2  iResolution;
      uniform float iTime;

      uniform float uHeight;
      uniform float uBaseHalf;
      uniform mat3  uRot;
      uniform int   uUseBaseWobble;
      uniform float uGlow;
      uniform vec2  uOffsetPx;
      uniform float uNoise;
      uniform float uSaturation;
      uniform float uScale;
      uniform float uHueShift;
      uniform float uColorFreq;
      uniform float uBloom;
      uniform float uCenterShift;
      uniform float uInvBaseHalf;
      uniform float uInvHeight;
      uniform float uMinAxis;
      uniform float uPxScale;
      uniform float uTimeScale;

      vec4 tanh4(vec4 x){
        vec4 e2x = exp(2.0*x);
        return (e2x - 1.0) / (e2x + 1.0);
      }

      float rand(vec2 co){
        return fract(sin(dot(co, vec2(12.9898, 78.233))) * 43758.5453123);
      }

      float sdOctaAnisoInv(vec3 p){
        vec3 q = vec3(abs(p.x) * uInvBaseHalf, abs(p.y) * uInvHeight, abs(p.z) * uInvBaseHalf);
        float m = q.x + q.y + q.z - 1.0;
        return m * uMinAxis * 0.5773502691896258;
      }

      float sdPyramidUpInv(vec3 p){
        float oct = sdOctaAnisoInv(p);
        float halfSpace = -p.y;
        return max(oct, halfSpace);
      }

      mat3 hueRotation(float a){
        float c = cos(a), s = sin(a);
        mat3 W = mat3(
          0.299, 0.587, 0.114,
          0.299, 0.587, 0.114,
          0.299, 0.587, 0.114
        );
        mat3 U = mat3(
           0.701, -0.587, -0.114,
          -0.299,  0.413, -0.114,
          -0.300, -0.588,  0.886
        );
        mat3 V = mat3(
           0.168, -0.331,  0.500,
           0.328,  0.035, -0.500,
          -0.497,  0.296,  0.201
        );
        return W + U * c + V * s;
      }

      void main(){
        vec2 f = (gl_FragCoord.xy - 0.5 * iResolution.xy - uOffsetPx) * uPxScale;

        float z = 5.0;
        float d = 0.0;

        vec3 p;
        vec4 o = vec4(0.0);

        float centerShift = uCenterShift;
        float cf = uColorFreq;

        mat2 wob = mat2(1.0);
        if (uUseBaseWobble == 1) {
          float t = iTime * uTimeScale;
          // 
          float c0 = cos(t * 1.0);
          float c1 = cos(t * 2.0 + 33.0);
          float c2 = cos(t * 3.0 + 11.0);
          wob = mat2(c0, c1, c2, c0);
        }

        const int STEPS = 100;
        for (int i = 0; i < STEPS; i++) {
          p = vec3(f, z);
          p.xz = p.xz * wob;
          p = uRot * p;
          vec3 q = p;
          q.y += centerShift;
          d = 0.1 + 0.2 * abs(sdPyramidUpInv(q));
          z -= d;
          o += (sin((p.y + z) * cf + vec4(0.0, 1.0, 2.0, 3.0)) + 1.0) / d;
        }

        o = tanh4(o * o * (uGlow * uBloom) / 1e5);

        vec3 col = o.rgb;
        float n = rand(gl_FragCoord.xy + vec2(iTime));
        col += (n - 0.5) * uNoise;
        col = clamp(col, 0.0, 1.0);

        float L = dot(col, vec3(0.2126, 0.7152, 0.0722));
        col = clamp(mix(vec3(L), col, uSaturation), 0.0, 1.0);

        if(abs(uHueShift) > 0.0001){
          col = clamp(hueRotation(uHueShift) * col, 0.0, 1.0);
        }

        gl_FragColor = vec4(col, o.a);
      }
    `,me=new pr(K),de=new Float32Array(2),xe=new Float32Array(2),he=new fr(K,{vertex:ie,fragment:oe,uniforms:{iResolution:{value:de},iTime:{value:0},uHeight:{value:b},uBaseHalf:{value:D},uUseBaseWobble:{value:1},uRot:{value:new Float32Array([1,0,0,0,1,0,0,0,1])},uGlow:{value:L},uOffsetPx:{value:xe},uNoise:{value:O},uSaturation:{value:P},uScale:{value:z},uHueShift:{value:V},uColorFreq:{value:X},uBloom:{value:N},uCenterShift:{value:b*.25},uInvBaseHalf:{value:1/D},uInvHeight:{value:1/b},uMinAxis:{value:Math.min(D,b)},uPxScale:{value:1/((K.drawingBufferHeight||1)*.1*z)},uTimeScale:{value:F}}}),ae=new hr(K,{geometry:me,program:he}),we=()=>{const Oe=_.clientWidth||1,Ye=_.clientHeight||1;$.setSize(Oe,Ye),de[0]=K.drawingBufferWidth,de[1]=K.drawingBufferHeight,xe[0]=G*q,xe[1]=W*q,he.uniforms.uPxScale.value=1/((K.drawingBufferHeight||1)*.1*z)},ue=new ResizeObserver(we);ue.observe(_),we();const Se=new Float32Array(9),ve=(Oe,Ye,ot,je)=>{const Lt=Math.cos(Oe),Ft=Math.sin(Oe),Bt=Math.cos(Ye),Wt=Math.sin(Ye),cn=Math.cos(ot),fn=Math.sin(ot),qr=Lt*cn+Ft*Wt*fn,Qr=-Lt*fn+Ft*Wt*cn,ss=Ft*Bt,ls=Bt*fn,as=Bt*cn,Zr=-Wt,vr=-Ft*cn+Lt*Wt*fn,os=Ft*fn+Lt*Wt*cn,_n=Lt*Bt;return je[0]=qr,je[1]=ls,je[2]=vr,je[3]=Qr,je[4]=as,je[5]=os,je[6]=ss,je[7]=Zr,je[8]=_n,je},se=O<1e-6;let ze=0;const De=performance.now(),Ge=()=>{ze||(ze=requestAnimationFrame(jn))},et=()=>{ze&&(cancelAnimationFrame(ze),ze=0)},At=1*Z,gt=2*J,on=3*te,Rt=0,Dn=0;let yt=0,Ze=0,ft=0,Nt=0,un=0;const mr=(Oe,Ye,ot)=>Oe+(Ye-Oe)*ot,It={x:0,y:0,inside:!0},is=Oe=>{const Ye=Math.max(1,window.innerWidth),ot=Math.max(1,window.innerHeight),je=Ye*.5,Lt=ot*.5,Ft=(Oe.clientX-je)/(Ye*.5),Bt=(Oe.clientY-Lt)/(ot*.5);It.x=Math.max(-1,Math.min(1,Ft)),It.y=Math.max(-1,Math.min(1,Bt)),It.inside=!0},Xr=()=>{It.inside=!1},Yr=()=>{It.inside=!1};let On=null;i==="hover"?(On=Oe=>{is(Oe),Ge()},window.addEventListener("pointermove",On,{passive:!0}),window.addEventListener("mouseleave",Xr),window.addEventListener("blur",Yr),he.uniforms.uUseBaseWobble.value=0):i==="3drotate"?he.uniforms.uUseBaseWobble.value=0:he.uniforms.uUseBaseWobble.value=1;const jn=Oe=>{if(E.current){$.render({scene:ae}),ze=requestAnimationFrame(jn);return}const Ye=(Oe-De)*.001;he.uniforms.iTime.value=Ye;let ot=!0;if(i==="hover"){const je=.6*U,Lt=.6*U;Nt=(It.inside?-It.x:0)*Lt,un=(It.inside?It.y:0)*je;const Ft=yt,Bt=Ze,Wt=ft;yt=mr(Ft,Nt,j),Ze=mr(Bt,un,j),ft=mr(Wt,0,.1),he.uniforms.uRot.value=ve(yt,Ze,ft,Se),se&&Math.abs(yt-Nt)<1e-4&&Math.abs(Ze-un)<1e-4&&Math.abs(ft)<1e-4&&(ot=!1)}else if(i==="3drotate"){const je=Ye*F;yt=je*gt,Ze=Math.sin(je*At+Rt)*.6,ft=Math.sin(je*on+Dn)*.5,he.uniforms.uRot.value=ve(yt,Ze,ft,Se),F<1e-6&&(ot=!1)}else Se[0]=1,Se[1]=0,Se[2]=0,Se[3]=0,Se[4]=1,Se[5]=0,Se[6]=0,Se[7]=0,Se[8]=1,he.uniforms.uRot.value=Se,F<1e-6&&(ot=!1);$.render({scene:ae}),ot?ze=requestAnimationFrame(jn):ze=0};if(x){const Oe=new IntersectionObserver(Ye=>{Ye.some(je=>je.isIntersecting)?Ge():et()});Oe.observe(_),Ge(),_.__prismIO=Oe}else Ge();return()=>{var Oe;if(et(),ue.disconnect(),i==="hover"&&(On&&window.removeEventListener("pointermove",On),window.removeEventListener("mouseleave",Xr),window.removeEventListener("blur",Yr)),x){const Ye=_.__prismIO;Ye&&Ye.disconnect(),delete _.__prismIO}K.canvas.parentElement===_&&_.removeChild(K.canvas),(Oe=K.getExtension("WEBGL_lose_context"))==null||Oe.loseContext()}},[t,e,i,a,f,o==null?void 0:o.x,o==null?void 0:o.y,p,c,d,g,w,v,m,y,x]),S.jsx("div",{ref:R,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"}})},xh={name:"Prism",nameCn:"",icon:"",description:"3D (WebGL)",params:[{key:"height",label:"",type:"range",min:1,max:10,step:.1,default:5},{key:"baseWidth",label:"",type:"range",min:1,max:15,step:.1,default:6.9},{key:"scale",label:"",type:"range",min:1,max:10,step:.1,default:1.5},{key:"glow",label:"",type:"range",min:0,max:3,step:.1,default:.5},{key:"bloom",label:"",type:"range",min:0,max:3,step:.1,default:2.7},{key:"noise",label:"",type:"range",min:0,max:1,step:.01,default:.32},{key:"hueShift",label:"",type:"range",min:-3.14,max:3.14,step:.1,default:.1},{key:"colorFrequency",label:"",type:"range",min:.1,max:3,step:.1,default:1.5},{key:"cycleDuration",label:"()",type:"range",min:30,max:120,step:5,default:60,hint:""},{key:"animationType",label:"",type:"select",options:[{label:"",value:"rotate"},{label:"",value:"hover"},{label:"3D",value:"3drotate"}],default:"hover"},{key:"hoverStrength",label:"",type:"range",min:.5,max:5,step:.1,default:3.4},{key:"inertia",label:"",type:"range",min:.01,max:.3,step:.01,default:.12},{key:"transparent",label:"",type:"toggle",default:!0}]};var Ou={exports:{}},Un={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */Un.ConcurrentRoot=1;Un.ContinuousEventPriority=4;Un.DefaultEventPriority=16;Un.DiscreteEventPriority=1;Un.IdleEventPriority=536870912;Un.LegacyRoot=0;Ou.exports=Un;var ar=Ou.exports;function wh(t){let e;const i=new Set,a=(g,v)=>{const m=typeof g=="function"?g(e):g;if(m!==e){const y=e;e=v?m:Object.assign({},e,m),i.forEach(x=>x(e,y))}},o=()=>e,f=(g,v=o,m=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let y=v(e);function x(){const w=v(e);if(!m(y,w)){const M=y;g(y=w,M)}}return i.add(x),()=>i.delete(x)},d={setState:a,getState:o,subscribe:(g,v,m)=>v||m?f(g,v,m):(i.add(g),()=>i.delete(g)),destroy:()=>i.clear()};return e=t(a,o,d),d}const Sh=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),nu=Sh?T.useEffect:T.useLayoutEffect;function Eh(t){const e=typeof t=="function"?wh(t):t,i=(a=e.getState,o=Object.is)=>{const[,f]=T.useReducer(R=>R+1,0),c=e.getState(),p=T.useRef(c),d=T.useRef(a),g=T.useRef(o),v=T.useRef(!1),m=T.useRef();m.current===void 0&&(m.current=a(c));let y,x=!1;(p.current!==c||d.current!==a||g.current!==o||v.current)&&(y=a(c),x=!o(m.current,y)),nu(()=>{x&&(m.current=y),p.current=c,d.current=a,g.current=o,v.current=!1});const w=T.useRef(c);nu(()=>{const R=()=>{try{const _=e.getState(),b=d.current(_);g.current(m.current,b)||(p.current=_,m.current=b,f())}catch{v.current=!0,f()}},E=e.subscribe(R);return e.getState()!==w.current&&R(),E},[]);const M=x?y:m.current;return T.useDebugValue(M),M};return Object.assign(i,e),i[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const a=[i,e];return{next(){const o=a.length<=0;return{value:a.shift(),done:o}}}},i}var ju={exports:{}},Rl={exports:{}},Ml={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ru;function Rh(){return ru||(ru=1,function(t){function e(k,F){var U=k.length;k.push(F);e:for(;0<U;){var j=U-1>>>1,q=k[j];if(0<o(q,F))k[j]=F,k[U]=q,U=j;else break e}}function i(k){return k.length===0?null:k[0]}function a(k){if(k.length===0)return null;var F=k[0],U=k.pop();if(U!==F){k[0]=U;e:for(var j=0,q=k.length,$=q>>>1;j<$;){var K=2*(j+1)-1,ie=k[K],oe=K+1,me=k[oe];if(0>o(ie,U))oe<q&&0>o(me,ie)?(k[j]=me,k[oe]=U,j=oe):(k[j]=ie,k[K]=U,j=K);else if(oe<q&&0>o(me,U))k[j]=me,k[oe]=U,j=oe;else break e}}return F}function o(k,F){var U=k.sortIndex-F.sortIndex;return U!==0?U:k.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var f=performance;t.unstable_now=function(){return f.now()}}else{var c=Date,p=c.now();t.unstable_now=function(){return c.now()-p}}var d=[],g=[],v=1,m=null,y=3,x=!1,w=!1,M=!1,R=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(k){for(var F=i(g);F!==null;){if(F.callback===null)a(g);else if(F.startTime<=k)a(g),F.sortIndex=F.expirationTime,e(d,F);else break;F=i(g)}}function A(k){if(M=!1,b(k),!w)if(i(d)!==null)w=!0,J(D);else{var F=i(g);F!==null&&te(A,F.startTime-k)}}function D(k,F){w=!1,M&&(M=!1,E(G),G=-1),x=!0;var U=y;try{for(b(F),m=i(d);m!==null&&(!(m.expirationTime>F)||k&&!z());){var j=m.callback;if(typeof j=="function"){m.callback=null,y=m.priorityLevel;var q=j(m.expirationTime<=F);F=t.unstable_now(),typeof q=="function"?m.callback=q:m===i(d)&&a(d),b(F)}else a(d);m=i(d)}if(m!==null)var $=!0;else{var K=i(g);K!==null&&te(A,K.startTime-F),$=!1}return $}finally{m=null,y=U,x=!1}}var L=!1,O=null,G=-1,W=5,P=-1;function z(){return!(t.unstable_now()-P<W)}function V(){if(O!==null){var k=t.unstable_now();P=k;var F=!0;try{F=O(!0,k)}finally{F?X():(L=!1,O=null)}}else L=!1}var X;if(typeof _=="function")X=function(){_(V)};else if(typeof MessageChannel<"u"){var N=new MessageChannel,Z=N.port2;N.port1.onmessage=V,X=function(){Z.postMessage(null)}}else X=function(){R(V,0)};function J(k){O=k,L||(L=!0,X())}function te(k,F){G=R(function(){k(t.unstable_now())},F)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(k){k.callback=null},t.unstable_continueExecution=function(){w||x||(w=!0,J(D))},t.unstable_forceFrameRate=function(k){0>k||125<k?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):W=0<k?Math.floor(1e3/k):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_getFirstCallbackNode=function(){return i(d)},t.unstable_next=function(k){switch(y){case 1:case 2:case 3:var F=3;break;default:F=y}var U=y;y=F;try{return k()}finally{y=U}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(k,F){switch(k){case 1:case 2:case 3:case 4:case 5:break;default:k=3}var U=y;y=k;try{return F()}finally{y=U}},t.unstable_scheduleCallback=function(k,F,U){var j=t.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?j+U:j):U=j,k){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=U+q,k={id:v++,callback:F,priorityLevel:k,startTime:U,expirationTime:q,sortIndex:-1},U>j?(k.sortIndex=U,e(g,k),i(d)===null&&k===i(g)&&(M?(E(G),G=-1):M=!0,te(A,U-j))):(k.sortIndex=q,e(d,k),w||x||(w=!0,J(D))),k},t.unstable_shouldYield=z,t.unstable_wrapCallback=function(k){var F=y;return function(){var U=y;y=F;try{return k.apply(this,arguments)}finally{y=U}}}}(Ml)),Ml}var iu;function Mh(){return iu||(iu=1,Rl.exports=Rh()),Rl.exports}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ch=function(e){var i={},a=T,o=Mh(),f=Object.assign;function c(n){for(var r="https://reactjs.org/docs/error-decoder.html?invariant="+n,s=1;s<arguments.length;s++)r+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+n+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var p=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,d=Symbol.for("react.element"),g=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),m=Symbol.for("react.strict_mode"),y=Symbol.for("react.profiler"),x=Symbol.for("react.provider"),w=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),E=Symbol.for("react.suspense_list"),_=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),A=Symbol.for("react.offscreen"),D=Symbol.iterator;function L(n){return n===null||typeof n!="object"?null:(n=D&&n[D]||n["@@iterator"],typeof n=="function"?n:null)}function O(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case v:return"Fragment";case g:return"Portal";case y:return"Profiler";case m:return"StrictMode";case R:return"Suspense";case E:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case w:return(n.displayName||"Context")+".Consumer";case x:return(n._context.displayName||"Context")+".Provider";case M:var r=n.render;return n=n.displayName,n||(n=r.displayName||r.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case _:return r=n.displayName||null,r!==null?r:O(n.type)||"Memo";case b:r=n._payload,n=n._init;try{return O(n(r))}catch{}}return null}function G(n){var r=n.type;switch(n.tag){case 24:return"Cache";case 9:return(r.displayName||"Context")+".Consumer";case 10:return(r._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=r.render,n=n.displayName||n.name||"",r.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return r;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return O(r);case 8:return r===m?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r}return null}function W(n){var r=n,s=n;if(n.alternate)for(;r.return;)r=r.return;else{n=r;do r=n,r.flags&4098&&(s=r.return),n=r.return;while(n)}return r.tag===3?s:null}function P(n){if(W(n)!==n)throw Error(c(188))}function z(n){var r=n.alternate;if(!r){if(r=W(n),r===null)throw Error(c(188));return r!==n?null:n}for(var s=n,l=r;;){var u=s.return;if(u===null)break;var h=u.alternate;if(h===null){if(l=u.return,l!==null){s=l;continue}break}if(u.child===h.child){for(h=u.child;h;){if(h===s)return P(u),n;if(h===l)return P(u),r;h=h.sibling}throw Error(c(188))}if(s.return!==l.return)s=u,l=h;else{for(var C=!1,I=u.child;I;){if(I===s){C=!0,s=u,l=h;break}if(I===l){C=!0,l=u,s=h;break}I=I.sibling}if(!C){for(I=h.child;I;){if(I===s){C=!0,s=h,l=u;break}if(I===l){C=!0,l=h,s=u;break}I=I.sibling}if(!C)throw Error(c(189))}}if(s.alternate!==l)throw Error(c(190))}if(s.tag!==3)throw Error(c(188));return s.stateNode.current===s?n:r}function V(n){return n=z(n),n!==null?X(n):null}function X(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var r=X(n);if(r!==null)return r;n=n.sibling}return null}function N(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){if(n.tag!==4){var r=N(n);if(r!==null)return r}n=n.sibling}return null}var Z=Array.isArray,J=e.getPublicInstance,te=e.getRootHostContext,k=e.getChildHostContext,F=e.prepareForCommit,U=e.resetAfterCommit,j=e.createInstance,q=e.appendInitialChild,$=e.finalizeInitialChildren,K=e.prepareUpdate,ie=e.shouldSetTextContent,oe=e.createTextInstance,me=e.scheduleTimeout,de=e.cancelTimeout,xe=e.noTimeout,he=e.isPrimaryRenderer,ae=e.supportsMutation,we=e.supportsPersistence,ue=e.supportsHydration,Se=e.getInstanceFromNode,ve=e.preparePortalMount,se=e.getCurrentEventPriority,ze=e.detachDeletedInstance,De=e.supportsMicrotasks,Ge=e.scheduleMicrotask,et=e.supportsTestSelectors,At=e.findFiberRoot,gt=e.getBoundingRect,on=e.getTextContent,Rt=e.isHiddenSubtree,Dn=e.matchAccessibilityRole,yt=e.setFocusIfFocusable,Ze=e.setupIntersectionObserver,ft=e.appendChild,Nt=e.appendChildToContainer,un=e.commitTextUpdate,mr=e.commitMount,It=e.commitUpdate,is=e.insertBefore,Xr=e.insertInContainerBefore,Yr=e.removeChild,On=e.removeChildFromContainer,jn=e.resetTextContent,Oe=e.hideInstance,Ye=e.hideTextInstance,ot=e.unhideInstance,je=e.unhideTextInstance,Lt=e.clearContainer,Ft=e.cloneInstance,Bt=e.createContainerChildSet,Wt=e.appendChildToContainerChildSet,cn=e.finalizeContainerChildren,fn=e.replaceContainerChildren,qr=e.cloneHiddenInstance,Qr=e.cloneHiddenTextInstance,ss=e.canHydrateInstance,ls=e.canHydrateTextInstance,as=e.canHydrateSuspenseInstance,Zr=e.isSuspenseInstancePending,vr=e.isSuspenseInstanceFallback,os=e.registerSuspenseInstanceRetry,_n=e.getNextHydratableSibling,hc=e.getFirstHydratableChild,pc=e.getFirstHydratableChildWithinContainer,mc=e.getFirstHydratableChildWithinSuspenseInstance,vc=e.hydrateInstance,gc=e.hydrateTextInstance,yc=e.hydrateSuspenseInstance,xc=e.getNextHydratableInstanceAfterSuspenseInstance,Jl=e.commitHydratedContainer,wc=e.commitHydratedSuspenseInstance,Sc=e.clearSuspenseBoundary,Ec=e.clearSuspenseBoundaryFromContainer,Rc=e.shouldDeleteUnhydratedTailInstances,Mc=e.didNotMatchHydratedContainerTextInstance,Cc=e.didNotMatchHydratedTextInstance,us;function gr(n){if(us===void 0)try{throw Error()}catch(s){var r=s.stack.trim().match(/\n( *(at )?)/);us=r&&r[1]||""}return`
`+us+n}var cs=!1;function fs(n,r){if(!n||cs)return"";cs=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(r)if(r=function(){throw Error()},Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(r,[])}catch(ee){var l=ee}Reflect.construct(n,[],r)}else{try{r.call()}catch(ee){l=ee}n.call(r.prototype)}else{try{throw Error()}catch(ee){l=ee}n()}}catch(ee){if(ee&&l&&typeof ee.stack=="string"){for(var u=ee.stack.split(`
`),h=l.stack.split(`
`),C=u.length-1,I=h.length-1;1<=C&&0<=I&&u[C]!==h[I];)I--;for(;1<=C&&0<=I;C--,I--)if(u[C]!==h[I]){if(C!==1||I!==1)do if(C--,I--,0>I||u[C]!==h[I]){var Q=`
`+u[C].replace(" at new "," at ");return n.displayName&&Q.includes("<anonymous>")&&(Q=Q.replace("<anonymous>",n.displayName)),Q}while(1<=C&&0<=I);break}}}finally{cs=!1,Error.prepareStackTrace=s}return(n=n?n.displayName||n.name:"")?gr(n):""}var _c=Object.prototype.hasOwnProperty,ds=[],Hn=-1;function dn(n){return{current:n}}function Ie(n){0>Hn||(n.current=ds[Hn],ds[Hn]=null,Hn--)}function Ne(n,r){Hn++,ds[Hn]=n.current,n.current=r}var hn={},rt=dn(hn),dt=dn(!1),Tn=hn;function Gn(n,r){var s=n.type.contextTypes;if(!s)return hn;var l=n.stateNode;if(l&&l.__reactInternalMemoizedUnmaskedChildContext===r)return l.__reactInternalMemoizedMaskedChildContext;var u={},h;for(h in s)u[h]=r[h];return l&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=r,n.__reactInternalMemoizedMaskedChildContext=u),u}function ht(n){return n=n.childContextTypes,n!=null}function Kr(){Ie(dt),Ie(rt)}function $l(n,r,s){if(rt.current!==hn)throw Error(c(168));Ne(rt,r),Ne(dt,s)}function ea(n,r,s){var l=n.stateNode;if(r=r.childContextTypes,typeof l.getChildContext!="function")return s;l=l.getChildContext();for(var u in l)if(!(u in r))throw Error(c(108,G(n)||"Unknown",u));return f({},s,l)}function Jr(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||hn,Tn=rt.current,Ne(rt,n),Ne(dt,dt.current),!0}function ta(n,r,s){var l=n.stateNode;if(!l)throw Error(c(169));s?(n=ea(n,r,Tn),l.__reactInternalMemoizedMergedChildContext=n,Ie(dt),Ie(rt),Ne(rt,n)):Ie(dt),Ne(dt,s)}var Ut=Math.clz32?Math.clz32:Pc,Tc=Math.log,bc=Math.LN2;function Pc(n){return n>>>=0,n===0?32:31-(Tc(n)/bc|0)|0}var $r=64,ei=4194304;function yr(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function ti(n,r){var s=n.pendingLanes;if(s===0)return 0;var l=0,u=n.suspendedLanes,h=n.pingedLanes,C=s&268435455;if(C!==0){var I=C&~u;I!==0?l=yr(I):(h&=C,h!==0&&(l=yr(h)))}else C=s&~u,C!==0?l=yr(C):h!==0&&(l=yr(h));if(l===0)return 0;if(r!==0&&r!==l&&!(r&u)&&(u=l&-l,h=r&-r,u>=h||u===16&&(h&4194240)!==0))return r;if(l&4&&(l|=s&16),r=n.entangledLanes,r!==0)for(n=n.entanglements,r&=l;0<r;)s=31-Ut(r),u=1<<s,l|=n[s],r&=~u;return l}function kc(n,r){switch(n){case 1:case 2:case 4:return r+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zc(n,r){for(var s=n.suspendedLanes,l=n.pingedLanes,u=n.expirationTimes,h=n.pendingLanes;0<h;){var C=31-Ut(h),I=1<<C,Q=u[C];Q===-1?(!(I&s)||I&l)&&(u[C]=kc(I,r)):Q<=r&&(n.expiredLanes|=I),h&=~I}}function hs(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function ps(n){for(var r=[],s=0;31>s;s++)r.push(n);return r}function xr(n,r,s){n.pendingLanes|=r,r!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,r=31-Ut(r),n[r]=s}function Ac(n,r){var s=n.pendingLanes&~r;n.pendingLanes=r,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=r,n.mutableReadLanes&=r,n.entangledLanes&=r,r=n.entanglements;var l=n.eventTimes;for(n=n.expirationTimes;0<s;){var u=31-Ut(s),h=1<<u;r[u]=0,l[u]=-1,n[u]=-1,s&=~h}}function ms(n,r){var s=n.entangledLanes|=r;for(n=n.entanglements;s;){var l=31-Ut(s),u=1<<l;u&r|n[l]&r&&(n[l]|=r),s&=~u}}var _e=0;function na(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var vs=o.unstable_scheduleCallback,ra=o.unstable_cancelCallback,Nc=o.unstable_shouldYield,Ic=o.unstable_requestPaint,Ke=o.unstable_now,gs=o.unstable_ImmediatePriority,Lc=o.unstable_UserBlockingPriority,ys=o.unstable_NormalPriority,Fc=o.unstable_IdlePriority,ni=null,Vt=null;function Bc(n){if(Vt&&typeof Vt.onCommitFiberRoot=="function")try{Vt.onCommitFiberRoot(ni,n,void 0,(n.current.flags&128)===128)}catch{}}function Uc(n,r){return n===r&&(n!==0||1/n===1/r)||n!==n&&r!==r}var Xt=typeof Object.is=="function"?Object.is:Uc,en=null,ri=!1,xs=!1;function ia(n){en===null?en=[n]:en.push(n)}function Dc(n){ri=!0,ia(n)}function Yt(){if(!xs&&en!==null){xs=!0;var n=0,r=_e;try{var s=en;for(_e=1;n<s.length;n++){var l=s[n];do l=l(!0);while(l!==null)}en=null,ri=!1}catch(u){throw en!==null&&(en=en.slice(n+1)),vs(gs,Yt),u}finally{_e=r,xs=!1}}return null}var Oc=p.ReactCurrentBatchConfig;function ii(n,r){if(Xt(n,r))return!0;if(typeof n!="object"||n===null||typeof r!="object"||r===null)return!1;var s=Object.keys(n),l=Object.keys(r);if(s.length!==l.length)return!1;for(l=0;l<s.length;l++){var u=s[l];if(!_c.call(r,u)||!Xt(n[u],r[u]))return!1}return!0}function jc(n){switch(n.tag){case 5:return gr(n.type);case 16:return gr("Lazy");case 13:return gr("Suspense");case 19:return gr("SuspenseList");case 0:case 2:case 15:return n=fs(n.type,!1),n;case 11:return n=fs(n.type.render,!1),n;case 1:return n=fs(n.type,!0),n;default:return""}}function Dt(n,r){if(n&&n.defaultProps){r=f({},r),n=n.defaultProps;for(var s in n)r[s]===void 0&&(r[s]=n[s]);return r}return r}var si=dn(null),li=null,Wn=null,ws=null;function Ss(){ws=Wn=li=null}function sa(n,r,s){he?(Ne(si,r._currentValue),r._currentValue=s):(Ne(si,r._currentValue2),r._currentValue2=s)}function Es(n){var r=si.current;Ie(si),he?n._currentValue=r:n._currentValue2=r}function Rs(n,r,s){for(;n!==null;){var l=n.alternate;if((n.childLanes&r)!==r?(n.childLanes|=r,l!==null&&(l.childLanes|=r)):l!==null&&(l.childLanes&r)!==r&&(l.childLanes|=r),n===s)break;n=n.return}}function Vn(n,r){li=n,ws=Wn=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&r&&(St=!0),n.firstContext=null)}function Mt(n){var r=he?n._currentValue:n._currentValue2;if(ws!==n)if(n={context:n,memoizedValue:r,next:null},Wn===null){if(li===null)throw Error(c(308));Wn=n,li.dependencies={lanes:0,firstContext:n}}else Wn=Wn.next=n;return r}var qt=null,pn=!1;function Ms(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function la(n,r){n=n.updateQueue,r.updateQueue===n&&(r.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function tn(n,r){return{eventTime:n,lane:r,tag:0,payload:null,callback:null,next:null}}function mn(n,r){var s=n.updateQueue;s!==null&&(s=s.shared,Ve!==null&&n.mode&1&&!(Re&2)?(n=s.interleaved,n===null?(r.next=r,qt===null?qt=[s]:qt.push(s)):(r.next=n.next,n.next=r),s.interleaved=r):(n=s.pending,n===null?r.next=r:(r.next=n.next,n.next=r),s.pending=r))}function ai(n,r,s){if(r=r.updateQueue,r!==null&&(r=r.shared,(s&4194240)!==0)){var l=r.lanes;l&=n.pendingLanes,s|=l,r.lanes=s,ms(n,s)}}function aa(n,r){var s=n.updateQueue,l=n.alternate;if(l!==null&&(l=l.updateQueue,s===l)){var u=null,h=null;if(s=s.firstBaseUpdate,s!==null){do{var C={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};h===null?u=h=C:h=h.next=C,s=s.next}while(s!==null);h===null?u=h=r:h=h.next=r}else u=h=r;s={baseState:l.baseState,firstBaseUpdate:u,lastBaseUpdate:h,shared:l.shared,effects:l.effects},n.updateQueue=s;return}n=s.lastBaseUpdate,n===null?s.firstBaseUpdate=r:n.next=r,s.lastBaseUpdate=r}function oi(n,r,s,l){var u=n.updateQueue;pn=!1;var h=u.firstBaseUpdate,C=u.lastBaseUpdate,I=u.shared.pending;if(I!==null){u.shared.pending=null;var Q=I,ee=Q.next;Q.next=null,C===null?h=ee:C.next=ee,C=Q;var le=n.alternate;le!==null&&(le=le.updateQueue,I=le.lastBaseUpdate,I!==C&&(I===null?le.firstBaseUpdate=ee:I.next=ee,le.lastBaseUpdate=Q))}if(h!==null){var ge=u.baseState;C=0,le=ee=Q=null,I=h;do{var pe=I.lane,Ae=I.eventTime;if((l&pe)===pe){le!==null&&(le=le.next={eventTime:Ae,lane:0,tag:I.tag,payload:I.payload,callback:I.callback,next:null});e:{var fe=n,at=I;switch(pe=r,Ae=s,at.tag){case 1:if(fe=at.payload,typeof fe=="function"){ge=fe.call(Ae,ge,pe);break e}ge=fe;break e;case 3:fe.flags=fe.flags&-65537|128;case 0:if(fe=at.payload,pe=typeof fe=="function"?fe.call(Ae,ge,pe):fe,pe==null)break e;ge=f({},ge,pe);break e;case 2:pn=!0}}I.callback!==null&&I.lane!==0&&(n.flags|=64,pe=u.effects,pe===null?u.effects=[I]:pe.push(I))}else Ae={eventTime:Ae,lane:pe,tag:I.tag,payload:I.payload,callback:I.callback,next:null},le===null?(ee=le=Ae,Q=ge):le=le.next=Ae,C|=pe;if(I=I.next,I===null){if(I=u.shared.pending,I===null)break;pe=I,I=pe.next,pe.next=null,u.lastBaseUpdate=pe,u.shared.pending=null}}while(!0);if(le===null&&(Q=ge),u.baseState=Q,u.firstBaseUpdate=ee,u.lastBaseUpdate=le,r=u.shared.interleaved,r!==null){u=r;do C|=u.lane,u=u.next;while(u!==r)}else h===null&&(u.shared.lanes=0);er|=C,n.lanes=C,n.memoizedState=ge}}function oa(n,r,s){if(n=r.effects,r.effects=null,n!==null)for(r=0;r<n.length;r++){var l=n[r],u=l.callback;if(u!==null){if(l.callback=null,l=s,typeof u!="function")throw Error(c(191,u));u.call(l)}}}var ua=new a.Component().refs;function Cs(n,r,s,l){r=n.memoizedState,s=s(l,r),s=s==null?r:f({},r,s),n.memoizedState=s,n.lanes===0&&(n.updateQueue.baseState=s)}var ui={isMounted:function(n){return(n=n._reactInternals)?W(n)===n:!1},enqueueSetState:function(n,r,s){n=n._reactInternals;var l=ct(),u=yn(n),h=tn(l,u);h.payload=r,s!=null&&(h.callback=s),mn(n,h),r=Pt(n,u,l),r!==null&&ai(r,n,u)},enqueueReplaceState:function(n,r,s){n=n._reactInternals;var l=ct(),u=yn(n),h=tn(l,u);h.tag=1,h.payload=r,s!=null&&(h.callback=s),mn(n,h),r=Pt(n,u,l),r!==null&&ai(r,n,u)},enqueueForceUpdate:function(n,r){n=n._reactInternals;var s=ct(),l=yn(n),u=tn(s,l);u.tag=2,r!=null&&(u.callback=r),mn(n,u),r=Pt(n,l,s),r!==null&&ai(r,n,l)}};function ca(n,r,s,l,u,h,C){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(l,h,C):r.prototype&&r.prototype.isPureReactComponent?!ii(s,l)||!ii(u,h):!0}function fa(n,r,s){var l=!1,u=hn,h=r.contextType;return typeof h=="object"&&h!==null?h=Mt(h):(u=ht(r)?Tn:rt.current,l=r.contextTypes,h=(l=l!=null)?Gn(n,u):hn),r=new r(s,h),n.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=ui,n.stateNode=r,r._reactInternals=n,l&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=u,n.__reactInternalMemoizedMaskedChildContext=h),r}function da(n,r,s,l){n=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(s,l),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(s,l),r.state!==n&&ui.enqueueReplaceState(r,r.state,null)}function _s(n,r,s,l){var u=n.stateNode;u.props=s,u.state=n.memoizedState,u.refs=ua,Ms(n);var h=r.contextType;typeof h=="object"&&h!==null?u.context=Mt(h):(h=ht(r)?Tn:rt.current,u.context=Gn(n,h)),u.state=n.memoizedState,h=r.getDerivedStateFromProps,typeof h=="function"&&(Cs(n,r,h,s),u.state=n.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof u.getSnapshotBeforeUpdate=="function"||typeof u.UNSAFE_componentWillMount!="function"&&typeof u.componentWillMount!="function"||(r=u.state,typeof u.componentWillMount=="function"&&u.componentWillMount(),typeof u.UNSAFE_componentWillMount=="function"&&u.UNSAFE_componentWillMount(),r!==u.state&&ui.enqueueReplaceState(u,u.state,null),oi(n,s,u,l),u.state=n.memoizedState),typeof u.componentDidMount=="function"&&(n.flags|=4194308)}var Xn=[],Yn=0,ci=null,fi=0,Ct=[],_t=0,bn=null,nn=1,rn="";function Pn(n,r){Xn[Yn++]=fi,Xn[Yn++]=ci,ci=n,fi=r}function ha(n,r,s){Ct[_t++]=nn,Ct[_t++]=rn,Ct[_t++]=bn,bn=n;var l=nn;n=rn;var u=32-Ut(l)-1;l&=~(1<<u),s+=1;var h=32-Ut(r)+u;if(30<h){var C=u-u%5;h=(l&(1<<C)-1).toString(32),l>>=C,u-=C,nn=1<<32-Ut(r)+u|s<<u|l,rn=h+n}else nn=1<<h|s<<u|l,rn=n}function Ts(n){n.return!==null&&(Pn(n,1),ha(n,1,0))}function bs(n){for(;n===ci;)ci=Xn[--Yn],Xn[Yn]=null,fi=Xn[--Yn],Xn[Yn]=null;for(;n===bn;)bn=Ct[--_t],Ct[_t]=null,rn=Ct[--_t],Ct[_t]=null,nn=Ct[--_t],Ct[_t]=null}var xt=null,wt=null,Fe=!1,wr=!1,Ot=null;function pa(n,r){var s=kt(5,null,null,0);s.elementType="DELETED",s.stateNode=r,s.return=n,r=n.deletions,r===null?(n.deletions=[s],n.flags|=16):r.push(s)}function ma(n,r){switch(n.tag){case 5:return r=ss(r,n.type,n.pendingProps),r!==null?(n.stateNode=r,xt=n,wt=hc(r),!0):!1;case 6:return r=ls(r,n.pendingProps),r!==null?(n.stateNode=r,xt=n,wt=null,!0):!1;case 13:if(r=as(r),r!==null){var s=bn!==null?{id:nn,overflow:rn}:null;return n.memoizedState={dehydrated:r,treeContext:s,retryLane:1073741824},s=kt(18,null,null,0),s.stateNode=r,s.return=n,n.child=s,xt=n,wt=null,!0}return!1;default:return!1}}function Ps(n){return(n.mode&1)!==0&&(n.flags&128)===0}function ks(n){if(Fe){var r=wt;if(r){var s=r;if(!ma(n,r)){if(Ps(n))throw Error(c(418));r=_n(s);var l=xt;r&&ma(n,r)?pa(l,s):(n.flags=n.flags&-4097|2,Fe=!1,xt=n)}}else{if(Ps(n))throw Error(c(418));n.flags=n.flags&-4097|2,Fe=!1,xt=n}}}function va(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;xt=n}function Sr(n){if(!ue||n!==xt)return!1;if(!Fe)return va(n),Fe=!0,!1;if(n.tag!==3&&(n.tag!==5||Rc(n.type)&&!ie(n.type,n.memoizedProps))){var r=wt;if(r){if(Ps(n)){for(n=wt;n;)n=_n(n);throw Error(c(418))}for(;r;)pa(n,r),r=_n(r)}}if(va(n),n.tag===13){if(!ue)throw Error(c(316));if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(c(317));wt=xc(n)}else wt=xt?_n(n.stateNode):null;return!0}function qn(){ue&&(wt=xt=null,wr=Fe=!1)}function zs(n){Ot===null?Ot=[n]:Ot.push(n)}function Er(n,r,s){if(n=s.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(c(309));var l=s.stateNode}if(!l)throw Error(c(147,n));var u=l,h=""+n;return r!==null&&r.ref!==null&&typeof r.ref=="function"&&r.ref._stringRef===h?r.ref:(r=function(C){var I=u.refs;I===ua&&(I=u.refs={}),C===null?delete I[h]:I[h]=C},r._stringRef=h,r)}if(typeof n!="string")throw Error(c(284));if(!s._owner)throw Error(c(290,n))}return n}function di(n,r){throw n=Object.prototype.toString.call(r),Error(c(31,n==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":n))}function ga(n){var r=n._init;return r(n._payload)}function ya(n){function r(H,B){if(n){var Y=H.deletions;Y===null?(H.deletions=[B],H.flags|=16):Y.push(B)}}function s(H,B){if(!n)return null;for(;B!==null;)r(H,B),B=B.sibling;return null}function l(H,B){for(H=new Map;B!==null;)B.key!==null?H.set(B.key,B):H.set(B.index,B),B=B.sibling;return H}function u(H,B){return H=wn(H,B),H.index=0,H.sibling=null,H}function h(H,B,Y){return H.index=Y,n?(Y=H.alternate,Y!==null?(Y=Y.index,Y<B?(H.flags|=2,B):Y):(H.flags|=2,B)):(H.flags|=1048576,B)}function C(H){return n&&H.alternate===null&&(H.flags|=2),H}function I(H,B,Y,re){return B===null||B.tag!==6?(B=pl(Y,H.mode,re),B.return=H,B):(B=u(B,Y),B.return=H,B)}function Q(H,B,Y,re){var ce=Y.type;return ce===v?le(H,B,Y.props.children,re,Y.key):B!==null&&(B.elementType===ce||typeof ce=="object"&&ce!==null&&ce.$$typeof===b&&ga(ce)===B.type)?(re=u(B,Y.props),re.ref=Er(H,B,Y),re.return=H,re):(re=Gi(Y.type,Y.key,Y.props,null,H.mode,re),re.ref=Er(H,B,Y),re.return=H,re)}function ee(H,B,Y,re){return B===null||B.tag!==4||B.stateNode.containerInfo!==Y.containerInfo||B.stateNode.implementation!==Y.implementation?(B=ml(Y,H.mode,re),B.return=H,B):(B=u(B,Y.children||[]),B.return=H,B)}function le(H,B,Y,re,ce){return B===null||B.tag!==7?(B=Fn(Y,H.mode,re,ce),B.return=H,B):(B=u(B,Y),B.return=H,B)}function ge(H,B,Y){if(typeof B=="string"&&B!==""||typeof B=="number")return B=pl(""+B,H.mode,Y),B.return=H,B;if(typeof B=="object"&&B!==null){switch(B.$$typeof){case d:return Y=Gi(B.type,B.key,B.props,null,H.mode,Y),Y.ref=Er(H,null,B),Y.return=H,Y;case g:return B=ml(B,H.mode,Y),B.return=H,B;case b:var re=B._init;return ge(H,re(B._payload),Y)}if(Z(B)||L(B))return B=Fn(B,H.mode,Y,null),B.return=H,B;di(H,B)}return null}function pe(H,B,Y,re){var ce=B!==null?B.key:null;if(typeof Y=="string"&&Y!==""||typeof Y=="number")return ce!==null?null:I(H,B,""+Y,re);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case d:return Y.key===ce?Q(H,B,Y,re):null;case g:return Y.key===ce?ee(H,B,Y,re):null;case b:return ce=Y._init,pe(H,B,ce(Y._payload),re)}if(Z(Y)||L(Y))return ce!==null?null:le(H,B,Y,re,null);di(H,Y)}return null}function Ae(H,B,Y,re,ce){if(typeof re=="string"&&re!==""||typeof re=="number")return H=H.get(Y)||null,I(B,H,""+re,ce);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case d:return H=H.get(re.key===null?Y:re.key)||null,Q(B,H,re,ce);case g:return H=H.get(re.key===null?Y:re.key)||null,ee(B,H,re,ce);case b:var Ee=re._init;return Ae(H,B,Y,Ee(re._payload),ce)}if(Z(re)||L(re))return H=H.get(Y)||null,le(B,H,re,ce,null);di(B,re)}return null}function fe(H,B,Y,re){for(var ce=null,Ee=null,ye=B,Te=B=0,$e=null;ye!==null&&Te<Y.length;Te++){ye.index>Te?($e=ye,ye=null):$e=ye.sibling;var be=pe(H,ye,Y[Te],re);if(be===null){ye===null&&(ye=$e);break}n&&ye&&be.alternate===null&&r(H,ye),B=h(be,B,Te),Ee===null?ce=be:Ee.sibling=be,Ee=be,ye=$e}if(Te===Y.length)return s(H,ye),Fe&&Pn(H,Te),ce;if(ye===null){for(;Te<Y.length;Te++)ye=ge(H,Y[Te],re),ye!==null&&(B=h(ye,B,Te),Ee===null?ce=ye:Ee.sibling=ye,Ee=ye);return Fe&&Pn(H,Te),ce}for(ye=l(H,ye);Te<Y.length;Te++)$e=Ae(ye,H,Te,Y[Te],re),$e!==null&&(n&&$e.alternate!==null&&ye.delete($e.key===null?Te:$e.key),B=h($e,B,Te),Ee===null?ce=$e:Ee.sibling=$e,Ee=$e);return n&&ye.forEach(function(Sn){return r(H,Sn)}),Fe&&Pn(H,Te),ce}function at(H,B,Y,re){var ce=L(Y);if(typeof ce!="function")throw Error(c(150));if(Y=ce.call(Y),Y==null)throw Error(c(151));for(var Ee=ce=null,ye=B,Te=B=0,$e=null,be=Y.next();ye!==null&&!be.done;Te++,be=Y.next()){ye.index>Te?($e=ye,ye=null):$e=ye.sibling;var Sn=pe(H,ye,be.value,re);if(Sn===null){ye===null&&(ye=$e);break}n&&ye&&Sn.alternate===null&&r(H,ye),B=h(Sn,B,Te),Ee===null?ce=Sn:Ee.sibling=Sn,Ee=Sn,ye=$e}if(be.done)return s(H,ye),Fe&&Pn(H,Te),ce;if(ye===null){for(;!be.done;Te++,be=Y.next())be=ge(H,be.value,re),be!==null&&(B=h(be,B,Te),Ee===null?ce=be:Ee.sibling=be,Ee=be);return Fe&&Pn(H,Te),ce}for(ye=l(H,ye);!be.done;Te++,be=Y.next())be=Ae(ye,H,Te,be.value,re),be!==null&&(n&&be.alternate!==null&&ye.delete(be.key===null?Te:be.key),B=h(be,B,Te),Ee===null?ce=be:Ee.sibling=be,Ee=be);return n&&ye.forEach(function(yf){return r(H,yf)}),Fe&&Pn(H,Te),ce}function zt(H,B,Y,re){if(typeof Y=="object"&&Y!==null&&Y.type===v&&Y.key===null&&(Y=Y.props.children),typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case d:e:{for(var ce=Y.key,Ee=B;Ee!==null;){if(Ee.key===ce){if(ce=Y.type,ce===v){if(Ee.tag===7){s(H,Ee.sibling),B=u(Ee,Y.props.children),B.return=H,H=B;break e}}else if(Ee.elementType===ce||typeof ce=="object"&&ce!==null&&ce.$$typeof===b&&ga(ce)===Ee.type){s(H,Ee.sibling),B=u(Ee,Y.props),B.ref=Er(H,Ee,Y),B.return=H,H=B;break e}s(H,Ee);break}else r(H,Ee);Ee=Ee.sibling}Y.type===v?(B=Fn(Y.props.children,H.mode,re,Y.key),B.return=H,H=B):(re=Gi(Y.type,Y.key,Y.props,null,H.mode,re),re.ref=Er(H,B,Y),re.return=H,H=re)}return C(H);case g:e:{for(Ee=Y.key;B!==null;){if(B.key===Ee)if(B.tag===4&&B.stateNode.containerInfo===Y.containerInfo&&B.stateNode.implementation===Y.implementation){s(H,B.sibling),B=u(B,Y.children||[]),B.return=H,H=B;break e}else{s(H,B);break}else r(H,B);B=B.sibling}B=ml(Y,H.mode,re),B.return=H,H=B}return C(H);case b:return Ee=Y._init,zt(H,B,Ee(Y._payload),re)}if(Z(Y))return fe(H,B,Y,re);if(L(Y))return at(H,B,Y,re);di(H,Y)}return typeof Y=="string"&&Y!==""||typeof Y=="number"?(Y=""+Y,B!==null&&B.tag===6?(s(H,B.sibling),B=u(B,Y),B.return=H,H=B):(s(H,B),B=pl(Y,H.mode,re),B.return=H,H=B),C(H)):s(H,B)}return zt}var Qn=ya(!0),xa=ya(!1),Rr={},Tt=dn(Rr),Mr=dn(Rr),Zn=dn(Rr);function Qt(n){if(n===Rr)throw Error(c(174));return n}function As(n,r){Ne(Zn,r),Ne(Mr,n),Ne(Tt,Rr),n=te(r),Ie(Tt),Ne(Tt,n)}function Kn(){Ie(Tt),Ie(Mr),Ie(Zn)}function wa(n){var r=Qt(Zn.current),s=Qt(Tt.current);r=k(s,n.type,r),s!==r&&(Ne(Mr,n),Ne(Tt,r))}function Ns(n){Mr.current===n&&(Ie(Tt),Ie(Mr))}var Ue=dn(0);function hi(n){for(var r=n;r!==null;){if(r.tag===13){var s=r.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||Zr(s)||vr(s)))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if(r.flags&128)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var Is=[];function Ls(){for(var n=0;n<Is.length;n++){var r=Is[n];he?r._workInProgressVersionPrimary=null:r._workInProgressVersionSecondary=null}Is.length=0}var pi=p.ReactCurrentDispatcher,bt=p.ReactCurrentBatchConfig,Jn=0,He=null,it=null,Je=null,mi=!1,Cr=!1,_r=0,Hc=0;function st(){throw Error(c(321))}function Fs(n,r){if(r===null)return!1;for(var s=0;s<r.length&&s<n.length;s++)if(!Xt(n[s],r[s]))return!1;return!0}function Bs(n,r,s,l,u,h){if(Jn=h,He=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,pi.current=n===null||n.memoizedState===null?Xc:Yc,n=s(l,u),Cr){h=0;do{if(Cr=!1,_r=0,25<=h)throw Error(c(301));h+=1,Je=it=null,r.updateQueue=null,pi.current=qc,n=s(l,u)}while(Cr)}if(pi.current=wi,r=it!==null&&it.next!==null,Jn=0,Je=it=He=null,mi=!1,r)throw Error(c(300));return n}function Us(){var n=_r!==0;return _r=0,n}function sn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Je===null?He.memoizedState=Je=n:Je=Je.next=n,Je}function Zt(){if(it===null){var n=He.alternate;n=n!==null?n.memoizedState:null}else n=it.next;var r=Je===null?He.memoizedState:Je.next;if(r!==null)Je=r,it=n;else{if(n===null)throw Error(c(310));it=n,n={memoizedState:it.memoizedState,baseState:it.baseState,baseQueue:it.baseQueue,queue:it.queue,next:null},Je===null?He.memoizedState=Je=n:Je=Je.next=n}return Je}function kn(n,r){return typeof r=="function"?r(n):r}function vi(n){var r=Zt(),s=r.queue;if(s===null)throw Error(c(311));s.lastRenderedReducer=n;var l=it,u=l.baseQueue,h=s.pending;if(h!==null){if(u!==null){var C=u.next;u.next=h.next,h.next=C}l.baseQueue=u=h,s.pending=null}if(u!==null){h=u.next,l=l.baseState;var I=C=null,Q=null,ee=h;do{var le=ee.lane;if((Jn&le)===le)Q!==null&&(Q=Q.next={lane:0,action:ee.action,hasEagerState:ee.hasEagerState,eagerState:ee.eagerState,next:null}),l=ee.hasEagerState?ee.eagerState:n(l,ee.action);else{var ge={lane:le,action:ee.action,hasEagerState:ee.hasEagerState,eagerState:ee.eagerState,next:null};Q===null?(I=Q=ge,C=l):Q=Q.next=ge,He.lanes|=le,er|=le}ee=ee.next}while(ee!==null&&ee!==h);Q===null?C=l:Q.next=I,Xt(l,r.memoizedState)||(St=!0),r.memoizedState=l,r.baseState=C,r.baseQueue=Q,s.lastRenderedState=l}if(n=s.interleaved,n!==null){u=n;do h=u.lane,He.lanes|=h,er|=h,u=u.next;while(u!==n)}else u===null&&(s.lanes=0);return[r.memoizedState,s.dispatch]}function gi(n){var r=Zt(),s=r.queue;if(s===null)throw Error(c(311));s.lastRenderedReducer=n;var l=s.dispatch,u=s.pending,h=r.memoizedState;if(u!==null){s.pending=null;var C=u=u.next;do h=n(h,C.action),C=C.next;while(C!==u);Xt(h,r.memoizedState)||(St=!0),r.memoizedState=h,r.baseQueue===null&&(r.baseState=h),s.lastRenderedState=h}return[h,l]}function Sa(){}function Ea(n,r){var s=He,l=Zt(),u=r(),h=!Xt(l.memoizedState,u);if(h&&(l.memoizedState=u,St=!0),l=l.queue,br(Ca.bind(null,s,l,n),[n]),l.getSnapshot!==r||h||Je!==null&&Je.memoizedState.tag&1){if(s.flags|=2048,Tr(9,Ma.bind(null,s,l,u,r),void 0,null),Ve===null)throw Error(c(349));Jn&30||Ra(s,r,u)}return u}function Ra(n,r,s){n.flags|=16384,n={getSnapshot:r,value:s},r=He.updateQueue,r===null?(r={lastEffect:null,stores:null},He.updateQueue=r,r.stores=[n]):(s=r.stores,s===null?r.stores=[n]:s.push(n))}function Ma(n,r,s,l){r.value=s,r.getSnapshot=l,_a(r)&&Pt(n,1,-1)}function Ca(n,r,s){return s(function(){_a(r)&&Pt(n,1,-1)})}function _a(n){var r=n.getSnapshot;n=n.value;try{var s=r();return!Xt(n,s)}catch{return!0}}function Ds(n){var r=sn();return typeof n=="function"&&(n=n()),r.memoizedState=r.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:kn,lastRenderedState:n},r.queue=n,n=n.dispatch=Vc.bind(null,He,n),[r.memoizedState,n]}function Tr(n,r,s,l){return n={tag:n,create:r,destroy:s,deps:l,next:null},r=He.updateQueue,r===null?(r={lastEffect:null,stores:null},He.updateQueue=r,r.lastEffect=n.next=n):(s=r.lastEffect,s===null?r.lastEffect=n.next=n:(l=s.next,s.next=n,n.next=l,r.lastEffect=n)),n}function Ta(){return Zt().memoizedState}function yi(n,r,s,l){var u=sn();He.flags|=n,u.memoizedState=Tr(1|r,s,void 0,l===void 0?null:l)}function xi(n,r,s,l){var u=Zt();l=l===void 0?null:l;var h=void 0;if(it!==null){var C=it.memoizedState;if(h=C.destroy,l!==null&&Fs(l,C.deps)){u.memoizedState=Tr(r,s,h,l);return}}He.flags|=n,u.memoizedState=Tr(1|r,s,h,l)}function Os(n,r){return yi(8390656,8,n,r)}function br(n,r){return xi(2048,8,n,r)}function ba(n,r){return xi(4,2,n,r)}function Pa(n,r){return xi(4,4,n,r)}function ka(n,r){if(typeof r=="function")return n=n(),r(n),function(){r(null)};if(r!=null)return n=n(),r.current=n,function(){r.current=null}}function za(n,r,s){return s=s!=null?s.concat([n]):null,xi(4,4,ka.bind(null,r,n),s)}function js(){}function Aa(n,r){var s=Zt();r=r===void 0?null:r;var l=s.memoizedState;return l!==null&&r!==null&&Fs(r,l[1])?l[0]:(s.memoizedState=[n,r],n)}function Na(n,r){var s=Zt();r=r===void 0?null:r;var l=s.memoizedState;return l!==null&&r!==null&&Fs(r,l[1])?l[0]:(n=n(),s.memoizedState=[n,r],n)}function Gc(n,r){var s=_e;_e=s!==0&&4>s?s:4,n(!0);var l=bt.transition;bt.transition={};try{n(!1),r()}finally{_e=s,bt.transition=l}}function Ia(){return Zt().memoizedState}function Wc(n,r,s){var l=yn(n);s={lane:l,action:s,hasEagerState:!1,eagerState:null,next:null},La(n)?Fa(r,s):(Ba(n,r,s),s=ct(),n=Pt(n,l,s),n!==null&&Ua(n,r,l))}function Vc(n,r,s){var l=yn(n),u={lane:l,action:s,hasEagerState:!1,eagerState:null,next:null};if(La(n))Fa(r,u);else{Ba(n,r,u);var h=n.alternate;if(n.lanes===0&&(h===null||h.lanes===0)&&(h=r.lastRenderedReducer,h!==null))try{var C=r.lastRenderedState,I=h(C,s);if(u.hasEagerState=!0,u.eagerState=I,Xt(I,C))return}catch{}finally{}s=ct(),n=Pt(n,l,s),n!==null&&Ua(n,r,l)}}function La(n){var r=n.alternate;return n===He||r!==null&&r===He}function Fa(n,r){Cr=mi=!0;var s=n.pending;s===null?r.next=r:(r.next=s.next,s.next=r),n.pending=r}function Ba(n,r,s){Ve!==null&&n.mode&1&&!(Re&2)?(n=r.interleaved,n===null?(s.next=s,qt===null?qt=[r]:qt.push(r)):(s.next=n.next,n.next=s),r.interleaved=s):(n=r.pending,n===null?s.next=s:(s.next=n.next,n.next=s),r.pending=s)}function Ua(n,r,s){if(s&4194240){var l=r.lanes;l&=n.pendingLanes,s|=l,r.lanes=s,ms(n,s)}}var wi={readContext:Mt,useCallback:st,useContext:st,useEffect:st,useImperativeHandle:st,useInsertionEffect:st,useLayoutEffect:st,useMemo:st,useReducer:st,useRef:st,useState:st,useDebugValue:st,useDeferredValue:st,useTransition:st,useMutableSource:st,useSyncExternalStore:st,useId:st,unstable_isNewReconciler:!1},Xc={readContext:Mt,useCallback:function(n,r){return sn().memoizedState=[n,r===void 0?null:r],n},useContext:Mt,useEffect:Os,useImperativeHandle:function(n,r,s){return s=s!=null?s.concat([n]):null,yi(4194308,4,ka.bind(null,r,n),s)},useLayoutEffect:function(n,r){return yi(4194308,4,n,r)},useInsertionEffect:function(n,r){return yi(4,2,n,r)},useMemo:function(n,r){var s=sn();return r=r===void 0?null:r,n=n(),s.memoizedState=[n,r],n},useReducer:function(n,r,s){var l=sn();return r=s!==void 0?s(r):r,l.memoizedState=l.baseState=r,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:r},l.queue=n,n=n.dispatch=Wc.bind(null,He,n),[l.memoizedState,n]},useRef:function(n){var r=sn();return n={current:n},r.memoizedState=n},useState:Ds,useDebugValue:js,useDeferredValue:function(n){var r=Ds(n),s=r[0],l=r[1];return Os(function(){var u=bt.transition;bt.transition={};try{l(n)}finally{bt.transition=u}},[n]),s},useTransition:function(){var n=Ds(!1),r=n[0];return n=Gc.bind(null,n[1]),sn().memoizedState=n,[r,n]},useMutableSource:function(){},useSyncExternalStore:function(n,r,s){var l=He,u=sn();if(Fe){if(s===void 0)throw Error(c(407));s=s()}else{if(s=r(),Ve===null)throw Error(c(349));Jn&30||Ra(l,r,s)}u.memoizedState=s;var h={value:s,getSnapshot:r};return u.queue=h,Os(Ca.bind(null,l,h,n),[n]),l.flags|=2048,Tr(9,Ma.bind(null,l,h,s,r),void 0,null),s},useId:function(){var n=sn(),r=Ve.identifierPrefix;if(Fe){var s=rn,l=nn;s=(l&~(1<<32-Ut(l)-1)).toString(32)+s,r=":"+r+"R"+s,s=_r++,0<s&&(r+="H"+s.toString(32)),r+=":"}else s=Hc++,r=":"+r+"r"+s.toString(32)+":";return n.memoizedState=r},unstable_isNewReconciler:!1},Yc={readContext:Mt,useCallback:Aa,useContext:Mt,useEffect:br,useImperativeHandle:za,useInsertionEffect:ba,useLayoutEffect:Pa,useMemo:Na,useReducer:vi,useRef:Ta,useState:function(){return vi(kn)},useDebugValue:js,useDeferredValue:function(n){var r=vi(kn),s=r[0],l=r[1];return br(function(){var u=bt.transition;bt.transition={};try{l(n)}finally{bt.transition=u}},[n]),s},useTransition:function(){var n=vi(kn)[0],r=Zt().memoizedState;return[n,r]},useMutableSource:Sa,useSyncExternalStore:Ea,useId:Ia,unstable_isNewReconciler:!1},qc={readContext:Mt,useCallback:Aa,useContext:Mt,useEffect:br,useImperativeHandle:za,useInsertionEffect:ba,useLayoutEffect:Pa,useMemo:Na,useReducer:gi,useRef:Ta,useState:function(){return gi(kn)},useDebugValue:js,useDeferredValue:function(n){var r=gi(kn),s=r[0],l=r[1];return br(function(){var u=bt.transition;bt.transition={};try{l(n)}finally{bt.transition=u}},[n]),s},useTransition:function(){var n=gi(kn)[0],r=Zt().memoizedState;return[n,r]},useMutableSource:Sa,useSyncExternalStore:Ea,useId:Ia,unstable_isNewReconciler:!1};function Hs(n,r){try{var s="",l=r;do s+=jc(l),l=l.return;while(l);var u=s}catch(h){u=`
Error generating stack: `+h.message+`
`+h.stack}return{value:n,source:r,stack:u}}function Gs(n,r){try{console.error(r.value)}catch(s){setTimeout(function(){throw s})}}var Qc=typeof WeakMap=="function"?WeakMap:Map;function Da(n,r,s){s=tn(-1,s),s.tag=3,s.payload={element:null};var l=r.value;return s.callback=function(){Fi||(Fi=!0,al=l),Gs(n,r)},s}function Oa(n,r,s){s=tn(-1,s),s.tag=3;var l=n.type.getDerivedStateFromError;if(typeof l=="function"){var u=r.value;s.payload=function(){return l(u)},s.callback=function(){Gs(n,r)}}var h=n.stateNode;return h!==null&&typeof h.componentDidCatch=="function"&&(s.callback=function(){Gs(n,r),typeof l!="function"&&(vn===null?vn=new Set([this]):vn.add(this));var C=r.stack;this.componentDidCatch(r.value,{componentStack:C!==null?C:""})}),s}function ja(n,r,s){var l=n.pingCache;if(l===null){l=n.pingCache=new Qc;var u=new Set;l.set(r,u)}else u=l.get(r),u===void 0&&(u=new Set,l.set(r,u));u.has(s)||(u.add(s),n=cf.bind(null,n,r,s),r.then(n,n))}function Ha(n){do{var r;if((r=n.tag===13)&&(r=n.memoizedState,r=r!==null?r.dehydrated!==null:!0),r)return n;n=n.return}while(n!==null);return null}function Ga(n,r,s,l,u){return n.mode&1?(n.flags|=65536,n.lanes=u,n):(n===r?n.flags|=65536:(n.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(r=tn(-1,1),r.tag=2,mn(s,r))),s.lanes|=1),n)}function Kt(n){n.flags|=4}function Wa(n,r){if(n!==null&&n.child===r.child)return!0;if(r.flags&16)return!1;for(n=r.child;n!==null;){if(n.flags&12854||n.subtreeFlags&12854)return!1;n=n.sibling}return!0}var Pr,kr,Si,Ei;if(ae)Pr=function(n,r){for(var s=r.child;s!==null;){if(s.tag===5||s.tag===6)q(n,s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return;s=s.return}s.sibling.return=s.return,s=s.sibling}},kr=function(){},Si=function(n,r,s,l,u){if(n=n.memoizedProps,n!==l){var h=r.stateNode,C=Qt(Tt.current);s=K(h,s,n,l,u,C),(r.updateQueue=s)&&Kt(r)}},Ei=function(n,r,s,l){s!==l&&Kt(r)};else if(we){Pr=function(n,r,s,l){for(var u=r.child;u!==null;){if(u.tag===5){var h=u.stateNode;s&&l&&(h=qr(h,u.type,u.memoizedProps,u)),q(n,h)}else if(u.tag===6)h=u.stateNode,s&&l&&(h=Qr(h,u.memoizedProps,u)),q(n,h);else if(u.tag!==4){if(u.tag===22&&u.memoizedState!==null)h=u.child,h!==null&&(h.return=u),Pr(n,u,!0,!0);else if(u.child!==null){u.child.return=u,u=u.child;continue}}if(u===r)break;for(;u.sibling===null;){if(u.return===null||u.return===r)return;u=u.return}u.sibling.return=u.return,u=u.sibling}};var Va=function(n,r,s,l){for(var u=r.child;u!==null;){if(u.tag===5){var h=u.stateNode;s&&l&&(h=qr(h,u.type,u.memoizedProps,u)),Wt(n,h)}else if(u.tag===6)h=u.stateNode,s&&l&&(h=Qr(h,u.memoizedProps,u)),Wt(n,h);else if(u.tag!==4){if(u.tag===22&&u.memoizedState!==null)h=u.child,h!==null&&(h.return=u),Va(n,u,!0,!0);else if(u.child!==null){u.child.return=u,u=u.child;continue}}if(u===r)break;for(;u.sibling===null;){if(u.return===null||u.return===r)return;u=u.return}u.sibling.return=u.return,u=u.sibling}};kr=function(n,r){var s=r.stateNode;if(!Wa(n,r)){n=s.containerInfo;var l=Bt(n);Va(l,r,!1,!1),s.pendingChildren=l,Kt(r),cn(n,l)}},Si=function(n,r,s,l,u){var h=n.stateNode,C=n.memoizedProps;if((n=Wa(n,r))&&C===l)r.stateNode=h;else{var I=r.stateNode,Q=Qt(Tt.current),ee=null;C!==l&&(ee=K(I,s,C,l,u,Q)),n&&ee===null?r.stateNode=h:(h=Ft(h,ee,s,C,l,r,n,I),$(h,s,l,u,Q)&&Kt(r),r.stateNode=h,n?Kt(r):Pr(h,r,!1,!1))}},Ei=function(n,r,s,l){s!==l?(n=Qt(Zn.current),s=Qt(Tt.current),r.stateNode=oe(l,n,s,r),Kt(r)):r.stateNode=n.stateNode}}else kr=function(){},Si=function(){},Ei=function(){};function zr(n,r){if(!Fe)switch(n.tailMode){case"hidden":r=n.tail;for(var s=null;r!==null;)r.alternate!==null&&(s=r),r=r.sibling;s===null?n.tail=null:s.sibling=null;break;case"collapsed":s=n.tail;for(var l=null;s!==null;)s.alternate!==null&&(l=s),s=s.sibling;l===null?r||n.tail===null?n.tail=null:n.tail.sibling=null:l.sibling=null}}function lt(n){var r=n.alternate!==null&&n.alternate.child===n.child,s=0,l=0;if(r)for(var u=n.child;u!==null;)s|=u.lanes|u.childLanes,l|=u.subtreeFlags&14680064,l|=u.flags&14680064,u.return=n,u=u.sibling;else for(u=n.child;u!==null;)s|=u.lanes|u.childLanes,l|=u.subtreeFlags,l|=u.flags,u.return=n,u=u.sibling;return n.subtreeFlags|=l,n.childLanes=s,r}function Zc(n,r,s){var l=r.pendingProps;switch(bs(r),r.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return lt(r),null;case 1:return ht(r.type)&&Kr(),lt(r),null;case 3:return l=r.stateNode,Kn(),Ie(dt),Ie(rt),Ls(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(n===null||n.child===null)&&(Sr(r)?Kt(r):n===null||n.memoizedState.isDehydrated&&!(r.flags&256)||(r.flags|=1024,Ot!==null&&(cl(Ot),Ot=null))),kr(n,r),lt(r),null;case 5:Ns(r),s=Qt(Zn.current);var u=r.type;if(n!==null&&r.stateNode!=null)Si(n,r,u,l,s),n.ref!==r.ref&&(r.flags|=512,r.flags|=2097152);else{if(!l){if(r.stateNode===null)throw Error(c(166));return lt(r),null}if(n=Qt(Tt.current),Sr(r)){if(!ue)throw Error(c(175));n=vc(r.stateNode,r.type,r.memoizedProps,s,n,r,!wr),r.updateQueue=n,n!==null&&Kt(r)}else{var h=j(u,l,s,n,r);Pr(h,r,!1,!1),r.stateNode=h,$(h,u,l,s,n)&&Kt(r)}r.ref!==null&&(r.flags|=512,r.flags|=2097152)}return lt(r),null;case 6:if(n&&r.stateNode!=null)Ei(n,r,n.memoizedProps,l);else{if(typeof l!="string"&&r.stateNode===null)throw Error(c(166));if(n=Qt(Zn.current),s=Qt(Tt.current),Sr(r)){if(!ue)throw Error(c(176));if(n=r.stateNode,l=r.memoizedProps,(s=gc(n,l,r,!wr))&&(u=xt,u!==null))switch(h=(u.mode&1)!==0,u.tag){case 3:Mc(u.stateNode.containerInfo,n,l,h);break;case 5:Cc(u.type,u.memoizedProps,u.stateNode,n,l,h)}s&&Kt(r)}else r.stateNode=oe(l,n,s,r)}return lt(r),null;case 13:if(Ie(Ue),l=r.memoizedState,Fe&&wt!==null&&r.mode&1&&!(r.flags&128)){for(n=wt;n;)n=_n(n);return qn(),r.flags|=98560,r}if(l!==null&&l.dehydrated!==null){if(l=Sr(r),n===null){if(!l)throw Error(c(318));if(!ue)throw Error(c(344));if(n=r.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(c(317));yc(n,r)}else qn(),!(r.flags&128)&&(r.memoizedState=null),r.flags|=4;return lt(r),null}return Ot!==null&&(cl(Ot),Ot=null),r.flags&128?(r.lanes=s,r):(l=l!==null,s=!1,n===null?Sr(r):s=n.memoizedState!==null,l&&!s&&(r.child.flags|=8192,r.mode&1&&(n===null||Ue.current&1?qe===0&&(qe=3):dl())),r.updateQueue!==null&&(r.flags|=4),lt(r),null);case 4:return Kn(),kr(n,r),n===null&&ve(r.stateNode.containerInfo),lt(r),null;case 10:return Es(r.type._context),lt(r),null;case 17:return ht(r.type)&&Kr(),lt(r),null;case 19:if(Ie(Ue),u=r.memoizedState,u===null)return lt(r),null;if(l=(r.flags&128)!==0,h=u.rendering,h===null)if(l)zr(u,!1);else{if(qe!==0||n!==null&&n.flags&128)for(n=r.child;n!==null;){if(h=hi(n),h!==null){for(r.flags|=128,zr(u,!1),n=h.updateQueue,n!==null&&(r.updateQueue=n,r.flags|=4),r.subtreeFlags=0,n=s,l=r.child;l!==null;)s=l,u=n,s.flags&=14680066,h=s.alternate,h===null?(s.childLanes=0,s.lanes=u,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=h.childLanes,s.lanes=h.lanes,s.child=h.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=h.memoizedProps,s.memoizedState=h.memoizedState,s.updateQueue=h.updateQueue,s.type=h.type,u=h.dependencies,s.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),l=l.sibling;return Ne(Ue,Ue.current&1|2),r.child}n=n.sibling}u.tail!==null&&Ke()>ll&&(r.flags|=128,l=!0,zr(u,!1),r.lanes=4194304)}else{if(!l)if(n=hi(h),n!==null){if(r.flags|=128,l=!0,n=n.updateQueue,n!==null&&(r.updateQueue=n,r.flags|=4),zr(u,!0),u.tail===null&&u.tailMode==="hidden"&&!h.alternate&&!Fe)return lt(r),null}else 2*Ke()-u.renderingStartTime>ll&&s!==1073741824&&(r.flags|=128,l=!0,zr(u,!1),r.lanes=4194304);u.isBackwards?(h.sibling=r.child,r.child=h):(n=u.last,n!==null?n.sibling=h:r.child=h,u.last=h)}return u.tail!==null?(r=u.tail,u.rendering=r,u.tail=r.sibling,u.renderingStartTime=Ke(),r.sibling=null,n=Ue.current,Ne(Ue,l?n&1|2:n&1),r):(lt(r),null);case 22:case 23:return fl(),l=r.memoizedState!==null,n!==null&&n.memoizedState!==null!==l&&(r.flags|=8192),l&&r.mode&1?Et&1073741824&&(lt(r),ae&&r.subtreeFlags&6&&(r.flags|=8192)):lt(r),null;case 24:return null;case 25:return null}throw Error(c(156,r.tag))}var Kc=p.ReactCurrentOwner,St=!1;function ut(n,r,s,l){r.child=n===null?xa(r,null,s,l):Qn(r,n.child,s,l)}function Xa(n,r,s,l,u){s=s.render;var h=r.ref;return Vn(r,u),l=Bs(n,r,s,l,h,u),s=Us(),n!==null&&!St?(r.updateQueue=n.updateQueue,r.flags&=-2053,n.lanes&=~u,ln(n,r,u)):(Fe&&s&&Ts(r),r.flags|=1,ut(n,r,l,u),r.child)}function Ya(n,r,s,l,u){if(n===null){var h=s.type;return typeof h=="function"&&!hl(h)&&h.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(r.tag=15,r.type=h,qa(n,r,h,l,u)):(n=Gi(s.type,null,l,r,r.mode,u),n.ref=r.ref,n.return=r,r.child=n)}if(h=n.child,!(n.lanes&u)){var C=h.memoizedProps;if(s=s.compare,s=s!==null?s:ii,s(C,l)&&n.ref===r.ref)return ln(n,r,u)}return r.flags|=1,n=wn(h,l),n.ref=r.ref,n.return=r,r.child=n}function qa(n,r,s,l,u){if(n!==null&&ii(n.memoizedProps,l)&&n.ref===r.ref)if(St=!1,(n.lanes&u)!==0)n.flags&131072&&(St=!0);else return r.lanes=n.lanes,ln(n,r,u);return Ws(n,r,s,l,u)}function Qa(n,r,s){var l=r.pendingProps,u=l.children,h=n!==null?n.memoizedState:null;if(l.mode==="hidden")if(!(r.mode&1))r.memoizedState={baseLanes:0,cachePool:null},Ne($n,Et),Et|=s;else if(s&1073741824)r.memoizedState={baseLanes:0,cachePool:null},l=h!==null?h.baseLanes:s,Ne($n,Et),Et|=l;else return n=h!==null?h.baseLanes|s:s,r.lanes=r.childLanes=1073741824,r.memoizedState={baseLanes:n,cachePool:null},r.updateQueue=null,Ne($n,Et),Et|=n,null;else h!==null?(l=h.baseLanes|s,r.memoizedState=null):l=s,Ne($n,Et),Et|=l;return ut(n,r,u,s),r.child}function Za(n,r){var s=r.ref;(n===null&&s!==null||n!==null&&n.ref!==s)&&(r.flags|=512,r.flags|=2097152)}function Ws(n,r,s,l,u){var h=ht(s)?Tn:rt.current;return h=Gn(r,h),Vn(r,u),s=Bs(n,r,s,l,h,u),l=Us(),n!==null&&!St?(r.updateQueue=n.updateQueue,r.flags&=-2053,n.lanes&=~u,ln(n,r,u)):(Fe&&l&&Ts(r),r.flags|=1,ut(n,r,s,u),r.child)}function Ka(n,r,s,l,u){if(ht(s)){var h=!0;Jr(r)}else h=!1;if(Vn(r,u),r.stateNode===null)n!==null&&(n.alternate=null,r.alternate=null,r.flags|=2),fa(r,s,l),_s(r,s,l,u),l=!0;else if(n===null){var C=r.stateNode,I=r.memoizedProps;C.props=I;var Q=C.context,ee=s.contextType;typeof ee=="object"&&ee!==null?ee=Mt(ee):(ee=ht(s)?Tn:rt.current,ee=Gn(r,ee));var le=s.getDerivedStateFromProps,ge=typeof le=="function"||typeof C.getSnapshotBeforeUpdate=="function";ge||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(I!==l||Q!==ee)&&da(r,C,l,ee),pn=!1;var pe=r.memoizedState;C.state=pe,oi(r,l,C,u),Q=r.memoizedState,I!==l||pe!==Q||dt.current||pn?(typeof le=="function"&&(Cs(r,s,le,l),Q=r.memoizedState),(I=pn||ca(r,s,I,l,pe,Q,ee))?(ge||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount()),typeof C.componentDidMount=="function"&&(r.flags|=4194308)):(typeof C.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=l,r.memoizedState=Q),C.props=l,C.state=Q,C.context=ee,l=I):(typeof C.componentDidMount=="function"&&(r.flags|=4194308),l=!1)}else{C=r.stateNode,la(n,r),I=r.memoizedProps,ee=r.type===r.elementType?I:Dt(r.type,I),C.props=ee,ge=r.pendingProps,pe=C.context,Q=s.contextType,typeof Q=="object"&&Q!==null?Q=Mt(Q):(Q=ht(s)?Tn:rt.current,Q=Gn(r,Q));var Ae=s.getDerivedStateFromProps;(le=typeof Ae=="function"||typeof C.getSnapshotBeforeUpdate=="function")||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(I!==ge||pe!==Q)&&da(r,C,l,Q),pn=!1,pe=r.memoizedState,C.state=pe,oi(r,l,C,u);var fe=r.memoizedState;I!==ge||pe!==fe||dt.current||pn?(typeof Ae=="function"&&(Cs(r,s,Ae,l),fe=r.memoizedState),(ee=pn||ca(r,s,ee,l,pe,fe,Q)||!1)?(le||typeof C.UNSAFE_componentWillUpdate!="function"&&typeof C.componentWillUpdate!="function"||(typeof C.componentWillUpdate=="function"&&C.componentWillUpdate(l,fe,Q),typeof C.UNSAFE_componentWillUpdate=="function"&&C.UNSAFE_componentWillUpdate(l,fe,Q)),typeof C.componentDidUpdate=="function"&&(r.flags|=4),typeof C.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof C.componentDidUpdate!="function"||I===n.memoizedProps&&pe===n.memoizedState||(r.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||I===n.memoizedProps&&pe===n.memoizedState||(r.flags|=1024),r.memoizedProps=l,r.memoizedState=fe),C.props=l,C.state=fe,C.context=Q,l=ee):(typeof C.componentDidUpdate!="function"||I===n.memoizedProps&&pe===n.memoizedState||(r.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||I===n.memoizedProps&&pe===n.memoizedState||(r.flags|=1024),l=!1)}return Vs(n,r,s,l,h,u)}function Vs(n,r,s,l,u,h){Za(n,r);var C=(r.flags&128)!==0;if(!l&&!C)return u&&ta(r,s,!1),ln(n,r,h);l=r.stateNode,Kc.current=r;var I=C&&typeof s.getDerivedStateFromError!="function"?null:l.render();return r.flags|=1,n!==null&&C?(r.child=Qn(r,n.child,null,h),r.child=Qn(r,null,I,h)):ut(n,r,I,h),r.memoizedState=l.state,u&&ta(r,s,!0),r.child}function Ja(n){var r=n.stateNode;r.pendingContext?$l(n,r.pendingContext,r.pendingContext!==r.context):r.context&&$l(n,r.context,!1),As(n,r.containerInfo)}function $a(n,r,s,l,u){return qn(),zs(u),r.flags|=256,ut(n,r,s,l),r.child}var Ri={dehydrated:null,treeContext:null,retryLane:0};function Mi(n){return{baseLanes:n,cachePool:null}}function eo(n,r,s){var l=r.pendingProps,u=Ue.current,h=!1,C=(r.flags&128)!==0,I;if((I=C)||(I=n!==null&&n.memoizedState===null?!1:(u&2)!==0),I?(h=!0,r.flags&=-129):(n===null||n.memoizedState!==null)&&(u|=1),Ne(Ue,u&1),n===null)return ks(r),n=r.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(r.mode&1?vr(n)?r.lanes=8:r.lanes=1073741824:r.lanes=1,null):(u=l.children,n=l.fallback,h?(l=r.mode,h=r.child,u={mode:"hidden",children:u},!(l&1)&&h!==null?(h.childLanes=0,h.pendingProps=u):h=Wi(u,l,0,null),n=Fn(n,l,s,null),h.return=r,n.return=r,h.sibling=n,r.child=h,r.child.memoizedState=Mi(s),r.memoizedState=Ri,n):Xs(r,u));if(u=n.memoizedState,u!==null){if(I=u.dehydrated,I!==null){if(C)return r.flags&256?(r.flags&=-257,Ci(n,r,s,Error(c(422)))):r.memoizedState!==null?(r.child=n.child,r.flags|=128,null):(h=l.fallback,u=r.mode,l=Wi({mode:"visible",children:l.children},u,0,null),h=Fn(h,u,s,null),h.flags|=2,l.return=r,h.return=r,l.sibling=h,r.child=l,r.mode&1&&Qn(r,n.child,null,s),r.child.memoizedState=Mi(s),r.memoizedState=Ri,h);if(!(r.mode&1))r=Ci(n,r,s,null);else if(vr(I))r=Ci(n,r,s,Error(c(419)));else if(l=(s&n.childLanes)!==0,St||l){if(l=Ve,l!==null){switch(s&-s){case 4:h=2;break;case 16:h=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:h=32;break;case 536870912:h=268435456;break;default:h=0}l=h&(l.suspendedLanes|s)?0:h,l!==0&&l!==u.retryLane&&(u.retryLane=l,Pt(n,l,-1))}dl(),r=Ci(n,r,s,Error(c(421)))}else Zr(I)?(r.flags|=128,r.child=n.child,r=ff.bind(null,n),os(I,r),r=null):(s=u.treeContext,ue&&(wt=mc(I),xt=r,Fe=!0,Ot=null,wr=!1,s!==null&&(Ct[_t++]=nn,Ct[_t++]=rn,Ct[_t++]=bn,nn=s.id,rn=s.overflow,bn=r)),r=Xs(r,r.pendingProps.children),r.flags|=4096);return r}return h?(l=no(n,r,l.children,l.fallback,s),h=r.child,u=n.child.memoizedState,h.memoizedState=u===null?Mi(s):{baseLanes:u.baseLanes|s,cachePool:null},h.childLanes=n.childLanes&~s,r.memoizedState=Ri,l):(s=to(n,r,l.children,s),r.memoizedState=null,s)}return h?(l=no(n,r,l.children,l.fallback,s),h=r.child,u=n.child.memoizedState,h.memoizedState=u===null?Mi(s):{baseLanes:u.baseLanes|s,cachePool:null},h.childLanes=n.childLanes&~s,r.memoizedState=Ri,l):(s=to(n,r,l.children,s),r.memoizedState=null,s)}function Xs(n,r){return r=Wi({mode:"visible",children:r},n.mode,0,null),r.return=n,n.child=r}function to(n,r,s,l){var u=n.child;return n=u.sibling,s=wn(u,{mode:"visible",children:s}),!(r.mode&1)&&(s.lanes=l),s.return=r,s.sibling=null,n!==null&&(l=r.deletions,l===null?(r.deletions=[n],r.flags|=16):l.push(n)),r.child=s}function no(n,r,s,l,u){var h=r.mode;n=n.child;var C=n.sibling,I={mode:"hidden",children:s};return!(h&1)&&r.child!==n?(s=r.child,s.childLanes=0,s.pendingProps=I,r.deletions=null):(s=wn(n,I),s.subtreeFlags=n.subtreeFlags&14680064),C!==null?l=wn(C,l):(l=Fn(l,h,u,null),l.flags|=2),l.return=r,s.return=r,s.sibling=l,r.child=s,l}function Ci(n,r,s,l){return l!==null&&zs(l),Qn(r,n.child,null,s),n=Xs(r,r.pendingProps.children),n.flags|=2,r.memoizedState=null,n}function ro(n,r,s){n.lanes|=r;var l=n.alternate;l!==null&&(l.lanes|=r),Rs(n.return,r,s)}function Ys(n,r,s,l,u){var h=n.memoizedState;h===null?n.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:l,tail:s,tailMode:u}:(h.isBackwards=r,h.rendering=null,h.renderingStartTime=0,h.last=l,h.tail=s,h.tailMode=u)}function io(n,r,s){var l=r.pendingProps,u=l.revealOrder,h=l.tail;if(ut(n,r,l.children,s),l=Ue.current,l&2)l=l&1|2,r.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=r.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&ro(n,s,r);else if(n.tag===19)ro(n,s,r);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===r)break e;for(;n.sibling===null;){if(n.return===null||n.return===r)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}l&=1}if(Ne(Ue,l),!(r.mode&1))r.memoizedState=null;else switch(u){case"forwards":for(s=r.child,u=null;s!==null;)n=s.alternate,n!==null&&hi(n)===null&&(u=s),s=s.sibling;s=u,s===null?(u=r.child,r.child=null):(u=s.sibling,s.sibling=null),Ys(r,!1,u,s,h);break;case"backwards":for(s=null,u=r.child,r.child=null;u!==null;){if(n=u.alternate,n!==null&&hi(n)===null){r.child=u;break}n=u.sibling,u.sibling=s,s=u,u=n}Ys(r,!0,s,null,h);break;case"together":Ys(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function ln(n,r,s){if(n!==null&&(r.dependencies=n.dependencies),er|=r.lanes,!(s&r.childLanes))return null;if(n!==null&&r.child!==n.child)throw Error(c(153));if(r.child!==null){for(n=r.child,s=wn(n,n.pendingProps),r.child=s,s.return=r;n.sibling!==null;)n=n.sibling,s=s.sibling=wn(n,n.pendingProps),s.return=r;s.sibling=null}return r.child}function Jc(n,r,s){switch(r.tag){case 3:Ja(r),qn();break;case 5:wa(r);break;case 1:ht(r.type)&&Jr(r);break;case 4:As(r,r.stateNode.containerInfo);break;case 10:sa(r,r.type._context,r.memoizedProps.value);break;case 13:var l=r.memoizedState;if(l!==null)return l.dehydrated!==null?(Ne(Ue,Ue.current&1),r.flags|=128,null):s&r.child.childLanes?eo(n,r,s):(Ne(Ue,Ue.current&1),n=ln(n,r,s),n!==null?n.sibling:null);Ne(Ue,Ue.current&1);break;case 19:if(l=(s&r.childLanes)!==0,n.flags&128){if(l)return io(n,r,s);r.flags|=128}var u=r.memoizedState;if(u!==null&&(u.rendering=null,u.tail=null,u.lastEffect=null),Ne(Ue,Ue.current),l)break;return null;case 22:case 23:return r.lanes=0,Qa(n,r,s)}return ln(n,r,s)}function $c(n,r){switch(bs(r),r.tag){case 1:return ht(r.type)&&Kr(),n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 3:return Kn(),Ie(dt),Ie(rt),Ls(),n=r.flags,n&65536&&!(n&128)?(r.flags=n&-65537|128,r):null;case 5:return Ns(r),null;case 13:if(Ie(Ue),n=r.memoizedState,n!==null&&n.dehydrated!==null){if(r.alternate===null)throw Error(c(340));qn()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 19:return Ie(Ue),null;case 4:return Kn(),null;case 10:return Es(r.type._context),null;case 22:case 23:return fl(),null;case 24:return null;default:return null}}var _i=!1,zn=!1,ef=typeof WeakSet=="function"?WeakSet:Set,ne=null;function Ti(n,r){var s=n.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(l){vt(n,r,l)}else s.current=null}function qs(n,r,s){try{s()}catch(l){vt(n,r,l)}}var so=!1;function tf(n,r){for(F(n.containerInfo),ne=r;ne!==null;)if(n=ne,r=n.child,(n.subtreeFlags&1028)!==0&&r!==null)r.return=n,ne=r;else for(;ne!==null;){n=ne;try{var s=n.alternate;if(n.flags&1024)switch(n.tag){case 0:case 11:case 15:break;case 1:if(s!==null){var l=s.memoizedProps,u=s.memoizedState,h=n.stateNode,C=h.getSnapshotBeforeUpdate(n.elementType===n.type?l:Dt(n.type,l),u);h.__reactInternalSnapshotBeforeUpdate=C}break;case 3:ae&&Lt(n.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(c(163))}}catch(I){vt(n,n.return,I)}if(r=n.sibling,r!==null){r.return=n.return,ne=r;break}ne=n.return}return s=so,so=!1,s}function An(n,r,s){var l=r.updateQueue;if(l=l!==null?l.lastEffect:null,l!==null){var u=l=l.next;do{if((u.tag&n)===n){var h=u.destroy;u.destroy=void 0,h!==void 0&&qs(r,s,h)}u=u.next}while(u!==l)}}function Ar(n,r){if(r=r.updateQueue,r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&n)===n){var l=s.create;s.destroy=l()}s=s.next}while(s!==r)}}function Qs(n){var r=n.ref;if(r!==null){var s=n.stateNode;switch(n.tag){case 5:n=J(s);break;default:n=s}typeof r=="function"?r(n):r.current=n}}function lo(n,r,s){if(Vt&&typeof Vt.onCommitFiberUnmount=="function")try{Vt.onCommitFiberUnmount(ni,r)}catch{}switch(r.tag){case 0:case 11:case 14:case 15:if(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null)){var l=n=n.next;do{var u=l,h=u.destroy;u=u.tag,h!==void 0&&(u&2||u&4)&&qs(r,s,h),l=l.next}while(l!==n)}break;case 1:if(Ti(r,s),n=r.stateNode,typeof n.componentWillUnmount=="function")try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(C){vt(r,s,C)}break;case 5:Ti(r,s);break;case 4:ae?ho(n,r,s):we&&we&&(r=r.stateNode.containerInfo,s=Bt(r),fn(r,s))}}function ao(n,r,s){for(var l=r;;)if(lo(n,l,s),l.child===null||ae&&l.tag===4){if(l===r)break;for(;l.sibling===null;){if(l.return===null||l.return===r)return;l=l.return}l.sibling.return=l.return,l=l.sibling}else l.child.return=l,l=l.child}function oo(n){var r=n.alternate;r!==null&&(n.alternate=null,oo(r)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(r=n.stateNode,r!==null&&ze(r)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function uo(n){return n.tag===5||n.tag===3||n.tag===4}function co(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||uo(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function fo(n){if(ae){e:{for(var r=n.return;r!==null;){if(uo(r))break e;r=r.return}throw Error(c(160))}var s=r;switch(s.tag){case 5:r=s.stateNode,s.flags&32&&(jn(r),s.flags&=-33),s=co(n),Ks(n,s,r);break;case 3:case 4:r=s.stateNode.containerInfo,s=co(n),Zs(n,s,r);break;default:throw Error(c(161))}}}function Zs(n,r,s){var l=n.tag;if(l===5||l===6)n=n.stateNode,r?Xr(s,n,r):Nt(s,n);else if(l!==4&&(n=n.child,n!==null))for(Zs(n,r,s),n=n.sibling;n!==null;)Zs(n,r,s),n=n.sibling}function Ks(n,r,s){var l=n.tag;if(l===5||l===6)n=n.stateNode,r?is(s,n,r):ft(s,n);else if(l!==4&&(n=n.child,n!==null))for(Ks(n,r,s),n=n.sibling;n!==null;)Ks(n,r,s),n=n.sibling}function ho(n,r,s){for(var l=r,u=!1,h,C;;){if(!u){u=l.return;e:for(;;){if(u===null)throw Error(c(160));switch(h=u.stateNode,u.tag){case 5:C=!1;break e;case 3:h=h.containerInfo,C=!0;break e;case 4:h=h.containerInfo,C=!0;break e}u=u.return}u=!0}if(l.tag===5||l.tag===6)ao(n,l,s),C?On(h,l.stateNode):Yr(h,l.stateNode);else if(l.tag===18)C?Ec(h,l.stateNode):Sc(h,l.stateNode);else if(l.tag===4){if(l.child!==null){h=l.stateNode.containerInfo,C=!0,l.child.return=l,l=l.child;continue}}else if(lo(n,l,s),l.child!==null){l.child.return=l,l=l.child;continue}if(l===r)break;for(;l.sibling===null;){if(l.return===null||l.return===r)return;l=l.return,l.tag===4&&(u=!1)}l.sibling.return=l.return,l=l.sibling}}function Js(n,r){if(ae){switch(r.tag){case 0:case 11:case 14:case 15:An(3,r,r.return),Ar(3,r),An(5,r,r.return);return;case 1:return;case 5:var s=r.stateNode;if(s!=null){var l=r.memoizedProps;n=n!==null?n.memoizedProps:l;var u=r.type,h=r.updateQueue;r.updateQueue=null,h!==null&&It(s,h,u,n,l,r)}return;case 6:if(r.stateNode===null)throw Error(c(162));s=r.memoizedProps,un(r.stateNode,n!==null?n.memoizedProps:s,s);return;case 3:ue&&n!==null&&n.memoizedState.isDehydrated&&Jl(r.stateNode.containerInfo);return;case 12:return;case 13:bi(r);return;case 19:bi(r);return;case 17:return}throw Error(c(163))}switch(r.tag){case 0:case 11:case 14:case 15:An(3,r,r.return),Ar(3,r),An(5,r,r.return);return;case 12:return;case 13:bi(r);return;case 19:bi(r);return;case 3:ue&&n!==null&&n.memoizedState.isDehydrated&&Jl(r.stateNode.containerInfo);break;case 22:case 23:return}e:if(we){switch(r.tag){case 1:case 5:case 6:break e;case 3:case 4:r=r.stateNode,fn(r.containerInfo,r.pendingChildren);break e}throw Error(c(163))}}function bi(n){var r=n.updateQueue;if(r!==null){n.updateQueue=null;var s=n.stateNode;s===null&&(s=n.stateNode=new ef),r.forEach(function(l){var u=df.bind(null,n,l);s.has(l)||(s.add(l),l.then(u,u))})}}function nf(n,r){for(ne=r;ne!==null;){r=ne;var s=r.deletions;if(s!==null)for(var l=0;l<s.length;l++){var u=s[l];try{var h=n;ae?ho(h,u,r):ao(h,u,r);var C=u.alternate;C!==null&&(C.return=null),u.return=null}catch(ce){vt(u,r,ce)}}if(s=r.child,r.subtreeFlags&12854&&s!==null)s.return=r,ne=s;else for(;ne!==null;){r=ne;try{var I=r.flags;if(I&32&&ae&&jn(r.stateNode),I&512){var Q=r.alternate;if(Q!==null){var ee=Q.ref;ee!==null&&(typeof ee=="function"?ee(null):ee.current=null)}}if(I&8192)switch(r.tag){case 13:if(r.memoizedState!==null){var le=r.alternate;(le===null||le.memoizedState===null)&&(sl=Ke())}break;case 22:var ge=r.memoizedState!==null,pe=r.alternate,Ae=pe!==null&&pe.memoizedState!==null;if(s=r,ae){e:if(l=s,u=ge,h=null,ae)for(var fe=l;;){if(fe.tag===5){if(h===null){h=fe;var at=fe.stateNode;u?Oe(at):ot(fe.stateNode,fe.memoizedProps)}}else if(fe.tag===6){if(h===null){var zt=fe.stateNode;u?Ye(zt):je(zt,fe.memoizedProps)}}else if((fe.tag!==22&&fe.tag!==23||fe.memoizedState===null||fe===l)&&fe.child!==null){fe.child.return=fe,fe=fe.child;continue}if(fe===l)break;for(;fe.sibling===null;){if(fe.return===null||fe.return===l)break e;h===fe&&(h=null),fe=fe.return}h===fe&&(h=null),fe.sibling.return=fe.return,fe=fe.sibling}}if(ge&&!Ae&&s.mode&1){ne=s;for(var H=s.child;H!==null;){for(s=ne=H;ne!==null;){l=ne;var B=l.child;switch(l.tag){case 0:case 11:case 14:case 15:An(4,l,l.return);break;case 1:Ti(l,l.return);var Y=l.stateNode;if(typeof Y.componentWillUnmount=="function"){var re=l.return;try{Y.props=l.memoizedProps,Y.state=l.memoizedState,Y.componentWillUnmount()}catch(ce){vt(l,re,ce)}}break;case 5:Ti(l,l.return);break;case 22:if(l.memoizedState!==null){vo(s);continue}}B!==null?(B.return=l,ne=B):vo(s)}H=H.sibling}}}switch(I&4102){case 2:fo(r),r.flags&=-3;break;case 6:fo(r),r.flags&=-3,Js(r.alternate,r);break;case 4096:r.flags&=-4097;break;case 4100:r.flags&=-4097,Js(r.alternate,r);break;case 4:Js(r.alternate,r)}}catch(ce){vt(r,r.return,ce)}if(s=r.sibling,s!==null){s.return=r.return,ne=s;break}ne=r.return}}}function rf(n,r,s){ne=n,po(n)}function po(n,r,s){for(var l=(n.mode&1)!==0;ne!==null;){var u=ne,h=u.child;if(u.tag===22&&l){var C=u.memoizedState!==null||_i;if(!C){var I=u.alternate,Q=I!==null&&I.memoizedState!==null||zn;I=_i;var ee=zn;if(_i=C,(zn=Q)&&!ee)for(ne=u;ne!==null;)C=ne,Q=C.child,C.tag===22&&C.memoizedState!==null?go(u):Q!==null?(Q.return=C,ne=Q):go(u);for(;h!==null;)ne=h,po(h),h=h.sibling;ne=u,_i=I,zn=ee}mo(n)}else u.subtreeFlags&8772&&h!==null?(h.return=u,ne=h):mo(n)}}function mo(n){for(;ne!==null;){var r=ne;if(r.flags&8772){var s=r.alternate;try{if(r.flags&8772)switch(r.tag){case 0:case 11:case 15:zn||Ar(5,r);break;case 1:var l=r.stateNode;if(r.flags&4&&!zn)if(s===null)l.componentDidMount();else{var u=r.elementType===r.type?s.memoizedProps:Dt(r.type,s.memoizedProps);l.componentDidUpdate(u,s.memoizedState,l.__reactInternalSnapshotBeforeUpdate)}var h=r.updateQueue;h!==null&&oa(r,h,l);break;case 3:var C=r.updateQueue;if(C!==null){if(s=null,r.child!==null)switch(r.child.tag){case 5:s=J(r.child.stateNode);break;case 1:s=r.child.stateNode}oa(r,C,s)}break;case 5:var I=r.stateNode;s===null&&r.flags&4&&mr(I,r.type,r.memoizedProps,r);break;case 6:break;case 4:break;case 12:break;case 13:if(ue&&r.memoizedState===null){var Q=r.alternate;if(Q!==null){var ee=Q.memoizedState;if(ee!==null){var le=ee.dehydrated;le!==null&&wc(le)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(c(163))}zn||r.flags&512&&Qs(r)}catch(ge){vt(r,r.return,ge)}}if(r===n){ne=null;break}if(s=r.sibling,s!==null){s.return=r.return,ne=s;break}ne=r.return}}function vo(n){for(;ne!==null;){var r=ne;if(r===n){ne=null;break}var s=r.sibling;if(s!==null){s.return=r.return,ne=s;break}ne=r.return}}function go(n){for(;ne!==null;){var r=ne;try{switch(r.tag){case 0:case 11:case 15:var s=r.return;try{Ar(4,r)}catch(Q){vt(r,s,Q)}break;case 1:var l=r.stateNode;if(typeof l.componentDidMount=="function"){var u=r.return;try{l.componentDidMount()}catch(Q){vt(r,u,Q)}}var h=r.return;try{Qs(r)}catch(Q){vt(r,h,Q)}break;case 5:var C=r.return;try{Qs(r)}catch(Q){vt(r,C,Q)}}}catch(Q){vt(r,r.return,Q)}if(r===n){ne=null;break}var I=r.sibling;if(I!==null){I.return=r.return,ne=I;break}ne=r.return}}var Pi=0,ki=1,zi=2,Ai=3,Ni=4;if(typeof Symbol=="function"&&Symbol.for){var Nr=Symbol.for;Pi=Nr("selector.component"),ki=Nr("selector.has_pseudo_class"),zi=Nr("selector.role"),Ai=Nr("selector.test_id"),Ni=Nr("selector.text")}function $s(n){var r=Se(n);if(r!=null){if(typeof r.memoizedProps["data-testname"]!="string")throw Error(c(364));return r}if(n=At(n),n===null)throw Error(c(362));return n.stateNode.current}function el(n,r){switch(r.$$typeof){case Pi:if(n.type===r.value)return!0;break;case ki:e:{r=r.value,n=[n,0];for(var s=0;s<n.length;){var l=n[s++],u=n[s++],h=r[u];if(l.tag!==5||!Rt(l)){for(;h!=null&&el(l,h);)u++,h=r[u];if(u===r.length){r=!0;break e}else for(l=l.child;l!==null;)n.push(l,u),l=l.sibling}}r=!1}return r;case zi:if(n.tag===5&&Dn(n.stateNode,r.value))return!0;break;case Ni:if((n.tag===5||n.tag===6)&&(n=on(n),n!==null&&0<=n.indexOf(r.value)))return!0;break;case Ai:if(n.tag===5&&(n=n.memoizedProps["data-testname"],typeof n=="string"&&n.toLowerCase()===r.value.toLowerCase()))return!0;break;default:throw Error(c(365))}return!1}function tl(n){switch(n.$$typeof){case Pi:return"<"+(O(n.value)||"Unknown")+">";case ki:return":has("+(tl(n)||"")+")";case zi:return'[role="'+n.value+'"]';case Ni:return'"'+n.value+'"';case Ai:return'[data-testname="'+n.value+'"]';default:throw Error(c(365))}}function yo(n,r){var s=[];n=[n,0];for(var l=0;l<n.length;){var u=n[l++],h=n[l++],C=r[h];if(u.tag!==5||!Rt(u)){for(;C!=null&&el(u,C);)h++,C=r[h];if(h===r.length)s.push(u);else for(u=u.child;u!==null;)n.push(u,h),u=u.sibling}}return s}function nl(n,r){if(!et)throw Error(c(363));n=$s(n),n=yo(n,r),r=[],n=Array.from(n);for(var s=0;s<n.length;){var l=n[s++];if(l.tag===5)Rt(l)||r.push(l.stateNode);else for(l=l.child;l!==null;)n.push(l),l=l.sibling}return r}var sf=Math.ceil,Ii=p.ReactCurrentDispatcher,rl=p.ReactCurrentOwner,We=p.ReactCurrentBatchConfig,Re=0,Ve=null,Xe=null,tt=0,Et=0,$n=dn(0),qe=0,Ir=null,er=0,Li=0,il=0,Lr=null,pt=null,sl=0,ll=1/0;function tr(){ll=Ke()+500}var Fi=!1,al=null,vn=null,Bi=!1,gn=null,Ui=0,Fr=0,ol=null,Di=-1,Oi=0;function ct(){return Re&6?Ke():Di!==-1?Di:Di=Ke()}function yn(n){return n.mode&1?Re&2&&tt!==0?tt&-tt:Oc.transition!==null?(Oi===0&&(n=$r,$r<<=1,!($r&4194240)&&($r=64),Oi=n),Oi):(n=_e,n!==0?n:se()):1}function Pt(n,r,s){if(50<Fr)throw Fr=0,ol=null,Error(c(185));var l=ji(n,r);return l===null?null:(xr(l,r,s),(!(Re&2)||l!==Ve)&&(l===Ve&&(!(Re&2)&&(Li|=r),qe===4&&xn(l,tt)),mt(l,s),r===1&&Re===0&&!(n.mode&1)&&(tr(),ri&&Yt())),l)}function ji(n,r){n.lanes|=r;var s=n.alternate;for(s!==null&&(s.lanes|=r),s=n,n=n.return;n!==null;)n.childLanes|=r,s=n.alternate,s!==null&&(s.childLanes|=r),s=n,n=n.return;return s.tag===3?s.stateNode:null}function mt(n,r){var s=n.callbackNode;zc(n,r);var l=ti(n,n===Ve?tt:0);if(l===0)s!==null&&ra(s),n.callbackNode=null,n.callbackPriority=0;else if(r=l&-l,n.callbackPriority!==r){if(s!=null&&ra(s),r===1)n.tag===0?Dc(wo.bind(null,n)):ia(wo.bind(null,n)),De?Ge(function(){Re===0&&Yt()}):vs(gs,Yt),s=null;else{switch(na(l)){case 1:s=gs;break;case 4:s=Lc;break;case 16:s=ys;break;case 536870912:s=Fc;break;default:s=ys}s=Po(s,xo.bind(null,n))}n.callbackPriority=r,n.callbackNode=s}}function xo(n,r){if(Di=-1,Oi=0,Re&6)throw Error(c(327));var s=n.callbackNode;if(Ln()&&n.callbackNode!==s)return null;var l=ti(n,n===Ve?tt:0);if(l===0)return null;if(l&30||l&n.expiredLanes||r)r=Hi(n,l);else{r=l;var u=Re;Re|=2;var h=Ro();(Ve!==n||tt!==r)&&(tr(),Nn(n,r));do try{of();break}catch(I){Eo(n,I)}while(!0);Ss(),Ii.current=h,Re=u,Xe!==null?r=0:(Ve=null,tt=0,r=qe)}if(r!==0){if(r===2&&(u=hs(n),u!==0&&(l=u,r=ul(n,u))),r===1)throw s=Ir,Nn(n,0),xn(n,l),mt(n,Ke()),s;if(r===6)xn(n,l);else{if(u=n.current.alternate,!(l&30)&&!lf(u)&&(r=Hi(n,l),r===2&&(h=hs(n),h!==0&&(l=h,r=ul(n,h))),r===1))throw s=Ir,Nn(n,0),xn(n,l),mt(n,Ke()),s;switch(n.finishedWork=u,n.finishedLanes=l,r){case 0:case 1:throw Error(c(345));case 2:In(n,pt);break;case 3:if(xn(n,l),(l&130023424)===l&&(r=sl+500-Ke(),10<r)){if(ti(n,0)!==0)break;if(u=n.suspendedLanes,(u&l)!==l){ct(),n.pingedLanes|=n.suspendedLanes&u;break}n.timeoutHandle=me(In.bind(null,n,pt),r);break}In(n,pt);break;case 4:if(xn(n,l),(l&4194240)===l)break;for(r=n.eventTimes,u=-1;0<l;){var C=31-Ut(l);h=1<<C,C=r[C],C>u&&(u=C),l&=~h}if(l=u,l=Ke()-l,l=(120>l?120:480>l?480:1080>l?1080:1920>l?1920:3e3>l?3e3:4320>l?4320:1960*sf(l/1960))-l,10<l){n.timeoutHandle=me(In.bind(null,n,pt),l);break}In(n,pt);break;case 5:In(n,pt);break;default:throw Error(c(329))}}}return mt(n,Ke()),n.callbackNode===s?xo.bind(null,n):null}function ul(n,r){var s=Lr;return n.current.memoizedState.isDehydrated&&(Nn(n,r).flags|=256),n=Hi(n,r),n!==2&&(r=pt,pt=s,r!==null&&cl(r)),n}function cl(n){pt===null?pt=n:pt.push.apply(pt,n)}function lf(n){for(var r=n;;){if(r.flags&16384){var s=r.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var l=0;l<s.length;l++){var u=s[l],h=u.getSnapshot;u=u.value;try{if(!Xt(h(),u))return!1}catch{return!1}}}if(s=r.child,r.subtreeFlags&16384&&s!==null)s.return=r,r=s;else{if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function xn(n,r){for(r&=~il,r&=~Li,n.suspendedLanes|=r,n.pingedLanes&=~r,n=n.expirationTimes;0<r;){var s=31-Ut(r),l=1<<s;n[s]=-1,r&=~l}}function wo(n){if(Re&6)throw Error(c(327));Ln();var r=ti(n,0);if(!(r&1))return mt(n,Ke()),null;var s=Hi(n,r);if(n.tag!==0&&s===2){var l=hs(n);l!==0&&(r=l,s=ul(n,l))}if(s===1)throw s=Ir,Nn(n,0),xn(n,r),mt(n,Ke()),s;if(s===6)throw Error(c(345));return n.finishedWork=n.current.alternate,n.finishedLanes=r,In(n,pt),mt(n,Ke()),null}function So(n){gn!==null&&gn.tag===0&&!(Re&6)&&Ln();var r=Re;Re|=1;var s=We.transition,l=_e;try{if(We.transition=null,_e=1,n)return n()}finally{_e=l,We.transition=s,Re=r,!(Re&6)&&Yt()}}function fl(){Et=$n.current,Ie($n)}function Nn(n,r){n.finishedWork=null,n.finishedLanes=0;var s=n.timeoutHandle;if(s!==xe&&(n.timeoutHandle=xe,de(s)),Xe!==null)for(s=Xe.return;s!==null;){var l=s;switch(bs(l),l.tag){case 1:l=l.type.childContextTypes,l!=null&&Kr();break;case 3:Kn(),Ie(dt),Ie(rt),Ls();break;case 5:Ns(l);break;case 4:Kn();break;case 13:Ie(Ue);break;case 19:Ie(Ue);break;case 10:Es(l.type._context);break;case 22:case 23:fl()}s=s.return}if(Ve=n,Xe=n=wn(n.current,null),tt=Et=r,qe=0,Ir=null,il=Li=er=0,pt=Lr=null,qt!==null){for(r=0;r<qt.length;r++)if(s=qt[r],l=s.interleaved,l!==null){s.interleaved=null;var u=l.next,h=s.pending;if(h!==null){var C=h.next;h.next=u,l.next=C}s.pending=l}qt=null}return n}function Eo(n,r){do{var s=Xe;try{if(Ss(),pi.current=wi,mi){for(var l=He.memoizedState;l!==null;){var u=l.queue;u!==null&&(u.pending=null),l=l.next}mi=!1}if(Jn=0,Je=it=He=null,Cr=!1,_r=0,rl.current=null,s===null||s.return===null){qe=1,Ir=r,Xe=null;break}e:{var h=n,C=s.return,I=s,Q=r;if(r=tt,I.flags|=32768,Q!==null&&typeof Q=="object"&&typeof Q.then=="function"){var ee=Q,le=I,ge=le.tag;if(!(le.mode&1)&&(ge===0||ge===11||ge===15)){var pe=le.alternate;pe?(le.updateQueue=pe.updateQueue,le.memoizedState=pe.memoizedState,le.lanes=pe.lanes):(le.updateQueue=null,le.memoizedState=null)}var Ae=Ha(C);if(Ae!==null){Ae.flags&=-257,Ga(Ae,C,I,h,r),Ae.mode&1&&ja(h,ee,r),r=Ae,Q=ee;var fe=r.updateQueue;if(fe===null){var at=new Set;at.add(Q),r.updateQueue=at}else fe.add(Q);break e}else{if(!(r&1)){ja(h,ee,r),dl();break e}Q=Error(c(426))}}else if(Fe&&I.mode&1){var zt=Ha(C);if(zt!==null){!(zt.flags&65536)&&(zt.flags|=256),Ga(zt,C,I,h,r),zs(Q);break e}}h=Q,qe!==4&&(qe=2),Lr===null?Lr=[h]:Lr.push(h),Q=Hs(Q,I),I=C;do{switch(I.tag){case 3:I.flags|=65536,r&=-r,I.lanes|=r;var H=Da(I,Q,r);aa(I,H);break e;case 1:h=Q;var B=I.type,Y=I.stateNode;if(!(I.flags&128)&&(typeof B.getDerivedStateFromError=="function"||Y!==null&&typeof Y.componentDidCatch=="function"&&(vn===null||!vn.has(Y)))){I.flags|=65536,r&=-r,I.lanes|=r;var re=Oa(I,h,r);aa(I,re);break e}}I=I.return}while(I!==null)}Co(s)}catch(ce){r=ce,Xe===s&&s!==null&&(Xe=s=s.return);continue}break}while(!0)}function Ro(){var n=Ii.current;return Ii.current=wi,n===null?wi:n}function dl(){(qe===0||qe===3||qe===2)&&(qe=4),Ve===null||!(er&268435455)&&!(Li&268435455)||xn(Ve,tt)}function Hi(n,r){var s=Re;Re|=2;var l=Ro();Ve===n&&tt===r||Nn(n,r);do try{af();break}catch(u){Eo(n,u)}while(!0);if(Ss(),Re=s,Ii.current=l,Xe!==null)throw Error(c(261));return Ve=null,tt=0,qe}function af(){for(;Xe!==null;)Mo(Xe)}function of(){for(;Xe!==null&&!Nc();)Mo(Xe)}function Mo(n){var r=bo(n.alternate,n,Et);n.memoizedProps=n.pendingProps,r===null?Co(n):Xe=r,rl.current=null}function Co(n){var r=n;do{var s=r.alternate;if(n=r.return,r.flags&32768){if(s=$c(s,r),s!==null){s.flags&=32767,Xe=s;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{qe=6,Xe=null;return}}else if(s=Zc(s,r,Et),s!==null){Xe=s;return}if(r=r.sibling,r!==null){Xe=r;return}Xe=r=n}while(r!==null);qe===0&&(qe=5)}function In(n,r){var s=_e,l=We.transition;try{We.transition=null,_e=1,uf(n,r,s)}finally{We.transition=l,_e=s}return null}function uf(n,r,s){do Ln();while(gn!==null);if(Re&6)throw Error(c(327));var l=n.finishedWork,u=n.finishedLanes;if(l===null)return null;if(n.finishedWork=null,n.finishedLanes=0,l===n.current)throw Error(c(177));n.callbackNode=null,n.callbackPriority=0;var h=l.lanes|l.childLanes;if(Ac(n,h),n===Ve&&(Xe=Ve=null,tt=0),!(l.subtreeFlags&2064)&&!(l.flags&2064)||Bi||(Bi=!0,Po(ys,function(){return Ln(),null})),h=(l.flags&15990)!==0,l.subtreeFlags&15990||h){h=We.transition,We.transition=null;var C=_e;_e=1;var I=Re;Re|=4,rl.current=null,tf(n,l),nf(n,l),U(n.containerInfo),n.current=l,rf(l),Ic(),Re=I,_e=C,We.transition=h}else n.current=l;if(Bi&&(Bi=!1,gn=n,Ui=u),h=n.pendingLanes,h===0&&(vn=null),Bc(l.stateNode),mt(n,Ke()),r!==null)for(s=n.onRecoverableError,l=0;l<r.length;l++)s(r[l]);if(Fi)throw Fi=!1,n=al,al=null,n;return Ui&1&&n.tag!==0&&Ln(),h=n.pendingLanes,h&1?n===ol?Fr++:(Fr=0,ol=n):Fr=0,Yt(),null}function Ln(){if(gn!==null){var n=na(Ui),r=We.transition,s=_e;try{if(We.transition=null,_e=16>n?16:n,gn===null)var l=!1;else{if(n=gn,gn=null,Ui=0,Re&6)throw Error(c(331));var u=Re;for(Re|=4,ne=n.current;ne!==null;){var h=ne,C=h.child;if(ne.flags&16){var I=h.deletions;if(I!==null){for(var Q=0;Q<I.length;Q++){var ee=I[Q];for(ne=ee;ne!==null;){var le=ne;switch(le.tag){case 0:case 11:case 15:An(8,le,h)}var ge=le.child;if(ge!==null)ge.return=le,ne=ge;else for(;ne!==null;){le=ne;var pe=le.sibling,Ae=le.return;if(oo(le),le===ee){ne=null;break}if(pe!==null){pe.return=Ae,ne=pe;break}ne=Ae}}}var fe=h.alternate;if(fe!==null){var at=fe.child;if(at!==null){fe.child=null;do{var zt=at.sibling;at.sibling=null,at=zt}while(at!==null)}}ne=h}}if(h.subtreeFlags&2064&&C!==null)C.return=h,ne=C;else e:for(;ne!==null;){if(h=ne,h.flags&2048)switch(h.tag){case 0:case 11:case 15:An(9,h,h.return)}var H=h.sibling;if(H!==null){H.return=h.return,ne=H;break e}ne=h.return}}var B=n.current;for(ne=B;ne!==null;){C=ne;var Y=C.child;if(C.subtreeFlags&2064&&Y!==null)Y.return=C,ne=Y;else e:for(C=B;ne!==null;){if(I=ne,I.flags&2048)try{switch(I.tag){case 0:case 11:case 15:Ar(9,I)}}catch(ce){vt(I,I.return,ce)}if(I===C){ne=null;break e}var re=I.sibling;if(re!==null){re.return=I.return,ne=re;break e}ne=I.return}}if(Re=u,Yt(),Vt&&typeof Vt.onPostCommitFiberRoot=="function")try{Vt.onPostCommitFiberRoot(ni,n)}catch{}l=!0}return l}finally{_e=s,We.transition=r}}return!1}function _o(n,r,s){r=Hs(s,r),r=Da(n,r,1),mn(n,r),r=ct(),n=ji(n,1),n!==null&&(xr(n,1,r),mt(n,r))}function vt(n,r,s){if(n.tag===3)_o(n,n,s);else for(;r!==null;){if(r.tag===3){_o(r,n,s);break}else if(r.tag===1){var l=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(vn===null||!vn.has(l))){n=Hs(s,n),n=Oa(r,n,1),mn(r,n),n=ct(),r=ji(r,1),r!==null&&(xr(r,1,n),mt(r,n));break}}r=r.return}}function cf(n,r,s){var l=n.pingCache;l!==null&&l.delete(r),r=ct(),n.pingedLanes|=n.suspendedLanes&s,Ve===n&&(tt&s)===s&&(qe===4||qe===3&&(tt&130023424)===tt&&500>Ke()-sl?Nn(n,0):il|=s),mt(n,r)}function To(n,r){r===0&&(n.mode&1?(r=ei,ei<<=1,!(ei&130023424)&&(ei=4194304)):r=1);var s=ct();n=ji(n,r),n!==null&&(xr(n,r,s),mt(n,s))}function ff(n){var r=n.memoizedState,s=0;r!==null&&(s=r.retryLane),To(n,s)}function df(n,r){var s=0;switch(n.tag){case 13:var l=n.stateNode,u=n.memoizedState;u!==null&&(s=u.retryLane);break;case 19:l=n.stateNode;break;default:throw Error(c(314))}l!==null&&l.delete(r),To(n,s)}var bo;bo=function(n,r,s){if(n!==null)if(n.memoizedProps!==r.pendingProps||dt.current)St=!0;else{if(!(n.lanes&s)&&!(r.flags&128))return St=!1,Jc(n,r,s);St=!!(n.flags&131072)}else St=!1,Fe&&r.flags&1048576&&ha(r,fi,r.index);switch(r.lanes=0,r.tag){case 2:var l=r.type;n!==null&&(n.alternate=null,r.alternate=null,r.flags|=2),n=r.pendingProps;var u=Gn(r,rt.current);Vn(r,s),u=Bs(null,r,l,n,u,s);var h=Us();return r.flags|=1,typeof u=="object"&&u!==null&&typeof u.render=="function"&&u.$$typeof===void 0?(r.tag=1,r.memoizedState=null,r.updateQueue=null,ht(l)?(h=!0,Jr(r)):h=!1,r.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,Ms(r),u.updater=ui,r.stateNode=u,u._reactInternals=r,_s(r,l,n,s),r=Vs(null,r,l,!0,h,s)):(r.tag=0,Fe&&h&&Ts(r),ut(null,r,u,s),r=r.child),r;case 16:l=r.elementType;e:{switch(n!==null&&(n.alternate=null,r.alternate=null,r.flags|=2),n=r.pendingProps,u=l._init,l=u(l._payload),r.type=l,u=r.tag=pf(l),n=Dt(l,n),u){case 0:r=Ws(null,r,l,n,s);break e;case 1:r=Ka(null,r,l,n,s);break e;case 11:r=Xa(null,r,l,n,s);break e;case 14:r=Ya(null,r,l,Dt(l.type,n),s);break e}throw Error(c(306,l,""))}return r;case 0:return l=r.type,u=r.pendingProps,u=r.elementType===l?u:Dt(l,u),Ws(n,r,l,u,s);case 1:return l=r.type,u=r.pendingProps,u=r.elementType===l?u:Dt(l,u),Ka(n,r,l,u,s);case 3:e:{if(Ja(r),n===null)throw Error(c(387));l=r.pendingProps,h=r.memoizedState,u=h.element,la(n,r),oi(r,l,null,s);var C=r.memoizedState;if(l=C.element,ue&&h.isDehydrated)if(h={element:l,isDehydrated:!1,cache:C.cache,transitions:C.transitions},r.updateQueue.baseState=h,r.memoizedState=h,r.flags&256){u=Error(c(423)),r=$a(n,r,l,s,u);break e}else if(l!==u){u=Error(c(424)),r=$a(n,r,l,s,u);break e}else for(ue&&(wt=pc(r.stateNode.containerInfo),xt=r,Fe=!0,Ot=null,wr=!1),s=xa(r,null,l,s),r.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(qn(),l===u){r=ln(n,r,s);break e}ut(n,r,l,s)}r=r.child}return r;case 5:return wa(r),n===null&&ks(r),l=r.type,u=r.pendingProps,h=n!==null?n.memoizedProps:null,C=u.children,ie(l,u)?C=null:h!==null&&ie(l,h)&&(r.flags|=32),Za(n,r),ut(n,r,C,s),r.child;case 6:return n===null&&ks(r),null;case 13:return eo(n,r,s);case 4:return As(r,r.stateNode.containerInfo),l=r.pendingProps,n===null?r.child=Qn(r,null,l,s):ut(n,r,l,s),r.child;case 11:return l=r.type,u=r.pendingProps,u=r.elementType===l?u:Dt(l,u),Xa(n,r,l,u,s);case 7:return ut(n,r,r.pendingProps,s),r.child;case 8:return ut(n,r,r.pendingProps.children,s),r.child;case 12:return ut(n,r,r.pendingProps.children,s),r.child;case 10:e:{if(l=r.type._context,u=r.pendingProps,h=r.memoizedProps,C=u.value,sa(r,l,C),h!==null)if(Xt(h.value,C)){if(h.children===u.children&&!dt.current){r=ln(n,r,s);break e}}else for(h=r.child,h!==null&&(h.return=r);h!==null;){var I=h.dependencies;if(I!==null){C=h.child;for(var Q=I.firstContext;Q!==null;){if(Q.context===l){if(h.tag===1){Q=tn(-1,s&-s),Q.tag=2;var ee=h.updateQueue;if(ee!==null){ee=ee.shared;var le=ee.pending;le===null?Q.next=Q:(Q.next=le.next,le.next=Q),ee.pending=Q}}h.lanes|=s,Q=h.alternate,Q!==null&&(Q.lanes|=s),Rs(h.return,s,r),I.lanes|=s;break}Q=Q.next}}else if(h.tag===10)C=h.type===r.type?null:h.child;else if(h.tag===18){if(C=h.return,C===null)throw Error(c(341));C.lanes|=s,I=C.alternate,I!==null&&(I.lanes|=s),Rs(C,s,r),C=h.sibling}else C=h.child;if(C!==null)C.return=h;else for(C=h;C!==null;){if(C===r){C=null;break}if(h=C.sibling,h!==null){h.return=C.return,C=h;break}C=C.return}h=C}ut(n,r,u.children,s),r=r.child}return r;case 9:return u=r.type,l=r.pendingProps.children,Vn(r,s),u=Mt(u),l=l(u),r.flags|=1,ut(n,r,l,s),r.child;case 14:return l=r.type,u=Dt(l,r.pendingProps),u=Dt(l.type,u),Ya(n,r,l,u,s);case 15:return qa(n,r,r.type,r.pendingProps,s);case 17:return l=r.type,u=r.pendingProps,u=r.elementType===l?u:Dt(l,u),n!==null&&(n.alternate=null,r.alternate=null,r.flags|=2),r.tag=1,ht(l)?(n=!0,Jr(r)):n=!1,Vn(r,s),fa(r,l,u),_s(r,l,u,s),Vs(null,r,l,!0,n,s);case 19:return io(n,r,s);case 22:return Qa(n,r,s)}throw Error(c(156,r.tag))};function Po(n,r){return vs(n,r)}function hf(n,r,s,l){this.tag=n,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function kt(n,r,s,l){return new hf(n,r,s,l)}function hl(n){return n=n.prototype,!(!n||!n.isReactComponent)}function pf(n){if(typeof n=="function")return hl(n)?1:0;if(n!=null){if(n=n.$$typeof,n===M)return 11;if(n===_)return 14}return 2}function wn(n,r){var s=n.alternate;return s===null?(s=kt(n.tag,r,n.key,n.mode),s.elementType=n.elementType,s.type=n.type,s.stateNode=n.stateNode,s.alternate=n,n.alternate=s):(s.pendingProps=r,s.type=n.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=n.flags&14680064,s.childLanes=n.childLanes,s.lanes=n.lanes,s.child=n.child,s.memoizedProps=n.memoizedProps,s.memoizedState=n.memoizedState,s.updateQueue=n.updateQueue,r=n.dependencies,s.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},s.sibling=n.sibling,s.index=n.index,s.ref=n.ref,s}function Gi(n,r,s,l,u,h){var C=2;if(l=n,typeof n=="function")hl(n)&&(C=1);else if(typeof n=="string")C=5;else e:switch(n){case v:return Fn(s.children,u,h,r);case m:C=8,u|=8;break;case y:return n=kt(12,s,r,u|2),n.elementType=y,n.lanes=h,n;case R:return n=kt(13,s,r,u),n.elementType=R,n.lanes=h,n;case E:return n=kt(19,s,r,u),n.elementType=E,n.lanes=h,n;case A:return Wi(s,u,h,r);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case x:C=10;break e;case w:C=9;break e;case M:C=11;break e;case _:C=14;break e;case b:C=16,l=null;break e}throw Error(c(130,n==null?n:typeof n,""))}return r=kt(C,s,r,u),r.elementType=n,r.type=l,r.lanes=h,r}function Fn(n,r,s,l){return n=kt(7,n,l,r),n.lanes=s,n}function Wi(n,r,s,l){return n=kt(22,n,l,r),n.elementType=A,n.lanes=s,n.stateNode={},n}function pl(n,r,s){return n=kt(6,n,null,r),n.lanes=s,n}function ml(n,r,s){return r=kt(4,n.children!==null?n.children:[],n.key,r),r.lanes=s,r.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},r}function mf(n,r,s,l,u){this.tag=r,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=xe,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ps(0),this.expirationTimes=ps(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ps(0),this.identifierPrefix=l,this.onRecoverableError=u,ue&&(this.mutableSourceEagerHydrationData=null)}function ko(n,r,s,l,u,h,C,I,Q){return n=new mf(n,r,s,I,Q),r===1?(r=1,h===!0&&(r|=8)):r=0,h=kt(3,null,null,r),n.current=h,h.stateNode=n,h.memoizedState={element:l,isDehydrated:s,cache:null,transitions:null},Ms(h),n}function zo(n){if(!n)return hn;n=n._reactInternals;e:{if(W(n)!==n||n.tag!==1)throw Error(c(170));var r=n;do{switch(r.tag){case 3:r=r.stateNode.context;break e;case 1:if(ht(r.type)){r=r.stateNode.__reactInternalMemoizedMergedChildContext;break e}}r=r.return}while(r!==null);throw Error(c(171))}if(n.tag===1){var s=n.type;if(ht(s))return ea(n,s,r)}return r}function Ao(n){var r=n._reactInternals;if(r===void 0)throw typeof n.render=="function"?Error(c(188)):(n=Object.keys(n).join(","),Error(c(268,n)));return n=V(r),n===null?null:n.stateNode}function No(n,r){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var s=n.retryLane;n.retryLane=s!==0&&s<r?s:r}}function vl(n,r){No(n,r),(n=n.alternate)&&No(n,r)}function vf(n){return n=V(n),n===null?null:n.stateNode}function gf(){return null}return i.attemptContinuousHydration=function(n){if(n.tag===13){var r=ct();Pt(n,134217728,r),vl(n,134217728)}},i.attemptHydrationAtCurrentPriority=function(n){if(n.tag===13){var r=ct(),s=yn(n);Pt(n,s,r),vl(n,s)}},i.attemptSynchronousHydration=function(n){switch(n.tag){case 3:var r=n.stateNode;if(r.current.memoizedState.isDehydrated){var s=yr(r.pendingLanes);s!==0&&(ms(r,s|1),mt(r,Ke()),!(Re&6)&&(tr(),Yt()))}break;case 13:var l=ct();So(function(){return Pt(n,1,l)}),vl(n,1)}},i.batchedUpdates=function(n,r){var s=Re;Re|=1;try{return n(r)}finally{Re=s,Re===0&&(tr(),ri&&Yt())}},i.createComponentSelector=function(n){return{$$typeof:Pi,value:n}},i.createContainer=function(n,r,s,l,u,h,C){return ko(n,r,!1,null,s,l,u,h,C)},i.createHasPseudoClassSelector=function(n){return{$$typeof:ki,value:n}},i.createHydrationContainer=function(n,r,s,l,u,h,C,I,Q){return n=ko(s,l,!0,n,u,h,C,I,Q),n.context=zo(null),s=n.current,l=ct(),u=yn(s),h=tn(l,u),h.callback=r??null,mn(s,h),n.current.lanes=u,xr(n,u,l),mt(n,l),n},i.createPortal=function(n,r,s){var l=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:g,key:l==null?null:""+l,children:n,containerInfo:r,implementation:s}},i.createRoleSelector=function(n){return{$$typeof:zi,value:n}},i.createTestNameSelector=function(n){return{$$typeof:Ai,value:n}},i.createTextSelector=function(n){return{$$typeof:Ni,value:n}},i.deferredUpdates=function(n){var r=_e,s=We.transition;try{return We.transition=null,_e=16,n()}finally{_e=r,We.transition=s}},i.discreteUpdates=function(n,r,s,l,u){var h=_e,C=We.transition;try{return We.transition=null,_e=1,n(r,s,l,u)}finally{_e=h,We.transition=C,Re===0&&tr()}},i.findAllNodes=nl,i.findBoundingRects=function(n,r){if(!et)throw Error(c(363));r=nl(n,r),n=[];for(var s=0;s<r.length;s++)n.push(gt(r[s]));for(r=n.length-1;0<r;r--){s=n[r];for(var l=s.x,u=l+s.width,h=s.y,C=h+s.height,I=r-1;0<=I;I--)if(r!==I){var Q=n[I],ee=Q.x,le=ee+Q.width,ge=Q.y,pe=ge+Q.height;if(l>=ee&&h>=ge&&u<=le&&C<=pe){n.splice(r,1);break}else if(l!==ee||s.width!==Q.width||pe<h||ge>C){if(!(h!==ge||s.height!==Q.height||le<l||ee>u)){ee>l&&(Q.width+=ee-l,Q.x=l),le<u&&(Q.width=u-ee),n.splice(r,1);break}}else{ge>h&&(Q.height+=ge-h,Q.y=h),pe<C&&(Q.height=C-ge),n.splice(r,1);break}}}return n},i.findHostInstance=Ao,i.findHostInstanceWithNoPortals=function(n){return n=z(n),n=n!==null?N(n):null,n===null?null:n.stateNode},i.findHostInstanceWithWarning=function(n){return Ao(n)},i.flushControlled=function(n){var r=Re;Re|=1;var s=We.transition,l=_e;try{We.transition=null,_e=1,n()}finally{_e=l,We.transition=s,Re=r,Re===0&&(tr(),Yt())}},i.flushPassiveEffects=Ln,i.flushSync=So,i.focusWithin=function(n,r){if(!et)throw Error(c(363));for(n=$s(n),r=yo(n,r),r=Array.from(r),n=0;n<r.length;){var s=r[n++];if(!Rt(s)){if(s.tag===5&&yt(s.stateNode))return!0;for(s=s.child;s!==null;)r.push(s),s=s.sibling}}return!1},i.getCurrentUpdatePriority=function(){return _e},i.getFindAllNodesFailureDescription=function(n,r){if(!et)throw Error(c(363));var s=0,l=[];n=[$s(n),0];for(var u=0;u<n.length;){var h=n[u++],C=n[u++],I=r[C];if((h.tag!==5||!Rt(h))&&(el(h,I)&&(l.push(tl(I)),C++,C>s&&(s=C)),C<r.length))for(h=h.child;h!==null;)n.push(h,C),h=h.sibling}if(s<r.length){for(n=[];s<r.length;s++)n.push(tl(r[s]));return`findAllNodes was able to match part of the selector:
  `+(l.join(" > ")+`

No matching component was found for:
  `)+n.join(" > ")}return null},i.getPublicRootInstance=function(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return J(n.child.stateNode);default:return n.child.stateNode}},i.injectIntoDevTools=function(n){if(n={bundleType:n.bundleType,version:n.version,rendererPackageName:n.rendererPackageName,rendererConfig:n.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:p.ReactCurrentDispatcher,findHostInstanceByFiber:vf,findFiberByHostInstance:n.findFiberByHostInstance||gf,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")n=!1;else{var r=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(r.isDisabled||!r.supportsFiber)n=!0;else{try{ni=r.inject(n),Vt=r}catch{}n=!!r.checkDCE}}return n},i.isAlreadyRendering=function(){return!1},i.observeVisibleRects=function(n,r,s,l){if(!et)throw Error(c(363));n=nl(n,r);var u=Ze(n,s,l).disconnect;return{disconnect:function(){u()}}},i.registerMutableSourceForHydration=function(n,r){var s=r._getVersion;s=s(r._source),n.mutableSourceEagerHydrationData==null?n.mutableSourceEagerHydrationData=[r,s]:n.mutableSourceEagerHydrationData.push(r,s)},i.runWithPriority=function(n,r){var s=_e;try{return _e=n,r()}finally{_e=s}},i.shouldError=function(){return null},i.shouldSuspend=function(){return!1},i.updateContainer=function(n,r,s,l){var u=r.current,h=ct(),C=yn(u);return s=zo(s),r.context===null?r.context=s:r.pendingContext=s,r=tn(h,C),r.payload={element:n},l=l===void 0?null:l,l!==null&&(r.callback=l),mn(u,r),n=Pt(u,C,h),n!==null&&ai(n,u,C),C},i};ju.exports=Ch;var _h=ju.exports;const Th=wf(_h);var Hu={exports:{}},Gu={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(k,F){var U=k.length;k.push(F);e:for(;0<U;){var j=U-1>>>1,q=k[j];if(0<o(q,F))k[j]=F,k[U]=q,U=j;else break e}}function i(k){return k.length===0?null:k[0]}function a(k){if(k.length===0)return null;var F=k[0],U=k.pop();if(U!==F){k[0]=U;e:for(var j=0,q=k.length,$=q>>>1;j<$;){var K=2*(j+1)-1,ie=k[K],oe=K+1,me=k[oe];if(0>o(ie,U))oe<q&&0>o(me,ie)?(k[j]=me,k[oe]=U,j=oe):(k[j]=ie,k[K]=U,j=K);else if(oe<q&&0>o(me,U))k[j]=me,k[oe]=U,j=oe;else break e}}return F}function o(k,F){var U=k.sortIndex-F.sortIndex;return U!==0?U:k.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var f=performance;t.unstable_now=function(){return f.now()}}else{var c=Date,p=c.now();t.unstable_now=function(){return c.now()-p}}var d=[],g=[],v=1,m=null,y=3,x=!1,w=!1,M=!1,R=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(k){for(var F=i(g);F!==null;){if(F.callback===null)a(g);else if(F.startTime<=k)a(g),F.sortIndex=F.expirationTime,e(d,F);else break;F=i(g)}}function A(k){if(M=!1,b(k),!w)if(i(d)!==null)w=!0,J(D);else{var F=i(g);F!==null&&te(A,F.startTime-k)}}function D(k,F){w=!1,M&&(M=!1,E(G),G=-1),x=!0;var U=y;try{for(b(F),m=i(d);m!==null&&(!(m.expirationTime>F)||k&&!z());){var j=m.callback;if(typeof j=="function"){m.callback=null,y=m.priorityLevel;var q=j(m.expirationTime<=F);F=t.unstable_now(),typeof q=="function"?m.callback=q:m===i(d)&&a(d),b(F)}else a(d);m=i(d)}if(m!==null)var $=!0;else{var K=i(g);K!==null&&te(A,K.startTime-F),$=!1}return $}finally{m=null,y=U,x=!1}}var L=!1,O=null,G=-1,W=5,P=-1;function z(){return!(t.unstable_now()-P<W)}function V(){if(O!==null){var k=t.unstable_now();P=k;var F=!0;try{F=O(!0,k)}finally{F?X():(L=!1,O=null)}}else L=!1}var X;if(typeof _=="function")X=function(){_(V)};else if(typeof MessageChannel<"u"){var N=new MessageChannel,Z=N.port2;N.port1.onmessage=V,X=function(){Z.postMessage(null)}}else X=function(){R(V,0)};function J(k){O=k,L||(L=!0,X())}function te(k,F){G=R(function(){k(t.unstable_now())},F)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(k){k.callback=null},t.unstable_continueExecution=function(){w||x||(w=!0,J(D))},t.unstable_forceFrameRate=function(k){0>k||125<k?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):W=0<k?Math.floor(1e3/k):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_getFirstCallbackNode=function(){return i(d)},t.unstable_next=function(k){switch(y){case 1:case 2:case 3:var F=3;break;default:F=y}var U=y;y=F;try{return k()}finally{y=U}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(k,F){switch(k){case 1:case 2:case 3:case 4:case 5:break;default:k=3}var U=y;y=k;try{return F()}finally{y=U}},t.unstable_scheduleCallback=function(k,F,U){var j=t.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?j+U:j):U=j,k){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=U+q,k={id:v++,callback:F,priorityLevel:k,startTime:U,expirationTime:q,sortIndex:-1},U>j?(k.sortIndex=U,e(g,k),i(d)===null&&k===i(g)&&(M?(E(G),G=-1):M=!0,te(A,U-j))):(k.sortIndex=q,e(d,k),w||x||(w=!0,J(D))),k},t.unstable_shouldYield=z,t.unstable_wrapCallback=function(k){var F=y;return function(){var U=y;y=F;try{return k.apply(this,arguments)}finally{y=U}}}})(Gu);Hu.exports=Gu;var su=Hu.exports;const Ql={},bh=t=>void Object.assign(Ql,t);function Ph(t,e){function i(v,{args:m=[],attach:y,...x},w){let M=`${v[0].toUpperCase()}${v.slice(1)}`,R;if(v==="primitive"){if(x.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const E=x.object;R=sr(E,{type:v,root:w,attach:y,primitive:!0})}else{const E=Ql[M];if(!E)throw new Error(`R3F: ${M} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(m))throw new Error("R3F: The args prop must be an array!");R=sr(new E(...m),{type:v,root:w,attach:y,memoizedProps:{args:m}})}return R.__r3f.attach===void 0&&(R instanceof Wl?R.__r3f.attach="geometry":R instanceof Vl&&(R.__r3f.attach="material")),M!=="inject"&&Tl(R,x),R}function a(v,m){let y=!1;if(m){var x,w;(x=m.__r3f)!=null&&x.attach?_l(v,m,m.__r3f.attach):m.isObject3D&&v.isObject3D&&(v.add(m),y=!0),y||(w=v.__r3f)==null||w.objects.push(m),m.__r3f||sr(m,{}),m.__r3f.parent=v,jl(m),lr(m)}}function o(v,m,y){let x=!1;if(m){var w,M;if((w=m.__r3f)!=null&&w.attach)_l(v,m,m.__r3f.attach);else if(m.isObject3D&&v.isObject3D){m.parent=v,m.dispatchEvent({type:"added"});const R=v.children.filter(_=>_!==m),E=R.indexOf(y);v.children=[...R.slice(0,E),m,...R.slice(E)],x=!0}x||(M=v.__r3f)==null||M.objects.push(m),m.__r3f||sr(m,{}),m.__r3f.parent=v,jl(m),lr(m)}}function f(v,m,y=!1){v&&[...v].forEach(x=>c(m,x,y))}function c(v,m,y){if(m){var x,w,M;if(m.__r3f&&(m.__r3f.parent=null),(x=v.__r3f)!=null&&x.objects&&(v.__r3f.objects=v.__r3f.objects.filter(A=>A!==m)),(w=m.__r3f)!=null&&w.attach)cu(v,m,m.__r3f.attach);else if(m.isObject3D&&v.isObject3D){var R;v.remove(m),(R=m.__r3f)!=null&&R.root&&Fh(m.__r3f.root,m)}const _=(M=m.__r3f)==null?void 0:M.primitive,b=y===void 0?m.dispose!==null&&!_:y;if(!_){var E;f((E=m.__r3f)==null?void 0:E.objects,m,b),f(m.children,m,b)}delete m.__r3f,b&&m.dispose&&m.type!=="Scene"&&su.unstable_scheduleCallback(su.unstable_IdlePriority,()=>{try{m.dispose()}catch{}}),lr(v)}}function p(v,m,y,x){var w;const M=(w=v.__r3f)==null?void 0:w.parent;if(!M)return;const R=i(m,y,v.__r3f.root);if(v.children){for(const E of v.children)E.__r3f&&a(R,E);v.children=v.children.filter(E=>!E.__r3f)}v.__r3f.objects.forEach(E=>a(R,E)),v.__r3f.objects=[],v.__r3f.autoRemovedBeforeAppend||c(M,v),R.parent&&(R.__r3f.autoRemovedBeforeAppend=!0),a(M,R),R.raycast&&R.__r3f.eventCount&&R.__r3f.root.getState().internal.interaction.push(R),[x,x.alternate].forEach(E=>{E!==null&&(E.stateNode=R,E.ref&&(typeof E.ref=="function"?E.ref(R):E.ref.current=R))})}const d=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:Th({createInstance:i,removeChild:c,appendChild:a,appendInitialChild:a,insertBefore:o,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(v,m)=>{if(!m)return;const y=v.getState().scene;y.__r3f&&(y.__r3f.root=v,a(y,m))},removeChildFromContainer:(v,m)=>{m&&c(v.getState().scene,m)},insertInContainerBefore:(v,m,y)=>{if(!m||!y)return;const x=v.getState().scene;x.__r3f&&o(x,m,y)},getRootHostContext:()=>null,getChildHostContext:v=>v,finalizeInitialChildren(v){var m;return!!((m=v==null?void 0:v.__r3f)!=null?m:{}).handlers},prepareUpdate(v,m,y,x){var w;if(((w=v==null?void 0:v.__r3f)!=null?w:{}).primitive&&x.object&&x.object!==v)return[!0];{const{args:R=[],children:E,..._}=x,{args:b=[],children:A,...D}=y;if(!Array.isArray(R))throw new Error("R3F: the args prop must be an array!");if(R.some((O,G)=>O!==b[G]))return[!0];const L=Zu(v,_,D,!0);return L.changes.length?[!1,L]:null}},commitUpdate(v,[m,y],x,w,M,R){m?p(v,x,M,R):Tl(v,y)},commitMount(v,m,y,x){var w;const M=(w=v.__r3f)!=null?w:{};v.raycast&&M.handlers&&M.eventCount&&v.__r3f.root.getState().internal.interaction.push(v)},getPublicInstance:v=>v,prepareForCommit:()=>null,preparePortalMount:v=>sr(v.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(v){var m;const{attach:y,parent:x}=(m=v.__r3f)!=null?m:{};y&&x&&cu(x,v,y),v.isObject3D&&(v.visible=!1),lr(v)},unhideInstance(v,m){var y;const{attach:x,parent:w}=(y=v.__r3f)!=null?y:{};x&&w&&_l(w,v,x),(v.isObject3D&&m.visible==null||m.visible)&&(v.visible=!0),lr(v)},createTextInstance:d,hideTextInstance:d,unhideTextInstance:d,getCurrentEventPriority:()=>e?e():ar.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&Be.fun(performance.now)?performance.now:Be.fun(Date.now)?Date.now:()=>0,scheduleTimeout:Be.fun(setTimeout)?setTimeout:void 0,cancelTimeout:Be.fun(clearTimeout)?clearTimeout:void 0}),applyProps:Tl}}var lu,au;const Cl=t=>"colorSpace"in t||"outputColorSpace"in t,Wu=()=>{var t;return(t=Ql.ColorManagement)!=null?t:null},Vu=t=>t&&t.isOrthographicCamera,kh=t=>t&&t.hasOwnProperty("current"),Vr=typeof window<"u"&&((lu=window.document)!=null&&lu.createElement||((au=window.navigator)==null?void 0:au.product)==="ReactNative")?T.useLayoutEffect:T.useEffect;function Xu(t){const e=T.useRef(t);return Vr(()=>void(e.current=t),[t]),e}function zh({set:t}){return Vr(()=>(t(new Promise(()=>null)),()=>t(!1)),[t]),null}class Yu extends T.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}Yu.getDerivedStateFromError=()=>({error:!0});const qu="__default",ou=new Map,Ah=t=>t&&!!t.memoized&&!!t.changes;function Qu(t){var e;const i=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(t)?Math.min(Math.max(t[0],i),t[1]):t}const Br=t=>{var e;return(e=t.__r3f)==null?void 0:e.root.getState()},Be={obj:t=>t===Object(t)&&!Be.arr(t)&&typeof t!="function",fun:t=>typeof t=="function",str:t=>typeof t=="string",num:t=>typeof t=="number",boo:t=>typeof t=="boolean",und:t=>t===void 0,arr:t=>Array.isArray(t),equ(t,e,{arrays:i="shallow",objects:a="reference",strict:o=!0}={}){if(typeof t!=typeof e||!!t!=!!e)return!1;if(Be.str(t)||Be.num(t))return t===e;const f=Be.obj(t);if(f&&a==="reference")return t===e;const c=Be.arr(t);if(c&&i==="reference")return t===e;if((c||f)&&t===e)return!0;let p;for(p in t)if(!(p in e))return!1;if(f&&i==="shallow"&&a==="shallow"){for(p in o?e:t)if(!Be.equ(t[p],e[p],{strict:o,objects:"reference"}))return!1}else for(p in o?e:t)if(t[p]!==e[p])return!1;if(Be.und(p)){if(c&&t.length===0&&e.length===0||f&&Object.keys(t).length===0&&Object.keys(e).length===0)return!0;if(t!==e)return!1}return!0}};function Nh(t){t.dispose&&t.type!=="Scene"&&t.dispose();for(const e in t)e.dispose==null||e.dispose(),delete t[e]}function sr(t,e){const i=t;return i.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e},t}function Ol(t,e){let i=t;if(e.includes("-")){const a=e.split("-"),o=a.pop();return i=a.reduce((f,c)=>f[c],t),{target:i,key:o}}else return{target:i,key:e}}const uu=/-\d+$/;function _l(t,e,i){if(Be.str(i)){if(uu.test(i)){const f=i.replace(uu,""),{target:c,key:p}=Ol(t,f);Array.isArray(c[p])||(c[p]=[])}const{target:a,key:o}=Ol(t,i);e.__r3f.previousAttach=a[o],a[o]=e}else e.__r3f.previousAttach=i(t,e)}function cu(t,e,i){var a,o;if(Be.str(i)){const{target:f,key:c}=Ol(t,i),p=e.__r3f.previousAttach;p===void 0?delete f[c]:f[c]=p}else(a=e.__r3f)==null||a.previousAttach==null||a.previousAttach(t,e);(o=e.__r3f)==null||delete o.previousAttach}function Zu(t,{children:e,key:i,ref:a,...o},{children:f,key:c,ref:p,...d}={},g=!1){var v;const m=(v=t==null?void 0:t.__r3f)!=null?v:{},y=Object.entries(o),x=[];if(g){const M=Object.keys(d);for(let R=0;R<M.length;R++)o.hasOwnProperty(M[R])||y.unshift([M[R],qu+"remove"])}y.forEach(([M,R])=>{var E;if((E=t.__r3f)!=null&&E.primitive&&M==="object"||Be.equ(R,d[M]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(M))return x.push([M,R,!0,[]]);let _=[];M.includes("-")&&(_=M.split("-")),x.push([M,R,!1,_]);for(const b in o){const A=o[b];b.startsWith(`${M}-`)&&x.push([b,A,!1,b.split("-")])}});const w={...o};return m.memoizedProps&&m.memoizedProps.args&&(w.args=m.memoizedProps.args),m.memoizedProps&&m.memoizedProps.attach&&(w.attach=m.memoizedProps.attach),{memoized:w,changes:x}}function Tl(t,e){var i,a,o;const f=(i=t.__r3f)!=null?i:{},c=f.root,p=(a=c==null||c.getState==null?void 0:c.getState())!=null?a:{},{memoized:d,changes:g}=Ah(e)?e:Zu(t,e),v=f.eventCount;t.__r3f&&(t.__r3f.memoizedProps=d);for(let y=0;y<g.length;y++){let[x,w,M,R]=g[y];if(Cl(t)){const A="srgb",D="srgb-linear";x==="encoding"?(x="colorSpace",w=w===3001?A:D):x==="outputEncoding"&&(x="outputColorSpace",w=w===3001?A:D)}let E=t,_=E[x];if(R.length&&(_=R.reduce((b,A)=>b[A],t),!(_&&_.set))){const[b,...A]=R.reverse();E=A.reverse().reduce((D,L)=>D[L],t),x=b}if(w===qu+"remove")if(E.constructor){let b=ou.get(E.constructor);b||(b=new E.constructor,ou.set(E.constructor,b)),w=b[x]}else w=0;if(M)w?f.handlers[x]=w:delete f.handlers[x],f.eventCount=Object.keys(f.handlers).length;else if(_&&_.set&&(_.copy||_ instanceof yl)){if(Array.isArray(w))_.fromArray?_.fromArray(w):_.set(...w);else if(_.copy&&w&&w.constructor&&_.constructor===w.constructor)_.copy(w);else if(w!==void 0){const b=_ instanceof or;!b&&_.setScalar?_.setScalar(w):_ instanceof yl&&w instanceof yl?_.mask=w.mask:_.set(w),!Wu()&&!p.linear&&b&&_.convertSRGBToLinear()}}else if(E[x]=w,E[x]instanceof Xl&&E[x].format===_f&&E[x].type===Mn){const b=E[x];Cl(b)&&Cl(p.gl)?b.colorSpace=p.gl.outputColorSpace:b.encoding=p.gl.outputEncoding}lr(t)}if(f.parent&&p.internal&&t.raycast&&v!==f.eventCount){const y=p.internal.interaction.indexOf(t);y>-1&&p.internal.interaction.splice(y,1),f.eventCount&&p.internal.interaction.push(t)}return!(g.length===1&&g[0][0]==="onUpdate")&&g.length&&(o=t.__r3f)!=null&&o.parent&&jl(t),t}function lr(t){var e,i;const a=(e=t.__r3f)==null||(i=e.root)==null||i.getState==null?void 0:i.getState();a&&a.internal.frames===0&&a.invalidate()}function jl(t){t.onUpdate==null||t.onUpdate(t)}function Ih(t,e){t.manual||(Vu(t)?(t.left=e.width/-2,t.right=e.width/2,t.top=e.height/2,t.bottom=e.height/-2):t.aspect=e.width/e.height,t.updateProjectionMatrix(),t.updateMatrixWorld())}function Xi(t){return(t.eventObject||t.object).uuid+"/"+t.index+t.instanceId}function Lh(){var t;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return ar.DefaultEventPriority;switch((t=e.event)==null?void 0:t.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return ar.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return ar.ContinuousEventPriority;default:return ar.DefaultEventPriority}}function Ku(t,e,i,a){const o=i.get(e);o&&(i.delete(e),i.size===0&&(t.delete(a),o.target.releasePointerCapture(a)))}function Fh(t,e){const{internal:i}=t.getState();i.interaction=i.interaction.filter(a=>a!==e),i.initialHits=i.initialHits.filter(a=>a!==e),i.hovered.forEach((a,o)=>{(a.eventObject===e||a.object===e)&&i.hovered.delete(o)}),i.capturedMap.forEach((a,o)=>{Ku(i.capturedMap,e,a,o)})}function Bh(t){function e(d){const{internal:g}=t.getState(),v=d.offsetX-g.initialClick[0],m=d.offsetY-g.initialClick[1];return Math.round(Math.sqrt(v*v+m*m))}function i(d){return d.filter(g=>["Move","Over","Enter","Out","Leave"].some(v=>{var m;return(m=g.__r3f)==null?void 0:m.handlers["onPointer"+v]}))}function a(d,g){const v=t.getState(),m=new Set,y=[],x=g?g(v.internal.interaction):v.internal.interaction;for(let E=0;E<x.length;E++){const _=Br(x[E]);_&&(_.raycaster.camera=void 0)}v.previousRoot||v.events.compute==null||v.events.compute(d,v);function w(E){const _=Br(E);if(!_||!_.events.enabled||_.raycaster.camera===null)return[];if(_.raycaster.camera===void 0){var b;_.events.compute==null||_.events.compute(d,_,(b=_.previousRoot)==null?void 0:b.getState()),_.raycaster.camera===void 0&&(_.raycaster.camera=null)}return _.raycaster.camera?_.raycaster.intersectObject(E,!0):[]}let M=x.flatMap(w).sort((E,_)=>{const b=Br(E.object),A=Br(_.object);return!b||!A?E.distance-_.distance:A.events.priority-b.events.priority||E.distance-_.distance}).filter(E=>{const _=Xi(E);return m.has(_)?!1:(m.add(_),!0)});v.events.filter&&(M=v.events.filter(M,v));for(const E of M){let _=E.object;for(;_;){var R;(R=_.__r3f)!=null&&R.eventCount&&y.push({...E,eventObject:_}),_=_.parent}}if("pointerId"in d&&v.internal.capturedMap.has(d.pointerId))for(let E of v.internal.capturedMap.get(d.pointerId).values())m.has(Xi(E.intersection))||y.push(E.intersection);return y}function o(d,g,v,m){const y=t.getState();if(d.length){const x={stopped:!1};for(const w of d){const M=Br(w.object)||y,{raycaster:R,pointer:E,camera:_,internal:b}=M,A=new Le(E.x,E.y,0).unproject(_),D=P=>{var z,V;return(z=(V=b.capturedMap.get(P))==null?void 0:V.has(w.eventObject))!=null?z:!1},L=P=>{const z={intersection:w,target:g.target};b.capturedMap.has(P)?b.capturedMap.get(P).set(w.eventObject,z):b.capturedMap.set(P,new Map([[w.eventObject,z]])),g.target.setPointerCapture(P)},O=P=>{const z=b.capturedMap.get(P);z&&Ku(b.capturedMap,w.eventObject,z,P)};let G={};for(let P in g){let z=g[P];typeof z!="function"&&(G[P]=z)}let W={...w,...G,pointer:E,intersections:d,stopped:x.stopped,delta:v,unprojectedPoint:A,ray:R.ray,camera:_,stopPropagation(){const P="pointerId"in g&&b.capturedMap.get(g.pointerId);if((!P||P.has(w.eventObject))&&(W.stopped=x.stopped=!0,b.hovered.size&&Array.from(b.hovered.values()).find(z=>z.eventObject===w.eventObject))){const z=d.slice(0,d.indexOf(w));f([...z,w])}},target:{hasPointerCapture:D,setPointerCapture:L,releasePointerCapture:O},currentTarget:{hasPointerCapture:D,setPointerCapture:L,releasePointerCapture:O},nativeEvent:g};if(m(W),x.stopped===!0)break}}return d}function f(d){const{internal:g}=t.getState();for(const v of g.hovered.values())if(!d.length||!d.find(m=>m.object===v.object&&m.index===v.index&&m.instanceId===v.instanceId)){const y=v.eventObject.__r3f,x=y==null?void 0:y.handlers;if(g.hovered.delete(Xi(v)),y!=null&&y.eventCount){const w={...v,intersections:d};x.onPointerOut==null||x.onPointerOut(w),x.onPointerLeave==null||x.onPointerLeave(w)}}}function c(d,g){for(let v=0;v<g.length;v++){const m=g[v].__r3f;m==null||m.handlers.onPointerMissed==null||m.handlers.onPointerMissed(d)}}function p(d){switch(d){case"onPointerLeave":case"onPointerCancel":return()=>f([]);case"onLostPointerCapture":return g=>{const{internal:v}=t.getState();"pointerId"in g&&v.capturedMap.has(g.pointerId)&&requestAnimationFrame(()=>{v.capturedMap.has(g.pointerId)&&(v.capturedMap.delete(g.pointerId),f([]))})}}return function(v){const{onPointerMissed:m,internal:y}=t.getState();y.lastEvent.current=v;const x=d==="onPointerMove",w=d==="onClick"||d==="onContextMenu"||d==="onDoubleClick",R=a(v,x?i:void 0),E=w?e(v):0;d==="onPointerDown"&&(y.initialClick=[v.offsetX,v.offsetY],y.initialHits=R.map(b=>b.eventObject)),w&&!R.length&&E<=2&&(c(v,y.interaction),m&&m(v)),x&&f(R);function _(b){const A=b.eventObject,D=A.__r3f,L=D==null?void 0:D.handlers;if(D!=null&&D.eventCount)if(x){if(L.onPointerOver||L.onPointerEnter||L.onPointerOut||L.onPointerLeave){const O=Xi(b),G=y.hovered.get(O);G?G.stopped&&b.stopPropagation():(y.hovered.set(O,b),L.onPointerOver==null||L.onPointerOver(b),L.onPointerEnter==null||L.onPointerEnter(b))}L.onPointerMove==null||L.onPointerMove(b)}else{const O=L[d];O?(!w||y.initialHits.includes(A))&&(c(v,y.interaction.filter(G=>!y.initialHits.includes(G))),O(b)):w&&y.initialHits.includes(A)&&c(v,y.interaction.filter(G=>!y.initialHits.includes(G)))}}o(R,v,E,_)}}return{handlePointer:p}}const Ju=t=>!!(t!=null&&t.render),$u=T.createContext(null),Uh=(t,e)=>{const i=Eh((p,d)=>{const g=new Le,v=new Le,m=new Le;function y(E=d().camera,_=v,b=d().size){const{width:A,height:D,top:L,left:O}=b,G=A/D;_ instanceof Le?m.copy(_):m.set(..._);const W=E.getWorldPosition(g).distanceTo(m);if(Vu(E))return{width:A/E.zoom,height:D/E.zoom,top:L,left:O,factor:1,distance:W,aspect:G};{const P=E.fov*Math.PI/180,z=2*Math.tan(P/2)*W,V=z*(A/D);return{width:V,height:z,top:L,left:O,factor:A/V,distance:W,aspect:G}}}let x;const w=E=>p(_=>({performance:{..._.performance,current:E}})),M=new Ce;return{set:p,get:d,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(E=1)=>t(d(),E),advance:(E,_)=>e(E,_,d()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new ns,pointer:M,mouse:M,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const E=d();x&&clearTimeout(x),E.performance.current!==E.performance.min&&w(E.performance.min),x=setTimeout(()=>w(d().performance.max),E.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:y},setEvents:E=>p(_=>({..._,events:{..._.events,...E}})),setSize:(E,_,b,A,D)=>{const L=d().camera,O={width:E,height:_,top:A||0,left:D||0,updateStyle:b};p(G=>({size:O,viewport:{...G.viewport,...y(L,v,O)}}))},setDpr:E=>p(_=>{const b=Qu(E);return{viewport:{..._.viewport,dpr:b,initialDpr:_.viewport.initialDpr||b}}}),setFrameloop:(E="always")=>{const _=d().clock;_.stop(),_.elapsedTime=0,E!=="never"&&(_.start(),_.elapsedTime=0),p(()=>({frameloop:E}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:T.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(E,_,b)=>{const A=d().internal;return A.priority=A.priority+(_>0?1:0),A.subscribers.push({ref:E,priority:_,store:b}),A.subscribers=A.subscribers.sort((D,L)=>D.priority-L.priority),()=>{const D=d().internal;D!=null&&D.subscribers&&(D.priority=D.priority-(_>0?1:0),D.subscribers=D.subscribers.filter(L=>L.ref!==E))}}}}}),a=i.getState();let o=a.size,f=a.viewport.dpr,c=a.camera;return i.subscribe(()=>{const{camera:p,size:d,viewport:g,gl:v,set:m}=i.getState();if(d!==o||g.dpr!==f){var y;o=d,f=g.dpr,Ih(p,d),v.setPixelRatio(g.dpr);const x=(y=d.updateStyle)!=null?y:typeof HTMLCanvasElement<"u"&&v.domElement instanceof HTMLCanvasElement;v.setSize(d.width,d.height,x)}p!==c&&(c=p,m(x=>({viewport:{...x.viewport,...x.viewport.getCurrentViewport(p)}})))}),i.subscribe(p=>t(p)),i};let Yi,Dh=new Set,Oh=new Set,jh=new Set;function bl(t,e){if(t.size)for(const{callback:i}of t.values())i(e)}function Ur(t,e){switch(t){case"before":return bl(Dh,e);case"after":return bl(Oh,e);case"tail":return bl(jh,e)}}let Pl,kl;function zl(t,e,i){let a=e.clock.getDelta();for(e.frameloop==="never"&&typeof t=="number"&&(a=t-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=t),Pl=e.internal.subscribers,Yi=0;Yi<Pl.length;Yi++)kl=Pl[Yi],kl.ref.current(kl.store.getState(),a,i);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function Hh(t){let e=!1,i,a,o;function f(d){a=requestAnimationFrame(f),e=!0,i=0,Ur("before",d);for(const v of t.values()){var g;o=v.store.getState(),o.internal.active&&(o.frameloop==="always"||o.internal.frames>0)&&!((g=o.gl.xr)!=null&&g.isPresenting)&&(i+=zl(d,o))}if(Ur("after",d),i===0)return Ur("tail",d),e=!1,cancelAnimationFrame(a)}function c(d,g=1){var v;if(!d)return t.forEach(m=>c(m.store.getState()),g);(v=d.gl.xr)!=null&&v.isPresenting||!d.internal.active||d.frameloop==="never"||(d.internal.frames=Math.min(60,d.internal.frames+g),e||(e=!0,requestAnimationFrame(f)))}function p(d,g=!0,v,m){if(g&&Ur("before",d),v)zl(d,v,m);else for(const y of t.values())zl(d,y.store.getState());g&&Ur("after",d)}return{loop:f,invalidate:c,advance:p}}function ec(){const t=T.useContext($u);if(!t)throw new Error("R3F: Hooks can only be used within the Canvas component!");return t}function Gh(t=i=>i,e){return ec()(t,e)}function Wh(t,e=0){const i=ec(),a=i.getState().internal.subscribe,o=Xu(t);return Vr(()=>a(o,e,i),[e,a,i]),null}const ur=new Map,{invalidate:fu,advance:du}=Hh(ur),{reconciler:es,applyProps:nr}=Ph(ur,Lh),rr={objects:"shallow",strict:!1},Vh=(t,e)=>{const i=typeof t=="function"?t(e):t;return Ju(i)?i:new Wr({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...t})};function Xh(t,e){if(e)return e;if(typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&t.parentElement){const{width:i,height:a,top:o,left:f}=t.parentElement.getBoundingClientRect();return{width:i,height:a,top:o,left:f}}else if(typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas)return{width:t.width,height:t.height,top:0,left:0};return{width:0,height:0,top:0,left:0}}function Yh(t){const e=ur.get(t),i=e==null?void 0:e.fiber,a=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const o=typeof reportError=="function"?reportError:console.error,f=a||Uh(fu,du),c=i||es.createContainer(f,ar.ConcurrentRoot,null,!1,null,"",o,null);e||ur.set(t,{fiber:c,store:f});let p,d=!1,g;return{configure(v={}){let{gl:m,size:y,scene:x,events:w,onCreated:M,shadows:R=!1,linear:E=!1,flat:_=!1,legacy:b=!1,orthographic:A=!1,frameloop:D="always",dpr:L=[1,2],performance:O,raycaster:G,camera:W,onPointerMissed:P}=v,z=f.getState(),V=z.gl;z.gl||z.set({gl:V=Vh(m,t)});let X=z.raycaster;X||z.set({raycaster:X=new Pu});const{params:N,...Z}=G||{};if(Be.equ(Z,X,rr)||nr(X,{...Z}),Be.equ(N,X.params,rr)||nr(X,{params:{...X.params,...N}}),!z.camera||z.camera===g&&!Be.equ(g,W,rr)){g=W;const q=W instanceof Cf,$=q?W:A?new Gr(0,0,0,0,.1,1e3):new Gl(75,0,.1,1e3);q||($.position.z=5,W&&nr($,W),!z.camera&&!(W!=null&&W.rotation)&&$.lookAt(0,0,0)),z.set({camera:$})}if(!z.scene){let q;x instanceof an?q=x:(q=new an,x&&nr(q,x)),z.set({scene:sr(q)})}if(!z.xr){var J;const q=(ie,oe)=>{const me=f.getState();me.frameloop!=="never"&&du(ie,!0,me,oe)},$=()=>{const ie=f.getState();ie.gl.xr.enabled=ie.gl.xr.isPresenting,ie.gl.xr.setAnimationLoop(ie.gl.xr.isPresenting?q:null),ie.gl.xr.isPresenting||fu(ie)},K={connect(){const ie=f.getState().gl;ie.xr.addEventListener("sessionstart",$),ie.xr.addEventListener("sessionend",$)},disconnect(){const ie=f.getState().gl;ie.xr.removeEventListener("sessionstart",$),ie.xr.removeEventListener("sessionend",$)}};typeof((J=V.xr)==null?void 0:J.addEventListener)=="function"&&K.connect(),z.set({xr:K})}if(V.shadowMap){const q=V.shadowMap.enabled,$=V.shadowMap.type;if(V.shadowMap.enabled=!!R,Be.boo(R))V.shadowMap.type=gl;else if(Be.str(R)){var te;const K={basic:Mf,percentage:Rf,soft:gl,variance:Ef};V.shadowMap.type=(te=K[R])!=null?te:gl}else Be.obj(R)&&Object.assign(V.shadowMap,R);(q!==V.shadowMap.enabled||$!==V.shadowMap.type)&&(V.shadowMap.needsUpdate=!0)}const k=Wu();k&&("enabled"in k?k.enabled=!b:"legacyMode"in k&&(k.legacyMode=b)),nr(V,{outputEncoding:E?3e3:3001,toneMapping:_?ku:zu}),z.legacy!==b&&z.set(()=>({legacy:b})),z.linear!==E&&z.set(()=>({linear:E})),z.flat!==_&&z.set(()=>({flat:_})),m&&!Be.fun(m)&&!Ju(m)&&!Be.equ(m,V,rr)&&nr(V,m),w&&!z.events.handlers&&z.set({events:w(f)});const j=Xh(t,y);return Be.equ(j,z.size,rr)||z.setSize(j.width,j.height,j.updateStyle,j.top,j.left),L&&z.viewport.dpr!==Qu(L)&&z.setDpr(L),z.frameloop!==D&&z.setFrameloop(D),z.onPointerMissed||z.set({onPointerMissed:P}),O&&!Be.equ(O,z.performance,rr)&&z.set(q=>({performance:{...q.performance,...O}})),p=M,d=!0,this},render(v){return d||this.configure(),es.updateContainer(T.createElement(qh,{store:f,children:v,onCreated:p,rootElement:t}),c,null,()=>{}),f},unmount(){tc(t)}}}function qh({store:t,children:e,onCreated:i,rootElement:a}){return Vr(()=>{const o=t.getState();o.set(f=>({internal:{...f.internal,active:!0}})),i&&i(o),t.getState().events.connected||o.events.connect==null||o.events.connect(a)},[]),T.createElement($u.Provider,{value:t},e)}function tc(t,e){const i=ur.get(t),a=i==null?void 0:i.fiber;if(a){const o=i==null?void 0:i.store.getState();o&&(o.internal.active=!1),es.updateContainer(null,a,null,()=>{o&&setTimeout(()=>{try{var f,c,p,d;o.events.disconnect==null||o.events.disconnect(),(f=o.gl)==null||(c=f.renderLists)==null||c.dispose==null||c.dispose(),(p=o.gl)==null||p.forceContextLoss==null||p.forceContextLoss(),(d=o.gl)!=null&&d.xr&&o.xr.disconnect(),Nh(o),ur.delete(t)}catch{}},500)})}}es.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:T.version});function ts(){return ts=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var a in i)({}).hasOwnProperty.call(i,a)&&(t[a]=i[a])}return t},ts.apply(null,arguments)}function hu(t,e){let i;return(...a)=>{window.clearTimeout(i),i=window.setTimeout(()=>t(...a),e)}}function Qh({debounce:t,scroll:e,polyfill:i,offsetSize:a}={debounce:0,scroll:!1,offsetSize:!1}){const o=i||(typeof window>"u"?class{}:window.ResizeObserver);if(!o)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[f,c]=T.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),p=T.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:f,orientationHandler:null}),d=t?typeof t=="number"?t:t.scroll:null,g=t?typeof t=="number"?t:t.resize:null,v=T.useRef(!1);T.useEffect(()=>(v.current=!0,()=>void(v.current=!1)));const[m,y,x]=T.useMemo(()=>{const E=()=>{if(!p.current.element)return;const{left:_,top:b,width:A,height:D,bottom:L,right:O,x:G,y:W}=p.current.element.getBoundingClientRect(),P={left:_,top:b,width:A,height:D,bottom:L,right:O,x:G,y:W};p.current.element instanceof HTMLElement&&a&&(P.height=p.current.element.offsetHeight,P.width=p.current.element.offsetWidth),Object.freeze(P),v.current&&!$h(p.current.lastBounds,P)&&c(p.current.lastBounds=P)};return[E,g?hu(E,g):E,d?hu(E,d):E]},[c,a,d,g]);function w(){p.current.scrollContainers&&(p.current.scrollContainers.forEach(E=>E.removeEventListener("scroll",x,!0)),p.current.scrollContainers=null),p.current.resizeObserver&&(p.current.resizeObserver.disconnect(),p.current.resizeObserver=null),p.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",p.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",p.current.orientationHandler))}function M(){p.current.element&&(p.current.resizeObserver=new o(x),p.current.resizeObserver.observe(p.current.element),e&&p.current.scrollContainers&&p.current.scrollContainers.forEach(E=>E.addEventListener("scroll",x,{capture:!0,passive:!0})),p.current.orientationHandler=()=>{x()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",p.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",p.current.orientationHandler))}const R=E=>{!E||E===p.current.element||(w(),p.current.element=E,p.current.scrollContainers=nc(E),M())};return Kh(x,!!e),Zh(y),T.useEffect(()=>{w(),M()},[e,x,y]),T.useEffect(()=>w,[]),[R,f,m]}function Zh(t){T.useEffect(()=>{const e=t;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[t])}function Kh(t,e){T.useEffect(()=>{if(e){const i=t;return window.addEventListener("scroll",i,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",i,!0)}},[t,e])}function nc(t){const e=[];if(!t||t===document.body)return e;const{overflow:i,overflowX:a,overflowY:o}=window.getComputedStyle(t);return[i,a,o].some(f=>f==="auto"||f==="scroll")&&e.push(t),[...e,...nc(t.parentElement)]}const Jh=["x","y","top","bottom","left","right","width","height"],$h=(t,e)=>Jh.every(i=>t[i]===e[i]);var ep=Object.defineProperty,tp=Object.defineProperties,np=Object.getOwnPropertyDescriptors,pu=Object.getOwnPropertySymbols,rp=Object.prototype.hasOwnProperty,ip=Object.prototype.propertyIsEnumerable,mu=(t,e,i)=>e in t?ep(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,vu=(t,e)=>{for(var i in e||(e={}))rp.call(e,i)&&mu(t,i,e[i]);if(pu)for(var i of pu(e))ip.call(e,i)&&mu(t,i,e[i]);return t},sp=(t,e)=>tp(t,np(e)),gu,yu;typeof window<"u"&&((gu=window.document)!=null&&gu.createElement||((yu=window.navigator)==null?void 0:yu.product)==="ReactNative")?T.useLayoutEffect:T.useEffect;function rc(t,e,i){if(!t)return;if(i(t)===!0)return t;let a=t.child;for(;a;){const o=rc(a,e,i);if(o)return o;a=a.sibling}}function ic(t){try{return Object.defineProperties(t,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return t}}const xu=console.error;console.error=function(){const t=[...arguments].join("");if(t!=null&&t.startsWith("Warning:")&&t.includes("useContext")){console.error=xu;return}return xu.apply(this,arguments)};const Zl=ic(T.createContext(null));class sc extends T.Component{render(){return T.createElement(Zl.Provider,{value:this._reactInternals},this.props.children)}}function lp(){const t=T.useContext(Zl);if(t===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=T.useId();return T.useMemo(()=>{for(const a of[t,t==null?void 0:t.alternate]){if(!a)continue;const o=rc(a,!1,f=>{let c=f.memoizedState;for(;c;){if(c.memoizedState===e)return!0;c=c.next}});if(o)return o}},[t,e])}function ap(){const t=lp(),[e]=T.useState(()=>new Map);e.clear();let i=t;for(;i;){if(i.type&&typeof i.type=="object"){const o=i.type._context===void 0&&i.type.Provider===i.type?i.type:i.type._context;o&&o!==Zl&&!e.has(o)&&e.set(o,T.useContext(ic(o)))}i=i.return}return e}function op(){const t=ap();return T.useMemo(()=>Array.from(t.keys()).reduce((e,i)=>a=>T.createElement(e,null,T.createElement(i.Provider,sp(vu({},a),{value:t.get(i)}))),e=>T.createElement(sc,vu({},e))),[t])}const Al={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function up(t){const{handlePointer:e}=Bh(t);return{priority:1,enabled:!0,compute(i,a,o){a.pointer.set(i.offsetX/a.size.width*2-1,-(i.offsetY/a.size.height)*2+1),a.raycaster.setFromCamera(a.pointer,a.camera)},connected:void 0,handlers:Object.keys(Al).reduce((i,a)=>({...i,[a]:e(a)}),{}),update:()=>{var i;const{events:a,internal:o}=t.getState();(i=o.lastEvent)!=null&&i.current&&a.handlers&&a.handlers.onPointerMove(o.lastEvent.current)},connect:i=>{var a;const{set:o,events:f}=t.getState();f.disconnect==null||f.disconnect(),o(c=>({events:{...c.events,connected:i}})),Object.entries((a=f.handlers)!=null?a:[]).forEach(([c,p])=>{const[d,g]=Al[c];i.addEventListener(d,p,{passive:g})})},disconnect:()=>{const{set:i,events:a}=t.getState();if(a.connected){var o;Object.entries((o=a.handlers)!=null?o:[]).forEach(([f,c])=>{if(a&&a.connected instanceof HTMLElement){const[p]=Al[f];a.connected.removeEventListener(p,c)}}),i(f=>({events:{...f.events,connected:void 0}}))}}}}const cp=T.forwardRef(function({children:e,fallback:i,resize:a,style:o,gl:f,events:c=up,eventSource:p,eventPrefix:d,shadows:g,linear:v,flat:m,legacy:y,orthographic:x,frameloop:w,dpr:M,performance:R,raycaster:E,camera:_,scene:b,onPointerMissed:A,onCreated:D,...L},O){T.useMemo(()=>bh(Tf),[]);const G=op(),[W,P]=Qh({scroll:!0,debounce:{scroll:50,resize:0},...a}),z=T.useRef(null),V=T.useRef(null);T.useImperativeHandle(O,()=>z.current);const X=Xu(A),[N,Z]=T.useState(!1),[J,te]=T.useState(!1);if(N)throw N;if(J)throw J;const k=T.useRef(null);Vr(()=>{const U=z.current;P.width>0&&P.height>0&&U&&(k.current||(k.current=Yh(U)),k.current.configure({gl:f,events:c,shadows:g,linear:v,flat:m,legacy:y,orthographic:x,frameloop:w,dpr:M,performance:R,raycaster:E,camera:_,scene:b,size:P,onPointerMissed:(...j)=>X.current==null?void 0:X.current(...j),onCreated:j=>{j.events.connect==null||j.events.connect(p?kh(p)?p.current:p:V.current),d&&j.setEvents({compute:(q,$)=>{const K=q[d+"X"],ie=q[d+"Y"];$.pointer.set(K/$.size.width*2-1,-(ie/$.size.height)*2+1),$.raycaster.setFromCamera($.pointer,$.camera)}}),D==null||D(j)}}),k.current.render(T.createElement(G,null,T.createElement(Yu,{set:te},T.createElement(T.Suspense,{fallback:T.createElement(zh,{set:Z})},e)))))}),T.useEffect(()=>{const U=z.current;if(U)return()=>tc(U)},[]);const F=p?"none":"auto";return T.createElement("div",ts({ref:V,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:F,...o}},L),T.createElement("div",{ref:W,style:{width:"100%",height:"100%"}},T.createElement("canvas",{ref:z,style:{display:"block"}},i)))}),fp=T.forwardRef(function(e,i){return T.createElement(sc,null,T.createElement(cp,ts({},e,{ref:i})))}),dp=Math.PI/180;function hp(t){return t*dp}function pp(t,e){var y;const i=bf.physical,{vertexShader:a,fragmentShader:o,uniforms:f}=i,c=i.defines??{},p=Pf.clone(f),d=new t(e.material||{});d.color&&(p.diffuse.value=d.color),"roughness"in d&&(p.roughness.value=d.roughness),"metalness"in d&&(p.metalness.value=d.metalness),"envMap"in d&&(p.envMap.value=d.envMap),"envMapIntensity"in d&&(p.envMapIntensity.value=d.envMapIntensity),Object.entries(e.uniforms??{}).forEach(([x,w])=>{p[x]=w!==null&&typeof w=="object"&&"value"in w?w:{value:w}});let g=`${e.header}
${e.vertexHeader??""}
${a}`,v=`${e.header}
${e.fragmentHeader??""}
${o}`;for(const[x,w]of Object.entries(e.vertex??{}))g=g.replace(x,`${x}
${w}`);for(const[x,w]of Object.entries(e.fragment??{}))v=v.replace(x,`${x}
${w}`);return new Ht({defines:{...c},uniforms:p,vertexShader:g,fragmentShader:v,lights:!0,fog:!!((y=e.material)!=null&&y.fog)})}const mp=t=>{const e=t.replace("#",""),i=parseInt(e.substring(0,2),16),a=parseInt(e.substring(2,4),16),o=parseInt(e.substring(4,6),16);return[i/255,a/255,o/255]},vp=`
float random (in vec2 st) {
    return fract(sin(dot(st.xy,
                         vec2(12.9898,78.233)))*
        43758.5453123);
}
float noise (in vec2 st) {
    vec2 i = floor(st);
    vec2 f = fract(st);
    float a = random(i);
    float b = random(i + vec2(1.0, 0.0));
    float c = random(i + vec2(0.0, 1.0));
    float d = random(i + vec2(1.0, 1.0));
    vec2 u = f * f * (3.0 - 2.0 * f);
    return mix(a, b, u.x) +
           (c - a)* u.y * (1.0 - u.x) +
           (d - b) * u.x * u.y;
}
vec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}
vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}
vec3 fade(vec3 t) {return t*t*t*(t*(t*6.0-15.0)+10.0);}
float cnoise(vec3 P){
  vec3 Pi0 = floor(P);
  vec3 Pi1 = Pi0 + vec3(1.0);
  Pi0 = mod(Pi0, 289.0);
  Pi1 = mod(Pi1, 289.0);
  vec3 Pf0 = fract(P);
  vec3 Pf1 = Pf0 - vec3(1.0);
  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
  vec4 iy = vec4(Pi0.yy, Pi1.yy);
  vec4 iz0 = Pi0.zzzz;
  vec4 iz1 = Pi1.zzzz;
  vec4 ixy = permute(permute(ix) + iy);
  vec4 ixy0 = permute(ixy + iz0);
  vec4 ixy1 = permute(ixy + iz1);
  vec4 gx0 = ixy0 / 7.0;
  vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;
  gx0 = fract(gx0);
  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
  vec4 sz0 = step(gz0, vec4(0.0));
  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
  gy0 -= sz0 * (step(0.0, gy0) - 0.5);
  vec4 gx1 = ixy1 / 7.0;
  vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;
  gx1 = fract(gx1);
  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
  vec4 sz1 = step(gz1, vec4(0.0));
  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
  gy1 -= sz1 * (step(0.0, gy1) - 0.5);
  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);
  vec4 norm0 = taylorInvSqrt(vec4(dot(g000,g000),dot(g010,g010),dot(g100,g100),dot(g110,g110)));
  g000 *= norm0.x; g010 *= norm0.y; g100 *= norm0.z; g110 *= norm0.w;
  vec4 norm1 = taylorInvSqrt(vec4(dot(g001,g001),dot(g011,g011),dot(g101,g101),dot(g111,g111)));
  g001 *= norm1.x; g011 *= norm1.y; g101 *= norm1.z; g111 *= norm1.w;
  float n000 = dot(g000, Pf0);
  float n100 = dot(g100, vec3(Pf1.x,Pf0.yz));
  float n010 = dot(g010, vec3(Pf0.x,Pf1.y,Pf0.z));
  float n110 = dot(g110, vec3(Pf1.xy,Pf0.z));
  float n001 = dot(g001, vec3(Pf0.xy,Pf1.z));
  float n101 = dot(g101, vec3(Pf1.x,Pf0.y,Pf1.z));
  float n011 = dot(g011, vec3(Pf0.x,Pf1.yz));
  float n111 = dot(g111, Pf1);
  vec3 fade_xyz = fade(Pf0);
  vec4 n_z = mix(vec4(n000,n100,n010,n110),vec4(n001,n101,n011,n111),fade_xyz.z);
  vec2 n_yz = mix(n_z.xy,n_z.zw,fade_xyz.y);
  float n_xyz = mix(n_yz.x,n_yz.y,fade_xyz.x);
  return 2.2 * n_xyz;
}
`;function gp(t,e,i,a,o){const f=new Wl,c=t*(o+1)*2,p=t*o*2,d=new Float32Array(c*3),g=new Uint32Array(p*3),v=new Float32Array(c*2);let m=0,y=0,x=0;const M=-(t*e+(t-1)*a)/2;for(let R=0;R<t;R++){const E=M+R*(e+a),_=Math.random()*300,b=Math.random()*300;for(let A=0;A<=o;A++){const D=i*(A/o-.5),L=[E,D,0],O=[E+e,D,0];d.set([...L,...O],m*3);const G=A/o;if(v.set([_,G+b,_+1,G+b],x),A<o){const W=m,P=m+1,z=m+2,V=m+3;g.set([W,P,z,z,P,V],y),y+=6}m+=2,x+=4}}return f.setAttribute("position",new jr(d,3)),f.setAttribute("uv",new jr(v,2)),f.setIndex(new jr(g,1)),f.computeVertexNormals(),f}const lc=T.forwardRef(({material:t,width:e,count:i,height:a},o)=>{const f=T.useRef(null);T.useImperativeHandle(o,()=>f.current);const c=T.useMemo(()=>gp(i,e,a,0,100),[i,e,a]);return Wh((p,d)=>{var g,v,m;(m=(v=(g=f.current)==null?void 0:g.material)==null?void 0:v.uniforms)!=null&&m.time&&(f.current.material.uniforms.time.value+=.1*d)}),S.jsx("mesh",{ref:f,geometry:c,material:t})});lc.displayName="MergedPlanes";const ac=T.forwardRef((t,e)=>S.jsx(lc,{ref:e,material:t.material,width:t.width,count:t.count,height:t.height}));ac.displayName="PlaneNoise";const yp=({position:t,color:e})=>{const i=T.useRef(null);return T.useEffect(()=>{var o;if(!i.current)return;const a=(o=i.current.shadow)==null?void 0:o.camera;a&&(a.top=24,a.bottom=-24,a.left=-24,a.right=24,a.far=64,i.current.shadow.bias=-.004)},[]),S.jsx("directionalLight",{ref:i,color:e,intensity:1,position:t})},xp=({position:t,fov:e})=>{const{set:i}=Gh(),a=T.useRef();return T.useEffect(()=>{a.current&&i({camera:a.current})},[i]),S.jsx("perspectiveCamera",{ref:a,position:t,fov:e})},wp=({beamWidth:t=3.7,beamHeight:e=29,beamNumber:i=23,lightColor:a="#e8ceb0",speed:o=2.8,noiseIntensity:f=1.58,scale:c=.38,rotation:p=146})=>{const d=T.useRef(null),g=T.useMemo(()=>pp(Fl,{header:`
  varying vec3 vEye;
  varying float vNoise;
  varying vec2 vUv;
  varying vec3 vPosition;
  uniform float time;
  uniform float uSpeed;
  uniform float uNoiseIntensity;
  uniform float uScale;
  ${vp}`,vertexHeader:`
  float getPos(vec3 pos) {
    vec3 noisePos =
      vec3(pos.x * 0., pos.y - uv.y, pos.z + time * uSpeed * 3.) * uScale;
    return cnoise(noisePos);
  }
  vec3 getCurrentPos(vec3 pos) {
    vec3 newpos = pos;
    newpos.z += getPos(pos);
    return newpos;
  }
  vec3 getNormal(vec3 pos) {
    vec3 curpos = getCurrentPos(pos);
    vec3 nextposX = getCurrentPos(pos + vec3(0.01, 0.0, 0.0));
    vec3 nextposZ = getCurrentPos(pos + vec3(0.0, -0.01, 0.0));
    vec3 tangentX = normalize(nextposX - curpos);
    vec3 tangentZ = normalize(nextposZ - curpos);
    return normalize(cross(tangentZ, tangentX));
  }`,fragmentHeader:"",vertex:{"#include <begin_vertex>":"transformed.z += getPos(transformed.xyz);","#include <beginnormal_vertex>":"objectNormal = getNormal(position.xyz);"},fragment:{"#include <dithering_fragment>":`
    float randomNoise = noise(gl_FragCoord.xy);
    gl_FragColor.rgb -= randomNoise / 15. * uNoiseIntensity;`},material:{fog:!0},uniforms:{diffuse:new or(...mp("#000000")),time:{shared:!0,mixed:!0,linked:!0,value:0},roughness:.3,metalness:.3,uSpeed:{shared:!0,mixed:!0,linked:!0,value:o},envMapIntensity:10,uNoiseIntensity:f,uScale:c}}),[o,f,c]);return S.jsxs(S.Fragment,{children:[S.jsxs("group",{rotation:[0,0,hp(p)],children:[S.jsx(ac,{ref:d,material:g,count:i,width:t,height:e}),S.jsx(yp,{color:a,position:[0,3,10]})]}),S.jsx("ambientLight",{intensity:1}),S.jsx("color",{attach:"background",args:["#000000"]}),S.jsx(xp,{position:[0,0,20],fov:30})]})},Sp=({beamWidth:t=3.7,beamHeight:e=29,beamNumber:i=23,lightColor:a="#e8ceb0",speed:o=2.8,noiseIntensity:f=1.58,scale:c=.38,rotation:p=146,style:d,className:g,frozen:v=!1})=>S.jsx("div",{style:{width:"100%",height:"100%",...d},className:g,children:S.jsx(fp,{dpr:[1,2],frameloop:v?"demand":"always",style:{width:"100%",height:"100%"},camera:{position:[0,0,20],fov:30},gl:{preserveDrawingBuffer:!0},children:S.jsx(wp,{beamWidth:t,beamHeight:e,beamNumber:i,lightColor:a,speed:o,noiseIntensity:f,scale:c,rotation:p})})}),Ep={name:"Beams",nameCn:"",icon:"",description:"",params:[{key:"beamWidth",label:"",type:"range",min:.5,max:5,step:.1,default:3.7},{key:"beamHeight",label:"",type:"range",min:5,max:30,step:1,default:29},{key:"beamNumber",label:"",type:"range",min:4,max:24,step:1,default:23},{key:"speed",label:"",type:"range",min:.5,max:5,step:.1,default:2.8},{key:"noiseIntensity",label:"",type:"range",min:0,max:3,step:.05,default:1.58},{key:"scale",label:"",type:"range",min:.05,max:.5,step:.01,default:.38},{key:"rotation",label:"",type:"range",min:-180,max:180,step:1,default:146},{key:"lightColor",label:"",type:"color",default:"#e8ceb0"}]},Zi=8,Rp=`
  #define MAX_COLORS ${Zi}
  uniform vec2 uCanvas;
  uniform float uTime;
  uniform float uSpeed;
  uniform vec2 uRot;
  uniform int uColorCount;
  uniform vec3 uColors[MAX_COLORS];
  uniform int uTransparent;
  uniform float uScale;
  uniform float uFrequency;
  uniform float uWarpStrength;
  uniform vec2 uPointer;
  uniform float uMouseInfluence;
  uniform float uParallax;
  uniform float uNoise;
  varying vec2 vUv;

  void main() {
    float t = uTime * uSpeed;
    vec2 p = vUv * 2.0 - 1.0;
    p += uPointer * uParallax * 0.1;
    vec2 rp = vec2(p.x * uRot.x - p.y * uRot.y, p.x * uRot.y + p.y * uRot.x);
    vec2 q = vec2(rp.x * (uCanvas.x / uCanvas.y), rp.y);
    q /= max(uScale, 0.0001);
    q /= 0.5 + 0.2 * dot(q, q);
    q += 0.2 * cos(t) - 7.56;
    vec2 toward = (uPointer - rp);
    q += toward * uMouseInfluence * 0.2;

    vec3 col = vec3(0.0);
    float a = 1.0;

    if (uColorCount > 0) {
      vec2 s = q;
      vec3 sumCol = vec3(0.0);
      float cover = 0.0;
      for (int i = 0; i < MAX_COLORS; ++i) {
        if (i >= uColorCount) break;
        s -= 0.01;
        vec2 r = sin(1.5 * (s.yx * uFrequency) + 2.0 * cos(s * uFrequency));
        float m0 = length(r + sin(5.0 * r.y * uFrequency - 3.0 * t + float(i)) / 4.0);
        float kBelow = clamp(uWarpStrength, 0.0, 1.0);
        float kMix = pow(kBelow, 0.3);
        float gain = 1.0 + max(uWarpStrength - 1.0, 0.0);
        vec2 disp = (r - s) * kBelow;
        vec2 warped = s + disp * gain;
        float m1 = length(warped + sin(5.0 * warped.y * uFrequency - 3.0 * t + float(i)) / 4.0);
        float m = mix(m0, m1, kMix);
        float w = 1.0 - exp(-6.0 / exp(6.0 * m));
        sumCol += uColors[i] * w;
        cover = max(cover, w);
      }
      col = clamp(sumCol, 0.0, 1.0);
      a = uTransparent > 0 ? cover : 1.0;
    } else {
      vec2 s = q;
      for (int k = 0; k < 3; ++k) {
        s -= 0.01;
        vec2 r = sin(1.5 * (s.yx * uFrequency) + 2.0 * cos(s * uFrequency));
        float m0 = length(r + sin(5.0 * r.y * uFrequency - 3.0 * t + float(k)) / 4.0);
        float kBelow = clamp(uWarpStrength, 0.0, 1.0);
        float kMix = pow(kBelow, 0.3);
        float gain = 1.0 + max(uWarpStrength - 1.0, 0.0);
        vec2 disp = (r - s) * kBelow;
        vec2 warped = s + disp * gain;
        float m1 = length(warped + sin(5.0 * warped.y * uFrequency - 3.0 * t + float(k)) / 4.0);
        float m = mix(m0, m1, kMix);
        col[k] = 1.0 - exp(-6.0 / exp(6.0 * m));
      }
      a = uTransparent > 0 ? max(max(col.r, col.g), col.b) : 1.0;
    }

    if (uNoise > 0.0001) {
      float n = fract(sin(dot(gl_FragCoord.xy + vec2(uTime), vec2(12.9898, 78.233))) * 43758.5453123);
      col += (n - 0.5) * uNoise;
      col = clamp(col, 0.0, 1.0);
    }

    vec3 rgb = (uTransparent > 0) ? col * a : col;
    gl_FragColor = vec4(rgb, a);
  }
`,Mp=`
  varying vec2 vUv;
  void main() {
    vUv = uv;
    gl_Position = vec4(position, 1.0);
  }
`;function Cp({className:t,style:e,rotation:i=45,speed:a=.2,colors:o=[],transparent:f=!1,autoRotate:c=0,scale:p=1,frequency:d=1,warpStrength:g=1,mouseInfluence:v=1,parallax:m=.5,noise:y=.1,frozen:x=!1}){const w=T.useRef(null),M=T.useRef(null),R=T.useRef(null),E=T.useRef(null),_=T.useRef(null),b=T.useRef(i),A=T.useRef(c),D=T.useRef(new Ce(0,0)),L=T.useRef(new Ce(0,0)),O=T.useRef(8),G=T.useRef(x),W=T.useRef(0);return T.useEffect(()=>{G.current=x},[x]),T.useEffect(()=>{const P=w.current;if(!P)return;const z=new an,V=new Gr(-1,1,1,-1,0,1),X=new Yl(2,2),N=Array.from({length:Zi},()=>new Le(0,0,0)),Z=new Ht({vertexShader:Mp,fragmentShader:Rp,uniforms:{uCanvas:{value:new Ce(1,1)},uTime:{value:0},uSpeed:{value:a},uRot:{value:new Ce(1,0)},uColorCount:{value:0},uColors:{value:N},uTransparent:{value:f?1:0},uScale:{value:p},uFrequency:{value:d},uWarpStrength:{value:g},uPointer:{value:new Ce(0,0)},uMouseInfluence:{value:v},uParallax:{value:m},uNoise:{value:y}},premultipliedAlpha:!0,transparent:!0});E.current=Z;const J=new nt(X,Z);z.add(J);const te=new Wr({antialias:!1,powerPreference:"high-performance",alpha:!0,preserveDrawingBuffer:!0});M.current=te,te.outputColorSpace=Qe,te.setPixelRatio(Math.min(window.devicePixelRatio||1,2)),te.setClearColor(0,f?0:1),te.domElement.style.width="100%",te.domElement.style.height="100%",te.domElement.style.display="block",P.appendChild(te.domElement);const k=new ns,F=()=>{const j=P.clientWidth||1,q=P.clientHeight||1;te.setSize(j,q,!1),Z.uniforms.uCanvas.value.set(j,q)};if(F(),"ResizeObserver"in window){const j=new ResizeObserver(F);j.observe(P),_.current=j}else window.addEventListener("resize",F);const U=()=>{const j=k.getDelta();let q;G.current?q=W.current:(q=k.elapsedTime,W.current=q),Z.uniforms.uTime.value=q;const K=(b.current%360+A.current*q)*Math.PI/180,ie=Math.cos(K),oe=Math.sin(K);Z.uniforms.uRot.value.set(ie,oe);const me=L.current,de=D.current,xe=Math.min(1,j*O.current);me.lerp(de,xe),Z.uniforms.uPointer.value.copy(me),te.render(z,V),R.current=requestAnimationFrame(U)};return R.current=requestAnimationFrame(U),()=>{R.current!==null&&cancelAnimationFrame(R.current),_.current?_.current.disconnect():window.removeEventListener("resize",F),X.dispose(),Z.dispose(),te.dispose(),te.domElement&&te.domElement.parentElement===P&&P.removeChild(te.domElement)}},[d,v,y,m,p,a,f,g]),T.useEffect(()=>{const P=E.current,z=M.current;if(!P)return;b.current=i,A.current=c,P.uniforms.uSpeed.value=a,P.uniforms.uScale.value=p,P.uniforms.uFrequency.value=d,P.uniforms.uWarpStrength.value=g,P.uniforms.uMouseInfluence.value=v,P.uniforms.uParallax.value=m,P.uniforms.uNoise.value=y;const V=N=>{const Z=N.replace("#","").trim(),J=Z.length===3?[parseInt(Z[0]+Z[0],16),parseInt(Z[1]+Z[1],16),parseInt(Z[2]+Z[2],16)]:[parseInt(Z.slice(0,2),16),parseInt(Z.slice(2,4),16),parseInt(Z.slice(4,6),16)];return new Le(J[0]/255,J[1]/255,J[2]/255)},X=(o||[]).filter(Boolean).slice(0,Zi).map(V);for(let N=0;N<Zi;N++){const Z=P.uniforms.uColors.value[N];N<X.length?Z.copy(X[N]):Z.set(0,0,0)}P.uniforms.uColorCount.value=X.length,P.uniforms.uTransparent.value=f?1:0,z&&z.setClearColor(0,f?0:1)},[i,c,a,p,d,g,v,m,y,o,f]),T.useEffect(()=>{const P=E.current,z=w.current;if(!P||!z)return;const V=X=>{const N=z.getBoundingClientRect(),Z=(X.clientX-N.left)/(N.width||1)*2-1,J=-((X.clientY-N.top)/(N.height||1)*2-1);D.current.set(Z,J)};return z.addEventListener("pointermove",V),()=>{z.removeEventListener("pointermove",V)}},[]),S.jsx("div",{ref:w,className:t,style:{width:"100%",height:"100%",...e}})}const _p={name:"ColorBends",nameCn:"",icon:"",description:"",params:[{key:"rotation",label:"",type:"range",min:0,max:360,step:1,default:45},{key:"speed",label:"",type:"range",min:.05,max:1,step:.01,default:.2},{key:"scale",label:"",type:"range",min:.5,max:3,step:.1,default:1},{key:"frequency",label:"",type:"range",min:.5,max:3,step:.1,default:1},{key:"warpStrength",label:"",type:"range",min:0,max:2,step:.1,default:1},{key:"mouseInfluence",label:"",type:"range",min:0,max:2,step:.1,default:1},{key:"parallax",label:"",type:"range",min:0,max:1,step:.1,default:.5},{key:"noise",label:"",type:"range",min:0,max:.5,step:.01,default:.1},{key:"autoRotate",label:"",type:"range",min:0,max:30,step:1,default:0},{key:"colors",label:"",type:"colors",default:["#ff0080","#7928ca","#0070f3","#00d4ff"]}]},Tp=`
  attribute vec2 uv;
  attribute vec2 position;
  varying vec2 vUv;

  void main() {
    vUv = uv;
    gl_Position = vec4(position, 0, 1);
  }
`,bp=`
  precision highp float;

  uniform float uTime;
  uniform vec3 uResolution;
  uniform vec2 uFocal;
  uniform vec2 uRotation;
  uniform float uStarSpeed;
  uniform float uDensity;
  uniform float uHueShift;
  uniform float uSpeed;
  uniform vec2 uMouse;
  uniform float uGlowIntensity;
  uniform float uSaturation;
  uniform bool uMouseRepulsion;
  uniform float uTwinkleIntensity;
  uniform float uRotationSpeed;
  uniform float uRepulsionStrength;
  uniform float uMouseActiveFactor;
  uniform float uAutoCenterRepulsion;
  uniform bool uTransparent;

  varying vec2 vUv;

  #define NUM_LAYER 4.0
  #define STAR_COLOR_CUTOFF 0.2
  #define MAT45 mat2(0.7071, -0.7071, 0.7071, 0.7071)
  #define PERIOD 3.0

  float Hash21(vec2 p) {
    p = fract(p * vec2(123.34, 456.21));
    p += dot(p, p + 45.32);
    return fract(p.x * p.y);
  }

  float tri(float x) {
    return abs(fract(x) * 2.0 - 1.0);
  }

  float tris(float x) {
    float t = fract(x);
    return 1.0 - smoothstep(0.0, 1.0, abs(2.0 * t - 1.0));
  }

  float trisn(float x) {
    float t = fract(x);
    return 2.0 * (1.0 - smoothstep(0.0, 1.0, abs(2.0 * t - 1.0))) - 1.0;
  }

  vec3 hsv2rgb(vec3 c) {
    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);
  }

  float Star(vec2 uv, float flare) {
    float d = length(uv);
    float m = (0.05 * uGlowIntensity) / d;

    float rays = smoothstep(0.0, 1.0, 1.0 - abs(uv.x * uv.y * 1000.0));
    m += rays * flare * uGlowIntensity;

    uv *= MAT45;
    rays = smoothstep(0.0, 1.0, 1.0 - abs(uv.x * uv.y * 1000.0));
    m += rays * 0.3 * flare * uGlowIntensity;

    m *= smoothstep(1.0, 0.2, d);
    return m;
  }

  vec3 StarLayer(vec2 uv) {
    vec3 col = vec3(0.0);
    vec2 gv = fract(uv) - 0.5;
    vec2 id = floor(uv);

    for (int y = -1; y <= 1; y++) {
      for (int x = -1; x <= 1; x++) {
        vec2 offset = vec2(float(x), float(y));
        vec2 si = id + vec2(float(x), float(y));

        float seed = Hash21(si);
        float size = fract(seed * 345.32);
        float glossLocal = tri(uStarSpeed / (PERIOD * seed + 1.0));
        float flareSize = smoothstep(0.9, 1.0, size) * glossLocal;

        float red = smoothstep(STAR_COLOR_CUTOFF, 1.0, Hash21(si + 1.0)) + STAR_COLOR_CUTOFF;
        float blu = smoothstep(STAR_COLOR_CUTOFF, 1.0, Hash21(si + 3.0)) + STAR_COLOR_CUTOFF;
        float grn = min(red, blu) * seed;
        vec3 base = vec3(red, grn, blu);

        float hue = atan(base.g - base.r, base.b - base.r) / (2.0 * 3.14159) + 0.5;
        hue = fract(hue + uHueShift / 360.0);
        float sat = length(base - vec3(dot(base, vec3(0.299, 0.587, 0.114)))) * uSaturation;
        float val = max(max(base.r, base.g), base.b);
        base = hsv2rgb(vec3(hue, sat, val));

        vec2 pad = vec2(tris(seed * 34.0 + uTime * uSpeed / 10.0), tris(seed * 38.0 + uTime * uSpeed / 30.0)) - 0.5;
        float star = Star(gv - offset - pad, flareSize);

        vec3 color = base;
        float twinkle = trisn(uTime * uSpeed + seed * 6.2831) * 0.5 + 1.0;
        twinkle = mix(1.0, twinkle, uTwinkleIntensity);
        star *= twinkle;

        col += star * size * color;
      }
    }
    return col;
  }

  void main() {
    vec2 focalPx = uFocal * uResolution.xy;
    vec2 uv = (vUv * uResolution.xy - focalPx) / uResolution.y;
    vec2 mouseNorm = uMouse - vec2(0.5);

    if (uAutoCenterRepulsion > 0.0) {
      vec2 centerUV = vec2(0.0, 0.0);
      float centerDist = length(uv - centerUV);
      vec2 repulsion = normalize(uv - centerUV) * (uAutoCenterRepulsion / (centerDist + 0.1));
      uv += repulsion * 0.05;
    } else if (uMouseRepulsion) {
      vec2 mousePosUV = (uMouse * uResolution.xy - focalPx) / uResolution.y;
      float mouseDist = length(uv - mousePosUV);
      vec2 repulsion = normalize(uv - mousePosUV) * (uRepulsionStrength / (mouseDist + 0.1));
      uv += repulsion * 0.05 * uMouseActiveFactor;
    } else {
      vec2 mouseOffset = mouseNorm * 0.1 * uMouseActiveFactor;
      uv += mouseOffset;
    }

    float autoRotAngle = uTime * uRotationSpeed;
    mat2 autoRot = mat2(cos(autoRotAngle), -sin(autoRotAngle), sin(autoRotAngle), cos(autoRotAngle));
    uv = autoRot * uv;
    uv = mat2(uRotation.x, -uRotation.y, uRotation.y, uRotation.x) * uv;

    vec3 col = vec3(0.0);
    for (float i = 0.0; i < 1.0; i += 1.0 / NUM_LAYER) {
      float depth = fract(i + uStarSpeed * uSpeed);
      float scale = mix(20.0 * uDensity, 0.5 * uDensity, depth);
      float fade = depth * smoothstep(1.0, 0.9, depth);
      col += StarLayer(uv * scale + i * 453.32) * fade;
    }

    if (uTransparent) {
      float alpha = length(col);
      alpha = smoothstep(0.0, 0.3, alpha);
      alpha = min(alpha, 1.0);
      gl_FragColor = vec4(col, alpha);
    } else {
      gl_FragColor = vec4(col, 1.0);
    }
  }
`;function Pp({focal:t=[.5,.5],rotation:e=[1,0],starSpeed:i=.5,density:a=1,hueShift:o=140,disableAnimation:f=!1,speed:c=1,mouseInteraction:p=!0,glowIntensity:d=.3,saturation:g=0,mouseRepulsion:v=!0,repulsionStrength:m=2,twinkleIntensity:y=.3,rotationSpeed:x=.1,autoCenterRepulsion:w=0,transparent:M=!1,style:R,className:E,..._}){const b=T.useRef(null),A=T.useRef({x:.5,y:.5}),D=T.useRef({x:.5,y:.5}),L=T.useRef(0),O=T.useRef(0);return T.useEffect(()=>{if(!b.current)return;const G=b.current,W=new dr({alpha:M,premultipliedAlpha:!1,preserveDrawingBuffer:!0}),P=W.gl;M?(P.enable(P.BLEND),P.blendFunc(P.SRC_ALPHA,P.ONE_MINUS_SRC_ALPHA),P.clearColor(0,0,0,0)):P.clearColor(0,0,0,1);let z;function V(){W.setSize(G.offsetWidth*1,G.offsetHeight*1),z&&(z.uniforms.uResolution.value=new $i(P.canvas.width,P.canvas.height,P.canvas.width/P.canvas.height))}window.addEventListener("resize",V,!1),V();const X=new pr(P);z=new fr(P,{vertex:Tp,fragment:bp,uniforms:{uTime:{value:0},uResolution:{value:new $i(P.canvas.width,P.canvas.height,P.canvas.width/P.canvas.height)},uFocal:{value:new Float32Array(t)},uRotation:{value:new Float32Array(e)},uStarSpeed:{value:i},uDensity:{value:a},uHueShift:{value:o},uSpeed:{value:c},uMouse:{value:new Float32Array([D.current.x,D.current.y])},uGlowIntensity:{value:d},uSaturation:{value:g},uMouseRepulsion:{value:v},uTwinkleIntensity:{value:y},uRotationSpeed:{value:x},uRepulsionStrength:{value:m},uMouseActiveFactor:{value:0},uAutoCenterRepulsion:{value:w},uTransparent:{value:M}}});const N=new hr(P,{geometry:X,program:z});let Z;function J(F){Z=requestAnimationFrame(J),f||(z.uniforms.uTime.value=F*.001,z.uniforms.uStarSpeed.value=F*.001*i/10);const U=.05;D.current.x+=(A.current.x-D.current.x)*U,D.current.y+=(A.current.y-D.current.y)*U,O.current+=(L.current-O.current)*U,z.uniforms.uMouse.value[0]=D.current.x,z.uniforms.uMouse.value[1]=D.current.y,z.uniforms.uMouseActiveFactor.value=O.current,W.render({scene:N})}Z=requestAnimationFrame(J),G.appendChild(P.canvas);function te(F){const U=G.getBoundingClientRect(),j=(F.clientX-U.left)/U.width,q=1-(F.clientY-U.top)/U.height;A.current={x:j,y:q},L.current=1}function k(){L.current=0}return p&&(G.addEventListener("mousemove",te),G.addEventListener("mouseleave",k)),()=>{var F;cancelAnimationFrame(Z),window.removeEventListener("resize",V),p&&(G.removeEventListener("mousemove",te),G.removeEventListener("mouseleave",k)),P.canvas.parentElement===G&&G.removeChild(P.canvas),(F=P.getExtension("WEBGL_lose_context"))==null||F.loseContext()}},[t,e,i,a,o,f,c,p,d,g,v,y,x,m,w,M]),S.jsx("div",{ref:b,className:E,style:{width:"100%",height:"100%",...R},..._})}const kp={name:"Galaxy",nameCn:"",icon:"",description:"",params:[{key:"density",label:"",type:"range",min:.5,max:3,step:.1,default:1},{key:"speed",label:"",type:"range",min:.1,max:3,step:.1,default:1},{key:"starSpeed",label:"",type:"range",min:.1,max:2,step:.1,default:.5},{key:"glowIntensity",label:"",type:"range",min:.1,max:1,step:.05,default:.3},{key:"twinkleIntensity",label:"",type:"range",min:0,max:1,step:.1,default:.3},{key:"rotationSpeed",label:"",type:"range",min:0,max:.5,step:.01,default:.1},{key:"hueShift",label:"",type:"range",min:0,max:360,step:1,default:140},{key:"saturation",label:"",type:"range",min:0,max:1,step:.1,default:0},{key:"repulsionStrength",label:"",type:"range",min:0,max:5,step:.1,default:2},{key:"mouseRepulsion",label:"",type:"switch",default:!0},{key:"mouseInteraction",label:"",type:"switch",default:!0}]},qi=8,zp=t=>{const e=t.replace("#","").padEnd(6,"0"),i=parseInt(e.slice(0,2),16)/255,a=parseInt(e.slice(2,4),16)/255,o=parseInt(e.slice(4,6),16)/255;return[i,a,o]},Ap=t=>{const e=(t&&t.length?t:["#FF9FFC","#5227FF"]).slice(0,qi);for(e.length===1&&e.push(e[0]);e.length<qi;)e.push(e[e.length-1]);const i=[];for(let o=0;o<qi;o++)i.push(zp(e[o]));const a=Math.max(2,Math.min(qi,(t==null?void 0:t.length)??2));return{arr:i,count:a}},Np=({className:t,style:e,dpr:i,paused:a=!1,frozen:o=!1,gradientColors:f,angle:c=0,noise:p=.3,blindCount:d=16,blindMinWidth:g=60,mouseDampening:v=.15,mirrorGradient:m=!1,spotlightRadius:y=.5,spotlightSoftness:x=1,spotlightOpacity:w=1,distortAmount:M=0,shineDirection:R="left",mixBlendMode:E="lighten",blurAmount:_=0})=>{const b=T.useRef(null),A=T.useRef(null),D=T.useRef(null),L=T.useRef(null),O=T.useRef(null),G=T.useRef(null),W=T.useRef([0,0]),P=T.useRef(0),z=T.useRef(!0),V=T.useRef(o);return T.useEffect(()=>{V.current=o},[o]),T.useEffect(()=>{const X=b.current;if(!X)return;const N=new dr({dpr:i??(typeof window<"u"&&window.devicePixelRatio||1),alpha:!0,antialias:!0,preserveDrawingBuffer:!0});G.current=N;const Z=N.gl,J=Z.canvas;J.style.width="100%",J.style.height="100%",J.style.display="block",X.appendChild(J);const te=`
      attribute vec2 position;
      attribute vec2 uv;
      varying vec2 vUv;
      void main() {
        vUv = uv;
        gl_Position = vec4(position, 0.0, 1.0);
      }
    `,k=`
      #ifdef GL_ES
      precision mediump float;
      #endif
      uniform vec3 iResolution;
      uniform vec2 iMouse;
      uniform float iTime;
      uniform float uAngle;
      uniform float uNoise;
      uniform float uBlindCount;
      uniform float uSpotlightRadius;
      uniform float uSpotlightSoftness;
      uniform float uSpotlightOpacity;
      uniform float uMirror;
      uniform float uDistort;
      uniform float uShineFlip;
      uniform vec3 uColor0;
      uniform vec3 uColor1;
      uniform vec3 uColor2;
      uniform vec3 uColor3;
      uniform vec3 uColor4;
      uniform vec3 uColor5;
      uniform vec3 uColor6;
      uniform vec3 uColor7;
      uniform int uColorCount;
      varying vec2 vUv;

      float rand(vec2 co){
        return fract(sin(dot(co, vec2(12.9898,78.233))) * 43758.5453);
      }

      vec2 rotate2D(vec2 p, float a){
        float c = cos(a);
        float s = sin(a);
        return mat2(c, -s, s, c) * p;
      }

      vec3 getGradientColor(float t){
        float tt = clamp(t, 0.0, 1.0);
        int count = uColorCount;
        if (count < 2) count = 2;
        float scaled = tt * float(count - 1);
        float seg = floor(scaled);
        float f = fract(scaled);

        if (seg < 1.0) return mix(uColor0, uColor1, f);
        if (seg < 2.0 && count > 2) return mix(uColor1, uColor2, f);
        if (seg < 3.0 && count > 3) return mix(uColor2, uColor3, f);
        if (seg < 4.0 && count > 4) return mix(uColor3, uColor4, f);
        if (seg < 5.0 && count > 5) return mix(uColor4, uColor5, f);
        if (seg < 6.0 && count > 6) return mix(uColor5, uColor6, f);
        if (seg < 7.0 && count > 7) return mix(uColor6, uColor7, f);
        if (count > 7) return uColor7;
        if (count > 6) return uColor6;
        if (count > 5) return uColor5;
        if (count > 4) return uColor4;
        if (count > 3) return uColor3;
        if (count > 2) return uColor2;
        return uColor1;
      }

      void mainImage( out vec4 fragColor, in vec2 fragCoord ) {
        vec2 uv0 = fragCoord.xy / iResolution.xy;
        float aspect = iResolution.x / iResolution.y;
        vec2 p = uv0 * 2.0 - 1.0;
        p.x *= aspect;
        vec2 pr = rotate2D(p, uAngle);
        pr.x /= aspect;
        vec2 uv = pr * 0.5 + 0.5;

        vec2 uvMod = uv;
        if (uDistort > 0.0) {
            float a = uvMod.y * 6.0;
            float b = uvMod.x * 6.0;
            float w = 0.01 * uDistort;
            uvMod.x += sin(a) * w;
            uvMod.y += cos(b) * w;
        }

        float t = uvMod.x;
        if (uMirror > 0.5) {
            t = 1.0 - abs(1.0 - 2.0 * fract(t));
        }

        vec3 base = getGradientColor(t);

        vec2 offset = vec2(iMouse.x/iResolution.x, iMouse.y/iResolution.y);
        float d = length(uv0 - offset);
        float r = max(uSpotlightRadius, 1e-4);
        float dn = d / r;
        float spot = (1.0 - 2.0 * pow(dn, uSpotlightSoftness)) * uSpotlightOpacity;
        vec3 cir = vec3(spot);

        float stripe = fract(uvMod.x * max(uBlindCount, 1.0));
        if (uShineFlip > 0.5) stripe = 1.0 - stripe;
        vec3 ran = vec3(stripe);

        vec3 col = cir + base - ran;
        col += (rand(gl_FragCoord.xy + iTime) - 0.5) * uNoise;

        fragColor = vec4(col, 1.0);
      }

      void main() {
        vec4 color;
        mainImage(color, vUv * iResolution.xy);
        gl_FragColor = color;
      }
    `,{arr:F,count:U}=Ap(f),j={iResolution:{value:[Z.drawingBufferWidth,Z.drawingBufferHeight,1]},iMouse:{value:[0,0]},iTime:{value:0},uAngle:{value:c*Math.PI/180},uNoise:{value:p},uBlindCount:{value:Math.max(1,d)},uSpotlightRadius:{value:y},uSpotlightSoftness:{value:x},uSpotlightOpacity:{value:w},uMirror:{value:m?1:0},uDistort:{value:M},uShineFlip:{value:R==="right"?1:0},uColor0:{value:F[0]},uColor1:{value:F[1]},uColor2:{value:F[2]},uColor3:{value:F[3]},uColor4:{value:F[4]},uColor5:{value:F[5]},uColor6:{value:F[6]},uColor7:{value:F[7]},uColorCount:{value:U}},q=new fr(Z,{vertex:te,fragment:k,uniforms:j});D.current=q;const $=new pr(Z);O.current=$;const K=new hr(Z,{geometry:$,program:q});L.current=K;const ie=()=>{const xe=X.getBoundingClientRect();if(N.setSize(xe.width,xe.height),j.iResolution.value=[Z.drawingBufferWidth,Z.drawingBufferHeight,1],g&&g>0){const he=Math.max(1,Math.floor(xe.width/g)),ae=d?Math.min(d,he):he;j.uBlindCount.value=Math.max(1,ae)}else j.uBlindCount.value=Math.max(1,d);if(z.current){z.current=!1;const he=Z.drawingBufferWidth/2,ae=Z.drawingBufferHeight/2;j.iMouse.value=[he,ae],W.current=[he,ae]}};ie();const oe=new ResizeObserver(ie);oe.observe(X);const me=xe=>{if(V.current)return;const he=J.getBoundingClientRect(),ae=N.dpr||1,we=(xe.clientX-he.left)*ae,ue=(he.height-(xe.clientY-he.top))*ae;W.current=[we,ue],v<=0&&(j.iMouse.value=[we,ue])};J.addEventListener("pointermove",me);const de=xe=>{if(A.current=requestAnimationFrame(de),V.current){if(!a&&D.current&&L.current)try{N.render({scene:L.current})}catch(he){console.error(he)}return}if(j.iTime.value=xe*.001,v>0){P.current||(P.current=xe);const he=(xe-P.current)/1e3;P.current=xe;const ae=Math.max(1e-4,v);let we=1-Math.exp(-he/ae);we>1&&(we=1);const ue=W.current,Se=j.iMouse.value;Se[0]+=(ue[0]-Se[0])*we,Se[1]+=(ue[1]-Se[1])*we}else P.current=xe;if(!a&&D.current&&L.current)try{N.render({scene:L.current})}catch(he){console.error(he)}};return A.current=requestAnimationFrame(de),()=>{A.current&&cancelAnimationFrame(A.current),J.removeEventListener("pointermove",me),oe.disconnect(),J.parentElement===X&&X.removeChild(J)}},[i,a,f,c,p,d,g,v,m,y,x,w,M,R]),S.jsx("div",{ref:b,className:t,style:{width:"100%",height:"100%",mixBlendMode:E,filter:_>0?`blur(${_}px)`:"none",transition:"filter 0.15s ease-out",...e}})},Ip={name:"GradientBlinds",nameCn:"",icon:"",description:"",params:[{key:"angle",label:"",type:"range",min:0,max:360,step:1,default:0},{key:"blindCount",label:"",type:"range",min:4,max:32,step:1,default:16},{key:"blurAmount",label:"",type:"range",min:0,max:50,step:1,default:0,excludeFromRandom:!0},{key:"noise",label:"",type:"range",min:0,max:1,step:.01,default:.3},{key:"spotlightRadius",label:"",type:"range",min:.1,max:2,step:.1,default:.5},{key:"spotlightSoftness",label:"",type:"range",min:.1,max:3,step:.1,default:1},{key:"spotlightOpacity",label:"",type:"range",min:0,max:2,step:.1,default:1},{key:"distortAmount",label:"",type:"range",min:0,max:10,step:.5,default:0},{key:"mouseDampening",label:"",type:"range",min:0,max:.5,step:.01,default:.15},{key:"mirrorGradient",label:"",type:"switch",default:!1},{key:"gradientColors",label:"",type:"colors",default:["#FF9FFC","#5227FF"]}]},Lp="#ffffff",wu=t=>{const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?[parseInt(e[1],16)/255,parseInt(e[2],16)/255,parseInt(e[3],16)/255]:[1,1,1]},Su=(t,e,i)=>{switch(t){case"top-left":return{anchor:[0,-.2*i],dir:[0,1]};case"top-right":return{anchor:[e,-.2*i],dir:[0,1]};case"left":return{anchor:[-.2*e,.5*i],dir:[1,0]};case"right":return{anchor:[(1+.2)*e,.5*i],dir:[-1,0]};case"bottom-left":return{anchor:[0,(1+.2)*i],dir:[0,-1]};case"bottom-center":return{anchor:[.5*e,(1+.2)*i],dir:[0,-1]};case"bottom-right":return{anchor:[e,(1+.2)*i],dir:[0,-1]};default:return{anchor:[.5*e,-.2*i],dir:[0,1]}}},Fp=({raysOrigin:t="top-center",raysColor:e=Lp,raysSpeed:i=1,lightSpread:a=1,rayLength:o=2,pulsating:f=!1,fadeDistance:c=1,saturation:p=1,followMouse:d=!0,mouseInfluence:g=.1,noiseAmount:v=0,distortion:m=0,className:y="",style:x})=>{const w=T.useRef(null),M=T.useRef(null),R=T.useRef(null),E=T.useRef({x:.5,y:.5}),_=T.useRef({x:.5,y:.5}),b=T.useRef(null),A=T.useRef(null),D=T.useRef(null),[L,O]=T.useState(!0),G=T.useRef(null);return T.useEffect(()=>{if(w.current)return G.current=new IntersectionObserver(W=>{const P=W[0];O(P.isIntersecting)},{threshold:.1}),G.current.observe(w.current),()=>{G.current&&(G.current.disconnect(),G.current=null)}},[]),T.useEffect(()=>!L||!w.current?void 0:(D.current&&(D.current(),D.current=null),(async()=>{if(!w.current||(await new Promise(U=>setTimeout(U,10)),!w.current))return;const P=new dr({dpr:Math.min(window.devicePixelRatio,2),alpha:!0,preserveDrawingBuffer:!0});R.current=P;const z=P.gl;for(z.canvas.style.width="100%",z.canvas.style.height="100%";w.current.firstChild;)w.current.removeChild(w.current.firstChild);w.current.appendChild(z.canvas);const V=`
        attribute vec2 position;
        varying vec2 vUv;
        void main() {
          vUv = position * 0.5 + 0.5;
          gl_Position = vec4(position, 0.0, 1.0);
        }
      `,X=`
        precision highp float;
        uniform float iTime;
        uniform vec2 iResolution;
        uniform vec2 rayPos;
        uniform vec2 rayDir;
        uniform vec3 raysColor;
        uniform float raysSpeed;
        uniform float lightSpread;
        uniform float rayLength;
        uniform float pulsating;
        uniform float fadeDistance;
        uniform float saturation;
        uniform vec2 mousePos;
        uniform float mouseInfluence;
        uniform float noiseAmount;
        uniform float distortion;
        varying vec2 vUv;

        float noise(vec2 st) {
            return fract(sin(dot(st.xy, vec2(12.9898,78.233))) * 43758.5453123);
        }

        float rayStrength(vec2 raySource, vec2 rayRefDirection, vec2 coord, float seedA, float seedB, float speed) {
            vec2 sourceToCoord = coord - raySource;
            vec2 dirNorm = normalize(sourceToCoord);
            float cosAngle = dot(dirNorm, rayRefDirection);
            float distortedAngle = cosAngle + distortion * sin(iTime * 2.0 + length(sourceToCoord) * 0.01) * 0.2;
            float spreadFactor = pow(max(distortedAngle, 0.0), 1.0 / max(lightSpread, 0.001));
            float distance = length(sourceToCoord);
            float maxDistance = iResolution.x * rayLength;
            float lengthFalloff = clamp((maxDistance - distance) / maxDistance, 0.0, 1.0);
            float fadeFalloff = clamp((iResolution.x * fadeDistance - distance) / (iResolution.x * fadeDistance), 0.5, 1.0);
            float pulse = pulsating > 0.5 ? (0.8 + 0.2 * sin(iTime * speed * 3.0)) : 1.0;
            float baseStrength = clamp(
                (0.45 + 0.15 * sin(distortedAngle * seedA + iTime * speed)) +
                (0.3 + 0.2 * cos(-distortedAngle * seedB + iTime * speed)),
                0.0, 1.0
            );
            return baseStrength * lengthFalloff * fadeFalloff * spreadFactor * pulse;
        }

        void mainImage(out vec4 fragColor, in vec2 fragCoord) {
            vec2 coord = vec2(fragCoord.x, iResolution.y - fragCoord.y);
            vec2 finalRayDir = rayDir;

            if (mouseInfluence > 0.0) {
                vec2 mouseScreenPos = mousePos * iResolution.xy;
                vec2 mouseDirection = normalize(mouseScreenPos - rayPos);
                finalRayDir = normalize(mix(rayDir, mouseDirection, mouseInfluence));
            }

            vec4 rays1 = vec4(1.0) * rayStrength(rayPos, finalRayDir, coord, 36.2214, 21.11349, 1.5 * raysSpeed);
            vec4 rays2 = vec4(1.0) * rayStrength(rayPos, finalRayDir, coord, 22.3991, 18.0234, 1.1 * raysSpeed);

            fragColor = rays1 * 0.5 + rays2 * 0.4;

            if (noiseAmount > 0.0) {
                float n = noise(coord * 0.01 + iTime * 0.1);
                fragColor.rgb *= (1.0 - noiseAmount + noiseAmount * n);
            }

            float brightness = 1.0 - (coord.y / iResolution.y);
            fragColor.x *= 0.1 + brightness * 0.8;
            fragColor.y *= 0.3 + brightness * 0.6;
            fragColor.z *= 0.5 + brightness * 0.5;

            if (saturation != 1.0) {
                float gray = dot(fragColor.rgb, vec3(0.299, 0.587, 0.114));
                fragColor.rgb = mix(vec3(gray), fragColor.rgb, saturation);
            }

            fragColor.rgb *= raysColor;
        }

        void main() {
            vec4 color;
            mainImage(color, gl_FragCoord.xy);
            gl_FragColor = color;
        }
      `,N={iTime:{value:0},iResolution:{value:[1,1]},rayPos:{value:[0,0]},rayDir:{value:[0,1]},raysColor:{value:wu(e)},raysSpeed:{value:i},lightSpread:{value:a},rayLength:{value:o},pulsating:{value:f?1:0},fadeDistance:{value:c},saturation:{value:p},mousePos:{value:[.5,.5]},mouseInfluence:{value:g},noiseAmount:{value:v},distortion:{value:m}};M.current=N;const Z=new pr(z),J=new fr(z,{vertex:V,fragment:X,uniforms:N}),te=new hr(z,{geometry:Z,program:J});A.current=te;const k=()=>{if(!w.current||!P)return;P.dpr=Math.min(window.devicePixelRatio,2);const{clientWidth:U,clientHeight:j}=w.current;P.setSize(U,j);const q=P.dpr,$=U*q,K=j*q;N.iResolution.value=[$,K];const{anchor:ie,dir:oe}=Su(t,$,K);N.rayPos.value=ie,N.rayDir.value=oe},F=U=>{if(!(!R.current||!M.current||!A.current)){N.iTime.value=U*.001,d&&g>0&&(_.current.x=_.current.x*.92+E.current.x*(1-.92),_.current.y=_.current.y*.92+E.current.y*(1-.92),N.mousePos.value=[_.current.x,_.current.y]);try{P.render({scene:te}),b.current=requestAnimationFrame(F)}catch(j){console.warn("WebGL rendering error:",j);return}}};window.addEventListener("resize",k),k(),b.current=requestAnimationFrame(F),D.current=()=>{if(b.current&&(cancelAnimationFrame(b.current),b.current=null),window.removeEventListener("resize",k),P)try{const U=P.gl.canvas,j=P.gl.getExtension("WEBGL_lose_context");j&&j.loseContext(),U&&U.parentNode&&U.parentNode.removeChild(U)}catch(U){console.warn("Error during WebGL cleanup:",U)}R.current=null,M.current=null,A.current=null}})(),()=>{D.current&&(D.current(),D.current=null)}),[L,t,e,i,a,o,f,c,p,d,g,v,m]),T.useEffect(()=>{if(!M.current||!w.current||!R.current)return;const W=M.current,P=R.current;W.raysColor.value=wu(e),W.raysSpeed.value=i,W.lightSpread.value=a,W.rayLength.value=o,W.pulsating.value=f?1:0,W.fadeDistance.value=c,W.saturation.value=p,W.mouseInfluence.value=g,W.noiseAmount.value=v,W.distortion.value=m;const{clientWidth:z,clientHeight:V}=w.current,X=P.dpr,{anchor:N,dir:Z}=Su(t,z*X,V*X);W.rayPos.value=N,W.rayDir.value=Z},[e,i,a,t,o,f,c,p,g,v,m]),T.useEffect(()=>{const W=P=>{if(!w.current||!R.current)return;const z=w.current.getBoundingClientRect(),V=(P.clientX-z.left)/z.width,X=(P.clientY-z.top)/z.height;E.current={x:V,y:X}};if(d)return window.addEventListener("mousemove",W),()=>window.removeEventListener("mousemove",W)},[d]),S.jsx("div",{ref:w,className:y,style:{width:"100%",height:"100%",...x}})},Bp={name:"LightRays",nameCn:"",icon:"",description:"",params:[{key:"raysOrigin",label:"",type:"select",options:[{value:"top-center",label:""},{value:"top-left",label:""},{value:"top-right",label:""},{value:"left",label:""},{value:"right",label:""},{value:"bottom-left",label:""},{value:"bottom-center",label:""},{value:"bottom-right",label:""}],default:"top-center"},{key:"raysSpeed",label:"",type:"range",min:.1,max:3,step:.1,default:1},{key:"lightSpread",label:"",type:"range",min:.1,max:3,step:.1,default:1},{key:"rayLength",label:"",type:"range",min:.5,max:5,step:.1,default:2},{key:"fadeDistance",label:"",type:"range",min:.5,max:3,step:.1,default:1},{key:"saturation",label:"",type:"range",min:0,max:2,step:.1,default:1},{key:"mouseInfluence",label:"",type:"range",min:0,max:.5,step:.01,default:.1},{key:"noiseAmount",label:"",type:"range",min:0,max:1,step:.01,default:0},{key:"distortion",label:"",type:"range",min:0,max:1,step:.01,default:0},{key:"pulsating",label:"",type:"switch",default:!1},{key:"followMouse",label:"",type:"switch",default:!0},{key:"raysColor",label:"",type:"color",default:"#ffffff"}]},Up=`
precision highp float;

void main() {
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,Dp=`
precision highp float;

uniform float iTime;
uniform vec3  iResolution;
uniform float animationSpeed;

uniform bool enableTop;
uniform bool enableMiddle;
uniform bool enableBottom;

uniform int topLineCount;
uniform int middleLineCount;
uniform int bottomLineCount;

uniform float topLineDistance;
uniform float middleLineDistance;
uniform float bottomLineDistance;

uniform vec3 topWavePosition;
uniform vec3 middleWavePosition;
uniform vec3 bottomWavePosition;

uniform vec2 iMouse;
uniform bool interactive;
uniform float bendRadius;
uniform float bendStrength;
uniform float bendInfluence;

uniform bool parallax;
uniform float parallaxStrength;
uniform vec2 parallaxOffset;

uniform vec3 lineGradient[8];
uniform int lineGradientCount;

const vec3 BLACK = vec3(0.0);
const vec3 PINK  = vec3(233.0, 71.0, 245.0) / 255.0;
const vec3 BLUE  = vec3(47.0,  75.0, 162.0) / 255.0;

mat2 rotate(float r) {
  return mat2(cos(r), sin(r), -sin(r), cos(r));
}

vec3 background_color(vec2 uv) {
  vec3 col = vec3(0.0);

  float y = sin(uv.x - 0.2) * 0.3 - 0.1;
  float m = uv.y - y;

  col += mix(BLUE, BLACK, smoothstep(0.0, 1.0, abs(m)));
  col += mix(PINK, BLACK, smoothstep(0.0, 1.0, abs(m - 0.8)));
  return col * 0.5;
}

vec3 getLineColor(float t, vec3 baseColor) {
  if (lineGradientCount <= 0) {
    return baseColor;
  }

  vec3 gradientColor;
  
  if (lineGradientCount == 1) {
    gradientColor = lineGradient[0];
  } else {
    float clampedT = clamp(t, 0.0, 0.9999);
    float scaled = clampedT * float(lineGradientCount - 1);
    int idx = int(floor(scaled));
    float f = fract(scaled);
    int idx2 = min(idx + 1, lineGradientCount - 1);

    vec3 c1 = lineGradient[idx];
    vec3 c2 = lineGradient[idx2];
    
    gradientColor = mix(c1, c2, f);
  }
  
  return gradientColor * 0.5;
}

float wave(vec2 uv, float offset, vec2 screenUv, vec2 mouseUv, bool shouldBend) {
  float time = iTime * animationSpeed;

  float x_offset   = offset;
  float x_movement = time * 0.1;
  float amp        = sin(offset + time * 0.2) * 0.3;
  float y          = sin(uv.x + x_offset + x_movement) * amp;

  if (shouldBend) {
    vec2 d = screenUv - mouseUv;
    float influence = exp(-dot(d, d) * bendRadius);
    float bendOffset = (mouseUv.y - screenUv.y) * influence * bendStrength * bendInfluence;
    y += bendOffset;
  }

  float m = uv.y - y;
  return 0.0175 / max(abs(m) + 0.01, 1e-3) + 0.01;
}

void mainImage(out vec4 fragColor, in vec2 fragCoord) {
  vec2 baseUv = (2.0 * fragCoord - iResolution.xy) / iResolution.y;
  baseUv.y *= -1.0;
  
  if (parallax) {
    baseUv += parallaxOffset;
  }

  vec3 col = vec3(0.0);

  vec3 b = lineGradientCount > 0 ? vec3(0.0) : background_color(baseUv);

  vec2 mouseUv = vec2(0.0);
  if (interactive) {
    mouseUv = (2.0 * iMouse - iResolution.xy) / iResolution.y;
    mouseUv.y *= -1.0;
  }
  
  if (enableBottom) {
    for (int i = 0; i < bottomLineCount; ++i) {
      float fi = float(i);
      float t = fi / max(float(bottomLineCount - 1), 1.0);
      vec3 lineCol = getLineColor(t, b);
      
      float angle = bottomWavePosition.z * log(length(baseUv) + 1.0);
      vec2 ruv = baseUv * rotate(angle);
      col += lineCol * wave(
        ruv + vec2(bottomLineDistance * fi + bottomWavePosition.x, bottomWavePosition.y),
        1.5 + 0.2 * fi,
        baseUv,
        mouseUv,
        interactive
      ) * 0.2;
    }
  }

  if (enableMiddle) {
    for (int i = 0; i < middleLineCount; ++i) {
      float fi = float(i);
      float t = fi / max(float(middleLineCount - 1), 1.0);
      vec3 lineCol = getLineColor(t, b);
      
      float angle = middleWavePosition.z * log(length(baseUv) + 1.0);
      vec2 ruv = baseUv * rotate(angle);
      col += lineCol * wave(
        ruv + vec2(middleLineDistance * fi + middleWavePosition.x, middleWavePosition.y),
        2.0 + 0.15 * fi,
        baseUv,
        mouseUv,
        interactive
      );
    }
  }

  if (enableTop) {
    for (int i = 0; i < topLineCount; ++i) {
      float fi = float(i);
      float t = fi / max(float(topLineCount - 1), 1.0);
      vec3 lineCol = getLineColor(t, b);
      
      float angle = topWavePosition.z * log(length(baseUv) + 1.0);
      vec2 ruv = baseUv * rotate(angle);
      ruv.x *= -1.0;
      col += lineCol * wave(
        ruv + vec2(topLineDistance * fi + topWavePosition.x, topWavePosition.y),
        1.0 + 0.2 * fi,
        baseUv,
        mouseUv,
        interactive
      ) * 0.1;
    }
  }

  fragColor = vec4(col, 1.0);
}

void main() {
  vec4 color = vec4(0.0);
  mainImage(color, gl_FragCoord.xy);
  gl_FragColor = color;
}
`,Eu=8;function Op(t){let e=t.trim();e.startsWith("#")&&(e=e.slice(1));let i=255,a=255,o=255;return e.length===3?(i=parseInt(e[0]+e[0],16),a=parseInt(e[1]+e[1],16),o=parseInt(e[2]+e[2],16)):e.length===6&&(i=parseInt(e.slice(0,2),16),a=parseInt(e.slice(2,4),16),o=parseInt(e.slice(4,6),16)),new Le(i/255,a/255,o/255)}const jp=({linesGradient:t=["#e947f5","#2f4ba2","#00ffff"],enabledWaves:e=["top","middle","bottom"],lineCount:i=6,lineDistance:a=5,topWavePosition:o={x:10,y:.5,rotate:-.4},middleWavePosition:f={x:5,y:0,rotate:.2},bottomWavePosition:c={x:2,y:-.7,rotate:.4},animationSpeed:p=1,interactive:d=!0,bendRadius:g=5,bendStrength:v=-.5,mouseDamping:m=.05,parallax:y=!0,parallaxStrength:x=.2,frozen:w=!1})=>{const M=T.useRef(null),R=T.useRef(new Ce(-1e3,-1e3)),E=T.useRef(new Ce(-1e3,-1e3)),_=T.useRef(0),b=T.useRef(0),A=T.useRef(new Ce(0,0)),D=T.useRef(new Ce(0,0)),L=T.useRef(w),O=T.useRef(0);T.useEffect(()=>{L.current=w},[w]);const G=J=>{if(typeof i=="number")return i;if(!e.includes(J))return 0;const te=e.indexOf(J);return i[te]??6},W=J=>{if(typeof a=="number")return a;if(!e.includes(J))return .1;const te=e.indexOf(J);return a[te]??.1},P=e.includes("top")?G("top"):0,z=e.includes("middle")?G("middle"):0,V=e.includes("bottom")?G("bottom"):0,X=e.includes("top")?W("top")*.01:.01,N=e.includes("middle")?W("middle")*.01:.01,Z=e.includes("bottom")?W("bottom")*.01:.01;return T.useEffect(()=>{if(!M.current)return;const J=new an,te=new Gr(-1,1,1,-1,0,1);te.position.z=1;const k=new Wr({antialias:!0,alpha:!1});k.setPixelRatio(Math.min(window.devicePixelRatio||1,2)),k.domElement.style.width="100%",k.domElement.style.height="100%",M.current.appendChild(k.domElement);const F={iTime:{value:0},iResolution:{value:new Le(1,1,1)},animationSpeed:{value:p},enableTop:{value:e.includes("top")},enableMiddle:{value:e.includes("middle")},enableBottom:{value:e.includes("bottom")},topLineCount:{value:P},middleLineCount:{value:z},bottomLineCount:{value:V},topLineDistance:{value:X},middleLineDistance:{value:N},bottomLineDistance:{value:Z},topWavePosition:{value:new Le((o==null?void 0:o.x)??10,(o==null?void 0:o.y)??.5,(o==null?void 0:o.rotate)??-.4)},middleWavePosition:{value:new Le((f==null?void 0:f.x)??5,(f==null?void 0:f.y)??0,(f==null?void 0:f.rotate)??.2)},bottomWavePosition:{value:new Le((c==null?void 0:c.x)??2,(c==null?void 0:c.y)??-.7,(c==null?void 0:c.rotate)??.4)},iMouse:{value:new Ce(-1e3,-1e3)},interactive:{value:d},bendRadius:{value:g},bendStrength:{value:v},bendInfluence:{value:0},parallax:{value:y},parallaxStrength:{value:x},parallaxOffset:{value:new Ce(0,0)},lineGradient:{value:Array.from({length:Eu},()=>new Le(1,1,1))},lineGradientCount:{value:0}};if(t&&t.length>0){const he=t.slice(0,Eu);F.lineGradientCount.value=he.length,he.forEach((ae,we)=>{const ue=Op(ae);F.lineGradient.value[we].set(ue.x,ue.y,ue.z)})}const U=new Ht({uniforms:F,vertexShader:Up,fragmentShader:Dp}),j=new Yl(2,2),q=new nt(j,U);J.add(q);const $=new ns,K=()=>{const he=M.current;if(!he)return;const ae=he.clientWidth||1,we=he.clientHeight||1;k.setSize(ae,we,!1);const ue=k.domElement.width,Se=k.domElement.height;F.iResolution.value.set(ue,Se,1)};K();const ie=typeof ResizeObserver<"u"?new ResizeObserver(K):null;ie&&M.current&&ie.observe(M.current);const oe=he=>{const ae=k.domElement.getBoundingClientRect(),we=he.clientX-ae.left,ue=he.clientY-ae.top,Se=k.getPixelRatio();if(R.current.set(we*Se,(ae.height-ue)*Se),_.current=1,y){const ve=ae.width/2,se=ae.height/2,ze=(we-ve)/ae.width,De=-(ue-se)/ae.height;A.current.set(ze*x,De*x)}},me=()=>{_.current=0};d&&(k.domElement.addEventListener("pointermove",oe),k.domElement.addEventListener("pointerleave",me));let de=0;const xe=()=>{L.current||(O.current=$.getElapsedTime()),F.iTime.value=O.current,d&&(E.current.lerp(R.current,m),F.iMouse.value.copy(E.current),b.current+=(_.current-b.current)*m,F.bendInfluence.value=b.current),y&&(D.current.lerp(A.current,m),F.parallaxOffset.value.copy(D.current)),k.render(J,te),de=requestAnimationFrame(xe)};return xe(),()=>{cancelAnimationFrame(de),ie&&M.current&&ie.disconnect(),d&&(k.domElement.removeEventListener("pointermove",oe),k.domElement.removeEventListener("pointerleave",me)),j.dispose(),U.dispose(),k.dispose(),k.domElement.parentElement&&k.domElement.parentElement.removeChild(k.domElement)}},[t,e,i,a,o,f,c,p,d,g,v,m,y,x,P,z,V,X,N,Z]),S.jsx("div",{ref:M,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"hidden"}})},Hp={name:"LaserFlow",nameCn:"",icon:"",description:"",params:[{key:"lineCount",label:"",type:"range",min:2,max:15,step:1,default:6},{key:"lineDistance",label:"",type:"range",min:1,max:20,step:1,default:5},{key:"animationSpeed",label:"",type:"range",min:.1,max:3,step:.1,default:1},{key:"bendRadius",label:"",type:"range",min:1,max:20,step:.5,default:5},{key:"bendStrength",label:"",type:"range",min:-2,max:2,step:.1,default:-.5},{key:"mouseDamping",label:"",type:"range",min:.01,max:.2,step:.01,default:.05},{key:"parallaxStrength",label:"",type:"range",min:0,max:1,step:.05,default:.2},{key:"interactive",label:"",type:"toggle",default:!0},{key:"parallax",label:"",type:"toggle",default:!0},{key:"linesGradient",label:"",type:"colors",default:["#e947f5","#2f4ba2","#00ffff"]}]},Gp=`#version 300 es
in vec2 position;
in vec2 uv;
out vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = vec4(position, 0.0, 1.0);
}
`,Wp=`#version 300 es
precision highp float;
precision highp int;

out vec4 fragColor;

uniform vec2 uResolution;
uniform float uTime;
uniform float uIntensity;
uniform float uCycleDuration;
uniform int uAnimType;
uniform vec2 uMouse;
uniform int uColorCount;
uniform float uDistort;
uniform vec2 uOffset;
uniform sampler2D uGradient;
uniform float uNoiseAmount;
uniform int uRayCount;

#define PI 3.14159265359
#define TWO_PI 6.28318530718

float hash21(vec2 p){
  p = floor(p);
  float f = 52.9829189 * fract(dot(p, vec2(0.065, 0.005)));
  return fract(f);
}

mat2 rot30(){
  return mat2(0.8, -0.5, 0.5, 0.8);
}

float layeredNoise(vec2 fragPx){
  vec2 p = mod(fragPx + vec2(uTime * 30.0, -uTime * 21.0), 1024.0);
  vec2 q = rot30() * p;
  float n = 0.0;
  n += 0.40 * hash21(q);
  n += 0.25 * hash21(q * 2.0 + 17.0);
  n += 0.20 * hash21(q * 4.0 + 47.0);
  n += 0.10 * hash21(q * 8.0 + 113.0);
  n += 0.05 * hash21(q * 16.0 + 191.0);
  return n;
}

vec3 rayDir(vec2 frag, vec2 res, vec2 offset, float dist){
  float focal = res.y * max(dist, 1e-3);
  return normalize(vec3(2.0 * (frag - offset) - res, focal));
}

float edgeFade(vec2 frag, vec2 res, vec2 offset){
  vec2 toC = frag - 0.5 * res - offset;
  float r = length(toC) / (0.5 * min(res.x, res.y));
  float x = clamp(r, 0.0, 1.0);
  float q = x * x * x * (x * (x * 6.0 - 15.0) + 10.0);
  float s = q * 0.5;
  s = pow(s, 1.5);
  float tail = 1.0 - pow(1.0 - s, 2.0);
  s = mix(s, tail, 0.2);
  float dn = (layeredNoise(frag * 0.15) - 0.5) * 0.0015 * s;
  return clamp(s + dn, 0.0, 1.0);
}

mat3 rotX(float a){
  float c = cos(a), s = sin(a);
  return mat3(1.0,0.0,0.0, 0.0,c,-s, 0.0,s,c);
}

mat3 rotY(float a){
  float c = cos(a), s = sin(a);
  return mat3(c,0.0,s, 0.0,1.0,0.0, -s,0.0,c);
}

mat3 rotZ(float a){
  float c = cos(a), s = sin(a);
  return mat3(c,-s,0.0, s,c,0.0, 0.0,0.0,1.0);
}

vec3 sampleGradient(float t){
  t = clamp(t, 0.0, 1.0);
  return texture(uGradient, vec2(t, 0.5)).rgb;
}

vec2 rot2(vec2 v, float a){
  float s = sin(a), c = cos(a);
  return mat2(c, -s, s, c) * v;
}

float bendAngle(vec3 q, float t){
  // 
  float a = 0.8 * sin(q.x * 0.55 + t * 1.0) + 0.7 * sin(q.y * 0.50 - t * 2.0) + 0.6 * sin(q.z * 0.60 + t * 3.0);
  return a;
}

void main(){
  vec2 frag = gl_FragCoord.xy;
  
  // 
  float cycleDur = max(uCycleDuration, 1.0);
  float baseFreq = TWO_PI / cycleDur;
  float phase = uTime * baseFreq;
  
  // 
  float t = phase;
  float jitterAmp = 0.1 * clamp(uNoiseAmount, 0.0, 1.0);

  vec3 dir = rayDir(frag, uResolution, uOffset, 1.0);

  float marchT = 0.0;
  vec3 col = vec3(0.0);
  float n = layeredNoise(frag);

  vec4 c = cos(t * 1.0 + vec4(0.0, 33.0, 11.0, 0.0));
  mat2 M2 = mat2(c.x, c.y, c.z, c.w);

  float amp = clamp(uDistort, 0.0, 50.0) * 0.15;

  mat3 rot3dMat = mat3(1.0);
  if(uAnimType == 1){
    // 
    vec3 ang = vec3(t * 1.0, t * 2.0, t * 3.0);
    rot3dMat = rotZ(ang.z) * rotY(ang.y) * rotX(ang.x);
  }

  mat3 hoverMat = mat3(1.0);
  if(uAnimType == 2){
    vec2 m = uMouse * 2.0 - 1.0;
    vec3 ang = vec3(m.y * 0.6, m.x * 0.6, 0.0);
    hoverMat = rotY(ang.y) * rotX(ang.x);
  }

  for (int i = 0; i < 44; ++i) {
    vec3 P = marchT * dir;
    P.z -= 2.0;
    float rad = length(P);
    vec3 Pl = P * (10.0 / max(rad, 1e-6));

    if(uAnimType == 0){
      Pl.xz *= M2;
    } else if(uAnimType == 1){
      Pl = rot3dMat * Pl;
    } else {
      Pl = hoverMat * Pl;
    }

    float stepLen = min(rad - 0.3, n * jitterAmp) + 0.1;
    float grow = smoothstep(0.35, 3.0, marchT);

    float a1 = amp * grow * bendAngle(Pl * 0.6, t);
    float a2 = 0.5 * amp * grow * bendAngle(Pl.zyx * 0.5 + 3.1, t * 0.9);

    vec3 Pb = Pl;
    Pb.xz = rot2(Pb.xz, a1);
    Pb.xy = rot2(Pb.xy, a2);

    float rayPattern = smoothstep(
      0.5, 0.7,
      sin(Pb.x + cos(Pb.y) * cos(Pb.z)) * sin(Pb.z + sin(Pb.y) * cos(Pb.x + t))
    );

    if (uRayCount > 0) {
      float ang = atan(Pb.y, Pb.x);
      float comb = 0.5 + 0.5 * cos(float(uRayCount) * ang);
      comb = pow(comb, 3.0);
      rayPattern *= smoothstep(0.15, 0.95, comb);
    }

    vec3 spectralDefault = 1.0 + vec3(
      cos(marchT * 3.0 + 0.0),
      cos(marchT * 3.0 + 1.0),
      cos(marchT * 3.0 + 2.0)
    );

    float saw = fract(marchT * 0.25);
    float tRay = saw * saw * (3.0 - 2.0 * saw);
    vec3 userGradient = 2.0 * sampleGradient(tRay);

    vec3 spectral = (uColorCount > 0) ? userGradient : spectralDefault;

    vec3 base = (0.05 / (0.4 + stepLen)) * smoothstep(5.0, 0.0, rad) * spectral;
    col += base * rayPattern;

    marchT += stepLen;
  }

  col *= edgeFade(frag, uResolution, uOffset);
  col *= uIntensity;
  fragColor = vec4(clamp(col, 0.0, 1.0), 1.0);
}
`,Vp=t=>{let e=t.trim();if(e.startsWith("#")&&(e=e.slice(1)),e.length===3){const c=e[0],p=e[1],d=e[2];e=c+c+p+p+d+d}const i=parseInt(e,16);if(isNaN(i)||e.length!==6&&e.length!==8)return[1,1,1];const a=(i>>16&255)/255,o=(i>>8&255)/255,f=(i&255)/255;return[a,o,f]},Ru=t=>{if(t==null)return 0;if(typeof t=="number")return t;const e=String(t).trim(),i=parseFloat(e.replace("px",""));return isNaN(i)?0:i},Xp=({intensity:t=2,cycleDuration:e=60,animationType:i="rotate3d",colors:a,distort:o=0,paused:f=!1,frozen:c=!1,offset:p={x:0,y:0},hoverDampness:d=0,rayCount:g,noiseAmount:v=.8,mixBlendMode:m="lighten",style:y,className:x})=>{const w=f||c,M=T.useRef(null),R=T.useRef(null),E=T.useRef(null),_=T.useRef([.5,.5]),b=T.useRef([.5,.5]),A=T.useRef(w),D=T.useRef(null),L=T.useRef(d),O=T.useRef(!0),G=T.useRef(null),W=T.useRef(null);return T.useEffect(()=>{A.current=w},[w]),T.useEffect(()=>{L.current=d},[d]),T.useEffect(()=>{const P=M.current;if(!P)return;const z=Math.min(window.devicePixelRatio||1,2),V=new dr({dpr:z,alpha:!1,antialias:!1,preserveDrawingBuffer:!0});E.current=V;const X=V.gl;X.canvas.style.position="absolute",X.canvas.style.inset="0",X.canvas.style.width="100%",X.canvas.style.height="100%",X.canvas.style.mixBlendMode=m&&m!=="none"?m:"",P.appendChild(X.canvas);const N=new Uint8Array([255,255,255,255]),Z=new dh(X,{image:N,width:1,height:1,generateMipmaps:!1,flipY:!1});Z.minFilter=X.LINEAR,Z.magFilter=X.LINEAR,Z.wrapS=X.CLAMP_TO_EDGE,Z.wrapT=X.CLAMP_TO_EDGE,D.current=Z;const J=new fr(X,{vertex:Gp,fragment:Wp,uniforms:{uResolution:{value:[1,1]},uTime:{value:0},uIntensity:{value:1},uCycleDuration:{value:60},uAnimType:{value:0},uMouse:{value:[.5,.5]},uColorCount:{value:0},uDistort:{value:0},uOffset:{value:[0,0]},uGradient:{value:Z},uNoiseAmount:{value:.8},uRayCount:{value:0}}});R.current=J;const te=new pr(X),k=new hr(X,{geometry:te,program:J});W.current=te,G.current=k;const F=()=>{const me=P.clientWidth||1,de=P.clientHeight||1;V.setSize(me,de),J.uniforms.uResolution.value=[X.drawingBufferWidth,X.drawingBufferHeight]};let U=null;"ResizeObserver"in window?(U=new ResizeObserver(F),U.observe(P)):window.addEventListener("resize",F),F();const j=me=>{const de=P.getBoundingClientRect(),xe=(me.clientX-de.left)/Math.max(de.width,1),he=(me.clientY-de.top)/Math.max(de.height,1);_.current=[Math.min(Math.max(xe,0),1),Math.min(Math.max(he,0),1)]};P.addEventListener("pointermove",j,{passive:!0});let q=null;"IntersectionObserver"in window&&(q=new IntersectionObserver(me=>{me[0]&&(O.current=me[0].isIntersecting)},{root:null,threshold:.01}),q.observe(P));let $=0,K=performance.now(),ie=0;const oe=me=>{const de=Math.max(0,me-K)*.001;K=me;const xe=O.current&&!document.hidden;if(A.current||(ie+=de),!xe){$=requestAnimationFrame(oe);return}const he=.02+Math.max(0,Math.min(1,L.current))*.5,ae=1-Math.exp(-de/he),we=_.current,ue=b.current;ue[0]+=(we[0]-ue[0])*ae,ue[1]+=(we[1]-ue[1])*ae,J.uniforms.uMouse.value=ue,J.uniforms.uTime.value=ie,V.render({scene:G.current}),$=requestAnimationFrame(oe)};return $=requestAnimationFrame(oe),()=>{cancelAnimationFrame($),P.removeEventListener("pointermove",j),U==null||U.disconnect(),U||window.removeEventListener("resize",F),q==null||q.disconnect();try{P.removeChild(X.canvas)}catch{console.warn("Canvas already removed")}R.current=null,E.current=null,D.current=null,G.current=null,W.current=null}},[m]),T.useEffect(()=>{var z,V;const P=(V=(z=E.current)==null?void 0:z.gl)==null?void 0:V.canvas;P&&(P.style.mixBlendMode=m&&m!=="none"?m:"")},[m]),T.useEffect(()=>{const P=R.current,z=E.current,V=D.current;if(!P||!z||!V)return;P.uniforms.uIntensity.value=t??1,P.uniforms.uCycleDuration.value=e??10;const X={rotate:0,rotate3d:1,hover:2};P.uniforms.uAnimType.value=X[i??"rotate"],P.uniforms.uDistort.value=typeof o=="number"?o:0;const N=Ru(p==null?void 0:p.x),Z=Ru(p==null?void 0:p.y);P.uniforms.uOffset.value=[N,Z],P.uniforms.uRayCount.value=Math.max(0,Math.floor(g??0)),P.uniforms.uNoiseAmount.value=typeof v=="number"?v:.8;let J=0;if(Array.isArray(a)&&a.length>0){const te=z.gl,k=a.slice(0,64);J=k.length;const F=new Uint8Array(J*4);for(let U=0;U<J;U++){const[j,q,$]=Vp(k[U]);F[U*4+0]=Math.round(j*255),F[U*4+1]=Math.round(q*255),F[U*4+2]=Math.round($*255),F[U*4+3]=255}V.image=F,V.width=J,V.height=1,V.minFilter=te.LINEAR,V.magFilter=te.LINEAR,V.wrapS=te.CLAMP_TO_EDGE,V.wrapT=te.CLAMP_TO_EDGE,V.flipY=!1,V.generateMipmaps=!1,V.format=te.RGBA,V.type=te.UNSIGNED_BYTE,V.needsUpdate=!0}else J=0;P.uniforms.uColorCount.value=J},[t,e,i,a,o,p,g,v]),S.jsx("div",{ref:M,className:x,style:{width:"100%",height:"100%",position:"relative",...y}})},Yp={name:"PrismaticBurst",nameCn:"",icon:"",description:"",params:[{key:"intensity",label:"",type:"range",min:.5,max:5,step:.1,default:2.7},{key:"cycleDuration",label:"()",type:"range",min:30,max:120,step:5,default:50,hint:""},{key:"distort",label:"",type:"range",min:0,max:20,step:1,default:1},{key:"rayCount",label:"",type:"range",min:0,max:12,step:1,default:5},{key:"noiseAmount",label:"",type:"range",min:0,max:1,step:.05,default:.49},{key:"hoverDampness",label:"",type:"range",min:0,max:1,step:.1,default:.9},{key:"animationType",label:"",type:"select",options:[{value:"rotate",label:""},{value:"rotate3d",label:"3D"},{value:"hover",label:""}],default:"rotate"},{key:"colors",label:"",type:"colors",default:["#b55c51","#ac557c","#350aec","#9bd931"]}]};class qp extends an{constructor(){super();const e=new kf;e.deleteAttribute("uv");const i=new Fl({side:Or}),a=new Fl,o=new Au(16777215,900,28,2);o.position.set(.418,16.199,.3),this.add(o);const f=new nt(e,i);f.position.set(-.757,13.219,.717),f.scale.set(31.713,28.305,28.591),this.add(f);const c=new nt(e,a);c.position.set(-10.906,2.009,1.846),c.rotation.set(0,-.195,0),c.scale.set(2.328,7.905,4.651),this.add(c);const p=new nt(e,a);p.position.set(-5.607,-.754,-.758),p.rotation.set(0,.994,0),p.scale.set(1.97,1.534,3.955),this.add(p);const d=new nt(e,a);d.position.set(6.167,.857,7.803),d.rotation.set(0,.561,0),d.scale.set(3.927,6.285,3.687),this.add(d);const g=new nt(e,a);g.position.set(-2.017,.018,6.124),g.rotation.set(0,.333,0),g.scale.set(2.002,4.566,2.064),this.add(g);const v=new nt(e,a);v.position.set(2.291,-.756,-2.621),v.rotation.set(0,-.286,0),v.scale.set(1.546,1.552,1.496),this.add(v);const m=new nt(e,a);m.position.set(-2.193,-.369,-5.547),m.rotation.set(0,.516,0),m.scale.set(3.875,3.487,2.986),this.add(m);const y=new nt(e,ir(50));y.position.set(-16.116,14.37,8.208),y.scale.set(.1,2.428,2.739),this.add(y);const x=new nt(e,ir(50));x.position.set(-16.109,18.021,-8.207),x.scale.set(.1,2.425,2.751),this.add(x);const w=new nt(e,ir(17));w.position.set(14.904,12.198,-1.832),w.scale.set(.15,4.265,6.331),this.add(w);const M=new nt(e,ir(43));M.position.set(-.462,8.89,14.52),M.scale.set(4.38,5.441,.088),this.add(M);const R=new nt(e,ir(20));R.position.set(3.235,11.486,-12.541),R.scale.set(2.5,2,.1),this.add(R);const E=new nt(e,ir(100));E.position.set(0,20,0),E.scale.set(1,.1,1),this.add(E)}dispose(){const e=new Set;this.traverse(i=>{i.isMesh&&(e.add(i.geometry),e.add(i.material))});for(const i of e)i.dispose()}}function ir(t){const e=new zf;return e.color.setScalar(t),e}class Qp{constructor(e){this.config=e,this.positionData=new Float32Array(3*e.count).fill(0),this.velocityData=new Float32Array(3*e.count).fill(0),this.sizeData=new Float32Array(e.count).fill(1),this.center=new Le,this.initPositions(),this.setSizes()}initPositions(){const{config:e,positionData:i}=this;this.center.toArray(i,0);for(let a=1;a<e.count;a++){const o=3*a;i[o]=(Math.random()-.5)*2*e.maxX,i[o+1]=(Math.random()-.5)*2*e.maxY,i[o+2]=(Math.random()-.5)*2*e.maxZ}}setSizes(){const{config:e,sizeData:i}=this;i[0]=e.size0;for(let a=1;a<e.count;a++)i[a]=e.minSize+Math.random()*(e.maxSize-e.minSize)}update(e){const{config:i,center:a,positionData:o,sizeData:f,velocityData:c}=this;let p=i.controlSphere0?1:0;i.controlSphere0&&(new Le().fromArray(o,0).lerp(a,.1).toArray(o,0),c[0]=c[1]=c[2]=0);for(let x=p;x<i.count;x++){const w=3*x;c[w+1]-=e*i.gravity*f[x];const M=i.buoyancy*(1/f[x])*.5;c[w+1]+=e*M,c[w]*=i.friction,c[w+1]*=i.friction,c[w+2]*=i.friction;const R=new Le(c[w],c[w+1],c[w+2]);R.clampLength(0,i.maxVelocity),c[w]=R.x,c[w+1]=R.y,c[w+2]=R.z,o[w]+=c[w],o[w+1]+=c[w+1],o[w+2]+=c[w+2]}const d=new Le,g=new Le,v=new Le,m=new Le,y=new Le;for(let x=p;x<i.count;x++){const w=3*x;d.fromArray(o,w),g.fromArray(c,w);const M=f[x];for(let R=x+1;R<i.count;R++){const E=3*R;v.fromArray(o,E),m.fromArray(c,E);const _=f[R];y.copy(v).sub(d);const b=y.length(),A=M+_;if(b<A){const D=A-b,L=y.normalize().multiplyScalar(.5*D);d.sub(L),g.sub(L.clone().multiplyScalar(Math.max(g.length(),1))),d.toArray(o,w),g.toArray(c,w),v.add(L),m.add(L.clone().multiplyScalar(Math.max(m.length(),1))),v.toArray(o,E),m.toArray(c,E)}}if(i.controlSphere0&&x!==0){const R=new Le().fromArray(o,0);y.copy(R).sub(d);const E=y.length(),_=M+f[0];if(E<_){const b=_-E,A=y.normalize().multiplyScalar(b);d.sub(A),g.sub(A.clone().multiplyScalar(Math.max(g.length(),2)))}}Math.abs(d.x)+M>i.maxX&&(d.x=Math.sign(d.x)*(i.maxX-M),g.x*=-i.wallBounce),i.gravity===0?Math.abs(d.y)+M>i.maxY&&(d.y=Math.sign(d.y)*(i.maxY-M),g.y*=-i.wallBounce):d.y-M<-i.maxY&&(d.y=-i.maxY+M,g.y*=-i.wallBounce),Math.abs(d.z)+M>i.maxZ&&(d.z=Math.sign(d.z)*(i.maxZ-M),g.z*=-i.wallBounce),d.toArray(o,w),g.toArray(c,w)}}}function Zp(t){const e=t.map(i=>new or(i));return{getColorAt(i,a=new or){const o=Math.max(0,Math.min(1,i))*(t.length-1),f=Math.floor(o),c=e[f];if(f>=t.length-1)return c.clone();const p=o-f,d=e[f+1];return a.r=c.r+p*(d.r-c.r),a.g=c.g+p*(d.g-c.g),a.b=c.b+p*(d.b-c.b),a}}}const Kp={count:299,colors:["#6db76c","#1586f1","#124ab6"],ambientColor:16777215,ambientIntensity:1,lightIntensity:100,minSize:.4,maxSize:.8,size0:1,gravity:.61,buoyancy:0,friction:.9934,wallBounce:.96,maxVelocity:.15,maxX:5,maxY:5,maxZ:2,controlSphere0:!1,followCursor:!0},Jp=({count:t=299,colors:e=["#6db76c","#1586f1","#124ab6"],gravity:i=.61,buoyancy:a=0,friction:o=.9934,wallBounce:f=.96,followCursor:c=!0,minSize:p=.4,maxSize:d=.8})=>{const g=T.useRef(null),v=T.useRef(null);return T.useEffect(()=>{const m=g.current;if(!m)return;const y={...Kp,count:t,colors:e,gravity:i,buoyancy:a,friction:o,wallBounce:f,followCursor:c,minSize:p,maxSize:d},x=new Wr({canvas:m,antialias:!0,alpha:!0,preserveDrawingBuffer:!0});x.setSize(m.parentElement.offsetWidth,m.parentElement.offsetHeight),x.setPixelRatio(Math.min(window.devicePixelRatio,2)),x.toneMapping=zu,x.outputColorSpace=Qe;const w=new an,M=new Gl(45,m.parentElement.offsetWidth/m.parentElement.offsetHeight,.1,1e3);M.position.set(0,0,20),M.lookAt(0,0,0);const E=new Af(x).fromScene(new qp).texture,_=new Nf(1,32,32),b=new If({envMap:E,metalness:.1,roughness:.2,clearcoat:1,clearcoatRoughness:.1,transmission:.1}),A=new Lf(_,b,y.count);w.add(A);const D=new Qp(y),L=Zp(y.colors.map(U=>U));for(let U=0;U<y.count;U++)A.setColorAt(U,L.getColorAt(U/y.count));A.instanceColor.needsUpdate=!0;const O=new Ff(y.ambientColor,y.ambientIntensity);w.add(O);const G=new Au(y.colors[0],y.lightIntensity);w.add(G);const W=new Pu,P=new Bf(new Le(0,0,1),0),z=new Ce,V=new Le,X=U=>{if(!y.followCursor)return;const j=m.getBoundingClientRect();z.x=(U.clientX-j.left)/j.width*2-1,z.y=-((U.clientY-j.top)/j.height)*2+1,W.setFromCamera(z,M),M.getWorldDirection(P.normal),W.ray.intersectPlane(P,V),D.center.copy(V),y.controlSphere0=!0},N=()=>{y.controlSphere0=!1};m.addEventListener("mousemove",X),m.addEventListener("mouseleave",N);const Z=new ns,J=new Uf;let te;const k=()=>{te=requestAnimationFrame(k);const U=Z.getDelta();D.update(U);for(let j=0;j<y.count;j++)J.position.fromArray(D.positionData,3*j),j===0&&!y.followCursor?J.scale.setScalar(0):J.scale.setScalar(D.sizeData[j]),J.updateMatrix(),A.setMatrixAt(j,J.matrix),j===0&&G.position.copy(J.position);A.instanceMatrix.needsUpdate=!0,x.render(w,M)};k();const F=()=>{const U=m.parentElement.offsetWidth,j=m.parentElement.offsetHeight;M.aspect=U/j,M.updateProjectionMatrix(),x.setSize(U,j);const q=M.fov*Math.PI/180,$=2*Math.tan(q/2)*M.position.z,K=$*M.aspect;y.maxX=K/2,y.maxY=$/2};return window.addEventListener("resize",F),F(),v.current={renderer:x,scene:w,camera:M,mesh:A,physics:D},()=>{cancelAnimationFrame(te),window.removeEventListener("resize",F),m.removeEventListener("mousemove",X),m.removeEventListener("mouseleave",N),_.dispose(),b.dispose(),E.dispose(),x.dispose()}},[t,e,i,a,o,f,c,p,d]),S.jsx("canvas",{ref:g,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"block"}})},$p={name:"Ballpit",nameCn:"",icon:"",description:"3D (Three.js)",params:[{key:"count",label:"",type:"range",min:20,max:400,step:10,default:60},{key:"minSize",label:"",type:"range",min:.1,max:1,step:.1,default:.2},{key:"maxSize",label:"",type:"range",min:.5,max:2,step:.1,default:1.4},{key:"gravity",label:"",type:"range",min:0,max:1,step:.01,default:0},{key:"buoyancy",label:"",type:"range",min:0,max:2,step:.05,default:.05},{key:"friction",label:"",type:"range",min:.95,max:1,step:1e-4,default:.9554},{key:"wallBounce",label:"",type:"range",min:.5,max:1,step:.01,default:.83},{key:"followCursor",label:"",type:"toggle",default:!1},{key:"colors",label:"",type:"colors",default:["#f7980f","#0e4909","#d560d9"]}]},e0=({gridSize:t=30,dotSize:e=2,dotColor:i="#6366f1",rippleColor:a="#a855f7",rippleIntensity:o=.2,rippleSpeed:f=2,rippleRadius:c=200,mouseInteraction:p=!0,autoRipple:d=!0,autoRippleInterval:g=2e3})=>{const v=T.useRef(null),m=T.useRef(null),y=T.useRef({x:null,y:null}),x=T.useRef([]),w=T.useRef(0);return T.useEffect(()=>{const M=v.current,R=M.getContext("2d");let E,_;const b=()=>{E=M.offsetWidth,_=M.offsetHeight,M.width=E*window.devicePixelRatio,M.height=_*window.devicePixelRatio,R.scale(window.devicePixelRatio,window.devicePixelRatio)},A=P=>{if(!p)return;const z=M.getBoundingClientRect();y.current={x:P.clientX-z.left,y:P.clientY-z.top}},D=()=>{y.current={x:null,y:null}},L=P=>{if(!p)return;const z=M.getBoundingClientRect(),V=P.clientX-z.left,X=P.clientY-z.top;O(V,X)},O=(P,z)=>{x.current.push({x:P,y:z,radius:0,maxRadius:c,opacity:1})};b(),window.addEventListener("resize",b),M.addEventListener("mousemove",A),M.addEventListener("mouseleave",D),M.addEventListener("click",L);let G=0;const W=P=>{if(R.clearRect(0,0,E,_),G+=.016,d&&P-w.current>g){const X=Math.random()*E,N=Math.random()*_;O(X,N),w.current=P}x.current=x.current.filter(X=>(X.radius+=f*2,X.opacity=1-X.radius/X.maxRadius,X.opacity>0));const z=Math.ceil(E/t)+1,V=Math.ceil(_/t)+1;for(let X=0;X<V;X++)for(let N=0;N<z;N++){const Z=N*t,J=X*t;let te=0,k=0,F=1,U=0;if(x.current.forEach(ae=>{const we=Z-ae.x,ue=J-ae.y,Se=Math.sqrt(we*we+ue*ue);if(Se<ae.radius+50&&Se>ae.radius-50){const ve=Math.sin((Se-ae.radius)*.1)*ae.opacity,se=o*ve;Se>0&&(te+=we/Se*se*20,k+=ue/Se*se*20),F+=Math.abs(ve)*.5,U+=ae.opacity*(1-Math.abs(Se-ae.radius)/50)}}),y.current.x!==null){const ae=Z-y.current.x,we=J-y.current.y,ue=Math.sqrt(ae*ae+we*we),Se=150;if(ue<Se){const ve=(1-ue/Se)*o;ue>0&&(te+=ae/ue*ve*15,k+=we/ue*ve*15),F+=ve*.8,U+=ve}}const j=Math.sin(G*2+N*.3+X*.3)*o*3,q=Z+te,$=J+k+j,K=e*Math.max(.5,Math.min(2.5,F)),ie=Dr(i),oe=Dr(a),me=Math.min(1,U),de=Math.round(ie.r+(oe.r-ie.r)*me),xe=Math.round(ie.g+(oe.g-ie.g)*me),he=Math.round(ie.b+(oe.b-ie.b)*me);if(R.beginPath(),R.arc(q,$,K,0,Math.PI*2),R.fillStyle=`rgba(${de}, ${xe}, ${he}, ${.6+me*.4})`,R.fill(),U>.2){R.beginPath(),R.arc(q,$,K*2,0,Math.PI*2);const ae=R.createRadialGradient(q,$,0,q,$,K*2);ae.addColorStop(0,`rgba(${oe.r}, ${oe.g}, ${oe.b}, ${U*.3})`),ae.addColorStop(1,"rgba(0, 0, 0, 0)"),R.fillStyle=ae,R.fill()}}x.current.forEach(X=>{R.beginPath(),R.arc(X.x,X.y,X.radius,0,Math.PI*2),R.strokeStyle=`rgba(${Dr(a).r}, ${Dr(a).g}, ${Dr(a).b}, ${X.opacity*.3})`,R.lineWidth=2,R.stroke()}),m.current=requestAnimationFrame(W)};return m.current=requestAnimationFrame(W),()=>{window.removeEventListener("resize",b),M.removeEventListener("mousemove",A),M.removeEventListener("mouseleave",D),M.removeEventListener("click",L),cancelAnimationFrame(m.current)}},[t,e,i,a,o,f,c,p,d,g]),S.jsx("canvas",{ref:v,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"}})};function Dr(t){const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:{r:99,g:102,b:241}}const t0={name:"RippleGrid",nameCn:"",icon:"",description:"",params:[{key:"gridSize",label:"",type:"range",min:15,max:60,step:5,default:30},{key:"dotSize",label:"",type:"range",min:1,max:6,step:.5,default:2},{key:"rippleIntensity",label:"",type:"range",min:.05,max:.5,step:.05,default:.2},{key:"rippleSpeed",label:"",type:"range",min:.5,max:5,step:.5,default:2},{key:"rippleRadius",label:"",type:"range",min:100,max:400,step:50,default:200},{key:"autoRippleInterval",label:"(ms)",type:"range",min:500,max:5e3,step:500,default:2e3},{key:"mouseInteraction",label:"",type:"toggle",default:!0},{key:"autoRipple",label:"",type:"toggle",default:!0},{key:"dotColor",label:"",type:"color",default:"#6366f1"},{key:"rippleColor",label:"",type:"color",default:"#a855f7"}]};/**
 * postprocessing v6.38.2 build Mon Dec 22 2025
 * https://github.com/pmndrs/postprocessing
 * Copyright 2015-2025 Raoul van Rschen
 * @license Zlib
 */var Nl=1/1e3,n0=1e3,r0=class{constructor(){this.startTime=performance.now(),this.previousTime=0,this.currentTime=0,this._delta=0,this._elapsed=0,this._fixedDelta=1e3/60,this.timescale=1,this.useFixedDelta=!1,this._autoReset=!1}get autoReset(){return this._autoReset}set autoReset(t){typeof document<"u"&&document.hidden!==void 0&&(t?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this._autoReset=t)}get delta(){return this._delta*Nl}get fixedDelta(){return this._fixedDelta*Nl}set fixedDelta(t){this._fixedDelta=t*n0}get elapsed(){return this._elapsed*Nl}update(t){this.useFixedDelta?this._delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=(t!==void 0?t:performance.now())-this.startTime,this._delta=this.currentTime-this.previousTime),this._delta*=this.timescale,this._elapsed+=this._delta}reset(){this._delta=0,this._elapsed=0,this.currentTime=performance.now()-this.startTime}getDelta(){return this.delta}getElapsed(){return this.elapsed}handleEvent(t){document.hidden||(this.currentTime=performance.now()-this.startTime)}dispose(){this.autoReset=!1}},i0=(()=>{const t=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),e=new Float32Array([0,0,2,0,0,2]),i=new Wl;return i.setAttribute("position",new jr(t,3)),i.setAttribute("uv",new jr(e,2)),i})(),Gt=class Hl{static get fullscreenGeometry(){return i0}constructor(e="Pass",i=new an,a=new Gr){this.name=e,this.renderer=null,this.scene=i,this.camera=a,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){const i=this.fullscreenMaterial;i!==null&&(i.needsUpdate=!0),this.rtt=!e}}set mainScene(e){}set mainCamera(e){}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let i=this.screen;i!==null?i.material=e:(i=new nt(Hl.fullscreenGeometry,e),i.frustumCulled=!1,this.scene===null&&(this.scene=new an),this.scene.add(i),this.screen=i)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,i=rs){}render(e,i,a,o,f){throw new Error("Render method not implemented!")}setSize(e,i){}initialize(e,i,a){}dispose(){for(const e of Object.keys(this)){const i=this[e];(i instanceof Cn||i instanceof Vl||i instanceof Xl||i instanceof Hl)&&this[e].dispose()}this.fullscreenMaterial!==null&&this.fullscreenMaterial.dispose()}},s0=class extends Gt{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(t,e,i,a,o){const f=t.state.buffers.stencil;f.setLocked(!1),f.setTest(!1)}},l0=`#ifdef COLOR_WRITE
#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#endif
#ifdef DEPTH_WRITE
#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}
#endif
#ifdef USE_WEIGHTS
uniform vec4 channelWeights;
#endif
uniform float opacity;varying vec2 vUv;void main(){
#ifdef COLOR_WRITE
vec4 texel=texture2D(inputBuffer,vUv);
#ifdef USE_WEIGHTS
texel*=channelWeights;
#endif
gl_FragColor=opacity*texel;
#ifdef COLOR_SPACE_CONVERSION
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
#else
gl_FragColor=vec4(0.0);
#endif
#ifdef DEPTH_WRITE
gl_FragDepth=readDepth(vUv);
#endif
}`,oc="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",uc=class extends Ht{constructor(){super({name:"CopyMaterial",defines:{COLOR_SPACE_CONVERSION:"1",DEPTH_PACKING:"0",COLOR_WRITE:"1"},uniforms:{inputBuffer:new ke(null),depthBuffer:new ke(null),channelWeights:new ke(null),opacity:new ke(1)},blending:cr,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:l0,vertexShader:oc}),this.depthFunc=Wf}get inputBuffer(){return this.uniforms.inputBuffer.value}set inputBuffer(t){const e=t!==null;this.colorWrite!==e&&(e?this.defines.COLOR_WRITE=!0:delete this.defines.COLOR_WRITE,this.colorWrite=e,this.needsUpdate=!0),this.uniforms.inputBuffer.value=t}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(t){const e=t!==null;this.depthWrite!==e&&(e?this.defines.DEPTH_WRITE=!0:delete this.defines.DEPTH_WRITE,this.depthTest=e,this.depthWrite=e,this.needsUpdate=!0),this.uniforms.depthBuffer.value=t}set depthPacking(t){this.defines.DEPTH_PACKING=t.toFixed(0),this.needsUpdate=!0}get colorSpaceConversion(){return this.defines.COLOR_SPACE_CONVERSION!==void 0}set colorSpaceConversion(t){this.colorSpaceConversion!==t&&(t?this.defines.COLOR_SPACE_CONVERSION=!0:delete this.defines.COLOR_SPACE_CONVERSION,this.needsUpdate=!0)}get channelWeights(){return this.uniforms.channelWeights.value}set channelWeights(t){t!==null?(this.defines.USE_WEIGHTS="1",this.uniforms.channelWeights.value=t):delete this.defines.USE_WEIGHTS,this.needsUpdate=!0}setInputBuffer(t){this.uniforms.inputBuffer.value=t}getOpacity(t){return this.uniforms.opacity.value}setOpacity(t){this.uniforms.opacity.value=t}},a0=class extends Gt{constructor(t,e=!0){super("CopyPass"),this.fullscreenMaterial=new uc,this.needsSwap=!1,this.renderTarget=t,t===void 0&&(this.renderTarget=new Cn(1,1,{minFilter:Ki,magFilter:Ki,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=e}get resize(){return this.autoResize}set resize(t){this.autoResize=t}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(t){this.autoResize=t}render(t,e,i,a,o){this.fullscreenMaterial.inputBuffer=e.texture,t.setRenderTarget(this.renderToScreen?null:this.renderTarget),t.render(this.scene,this.camera)}setSize(t,e){this.autoResize&&this.renderTarget.setSize(t,e)}initialize(t,e,i){i!==void 0&&(this.renderTarget.texture.type=i,i!==Mn?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":t!==null&&t.outputColorSpace===Qe&&(this.renderTarget.texture.colorSpace=Qe))}},Mu=new or,cc=class extends Gt{constructor(t=!0,e=!0,i=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=t,this.depth=e,this.stencil=i,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(t,e,i){this.color=t,this.depth=e,this.stencil=i}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(t){this.overrideClearColor=t}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(t){this.overrideClearAlpha=t}render(t,e,i,a,o){const f=this.overrideClearColor,c=this.overrideClearAlpha,p=t.getClearAlpha(),d=f!==null,g=c>=0;d?(t.getClearColor(Mu),t.setClearColor(f,g?c:p)):g&&t.setClearAlpha(c),t.setRenderTarget(this.renderToScreen?null:e),t.clear(this.color,this.depth,this.stencil),d?t.setClearColor(Mu,p):g&&t.setClearAlpha(p)}},o0=class extends Gt{constructor(t,e){super("MaskPass",t,e),this.needsSwap=!1,this.clearPass=new cc(!1,!1,!0),this.inverse=!1}set mainScene(t){this.scene=t}set mainCamera(t){this.camera=t}get inverted(){return this.inverse}set inverted(t){this.inverse=t}get clear(){return this.clearPass.enabled}set clear(t){this.clearPass.enabled=t}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(t){this.inverted=t}render(t,e,i,a,o){const f=t.getContext(),c=t.state.buffers,p=this.scene,d=this.camera,g=this.clearPass,v=this.inverted?0:1,m=1-v;c.color.setMask(!1),c.depth.setMask(!1),c.color.setLocked(!0),c.depth.setLocked(!0),c.stencil.setTest(!0),c.stencil.setOp(f.REPLACE,f.REPLACE,f.REPLACE),c.stencil.setFunc(f.ALWAYS,v,4294967295),c.stencil.setClear(m),c.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?g.render(t,null):(g.render(t,e),g.render(t,i))),this.renderToScreen?(t.setRenderTarget(null),t.render(p,d)):(t.setRenderTarget(e),t.render(p,d),t.setRenderTarget(i),t.render(p,d)),c.color.setLocked(!1),c.depth.setLocked(!1),c.stencil.setLocked(!1),c.stencil.setFunc(f.EQUAL,1,4294967295),c.stencil.setOp(f.KEEP,f.KEEP,f.KEEP),c.stencil.setLocked(!0)}},u0=class{constructor(t=null,{depthBuffer:e=!0,stencilBuffer:i=!1,multisampling:a=0,frameBufferType:o}={}){this.renderer=null,this.inputBuffer=this.createBuffer(e,i,o,a),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new a0,this.depthTexture=null,this.passes=[],this.timer=new r0,this.autoRenderToScreen=!0,this.setRenderer(t)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(t){const e=this.inputBuffer,i=this.multisampling;i>0&&t>0?(this.inputBuffer.samples=t,this.outputBuffer.samples=t,this.inputBuffer.dispose(),this.outputBuffer.dispose()):i!==t&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(e.depthBuffer,e.stencilBuffer,e.texture.type,t),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(t){if(this.renderer=t,t!==null){const e=t.getSize(new Ce),i=t.getContext().getContextAttributes().alpha,a=this.inputBuffer.texture.type;a===Mn&&t.outputColorSpace===Qe&&(this.inputBuffer.texture.colorSpace=Qe,this.outputBuffer.texture.colorSpace=Qe,this.inputBuffer.dispose(),this.outputBuffer.dispose()),t.autoClear=!1,this.setSize(e.width,e.height);for(const o of this.passes)o.initialize(t,i,a)}}replaceRenderer(t,e=!0){const i=this.renderer,a=i.domElement.parentNode;return this.setRenderer(t),e&&a!==null&&(a.removeChild(i.domElement),a.appendChild(t.domElement)),i}createDepthTexture(){const t=this.depthTexture=new Df;return this.inputBuffer.depthTexture=t,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(t.format=Of,t.type=jf):t.type=Hf,t}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const t of this.passes)t.setDepthTexture(null)}}createBuffer(t,e,i,a){const o=this.renderer,f=o===null?new Ce:o.getDrawingBufferSize(new Ce),c={minFilter:Ki,magFilter:Ki,stencilBuffer:e,depthBuffer:t,type:i},p=new Cn(f.width,f.height,c);return a>0&&(p.samples=a),i===Mn&&o!==null&&o.outputColorSpace===Qe&&(p.texture.colorSpace=Qe),p.texture.name="EffectComposer.Buffer",p.texture.generateMipmaps=!1,p}setMainScene(t){for(const e of this.passes)e.mainScene=t}setMainCamera(t){for(const e of this.passes)e.mainCamera=t}addPass(t,e){const i=this.passes,a=this.renderer,o=a.getDrawingBufferSize(new Ce),f=a.getContext().getContextAttributes().alpha,c=this.inputBuffer.texture.type;if(t.setRenderer(a),t.setSize(o.width,o.height),t.initialize(a,f,c),this.autoRenderToScreen&&(i.length>0&&(i[i.length-1].renderToScreen=!1),t.renderToScreen&&(this.autoRenderToScreen=!1)),e!==void 0?i.splice(e,0,t):i.push(t),this.autoRenderToScreen&&(i[i.length-1].renderToScreen=!0),t.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){const p=this.createDepthTexture();for(t of i)t.setDepthTexture(p)}else t.setDepthTexture(this.depthTexture)}removePass(t){const e=this.passes,i=e.indexOf(t);if(i!==-1&&e.splice(i,1).length>0){if(this.depthTexture!==null){const f=(p,d)=>p||d.needsDepthTexture;e.reduce(f,!1)||(t.getDepthTexture()===this.depthTexture&&t.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&i===e.length&&(t.renderToScreen=!1,e.length>0&&(e[e.length-1].renderToScreen=!0))}}removeAllPasses(){const t=this.passes;this.deleteDepthTexture(),t.length>0&&(this.autoRenderToScreen&&(t[t.length-1].renderToScreen=!1),this.passes=[])}render(t){const e=this.renderer,i=this.copyPass;let a=this.inputBuffer,o=this.outputBuffer,f=!1,c,p,d;t===void 0&&(this.timer.update(),t=this.timer.getDelta());for(const g of this.passes)g.enabled&&(g.render(e,a,o,t,f),g.needsSwap&&(f&&(i.renderToScreen=g.renderToScreen,c=e.getContext(),p=e.state.buffers.stencil,p.setFunc(c.NOTEQUAL,1,4294967295),i.render(e,a,o,t,f),p.setFunc(c.EQUAL,1,4294967295)),d=a,a=o,o=d),g instanceof o0?f=!0:g instanceof s0&&(f=!1))}setSize(t,e,i){const a=this.renderer,o=a.getSize(new Ce);(t===void 0||e===void 0)&&(t=o.width,e=o.height),(o.width!==t||o.height!==e)&&a.setSize(t,e,i);const f=a.getDrawingBufferSize(new Ce);this.inputBuffer.setSize(f.width,f.height),this.outputBuffer.setSize(f.width,f.height);for(const c of this.passes)c.setSize(f.width,f.height)}reset(){this.dispose(),this.autoRenderToScreen=!0}dispose(){for(const t of this.passes)t.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose(),Gt.fullscreenGeometry.dispose()}},Rn={NONE:0,DEPTH:1,CONVOLUTION:2},Pe={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},c0=class{constructor(){this.shaderParts=new Map([[Pe.FRAGMENT_HEAD,null],[Pe.FRAGMENT_MAIN_UV,null],[Pe.FRAGMENT_MAIN_IMAGE,null],[Pe.VERTEX_HEAD,null],[Pe.VERTEX_MAIN_SUPPORT,null]]),this.defines=new Map,this.uniforms=new Map,this.blendModes=new Map,this.extensions=new Set,this.attributes=Rn.NONE,this.varyings=new Set,this.uvTransformation=!1,this.readDepth=!1,this.colorSpace=Nu}},Il=!1,Cu=class{constructor(t=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(t),this.meshCount=0,this.replaceMaterial=e=>{if(e.isMesh){let i;if(e.material.flatShading)switch(e.material.side){case Vi:i=this.materialsFlatShadedDoubleSide;break;case Or:i=this.materialsFlatShadedBackSide;break;default:i=this.materialsFlatShaded;break}else switch(e.material.side){case Vi:i=this.materialsDoubleSide;break;case Or:i=this.materialsBackSide;break;default:i=this.materials;break}this.originalMaterials.set(e,e.material),e.isSkinnedMesh?e.material=i[2]:e.isInstancedMesh?e.material=i[1]:e.material=i[0],++this.meshCount}}}cloneMaterial(t){if(!(t instanceof Ht))return t.clone();const e=t.uniforms,i=new Map;for(const o in e){const f=e[o].value;f.isRenderTargetTexture&&(e[o].value=null,i.set(o,f))}const a=t.clone();for(const o of i)e[o[0]].value=o[1],a.uniforms[o[0]].value=o[1];return a}setMaterial(t){if(this.disposeMaterials(),this.material=t,t!==null){const e=this.materials=[this.cloneMaterial(t),this.cloneMaterial(t),this.cloneMaterial(t)];for(const i of e)i.uniforms=Object.assign({},t.uniforms),i.side=Gf;e[2].skinning=!0,this.materialsBackSide=e.map(i=>{const a=this.cloneMaterial(i);return a.uniforms=Object.assign({},t.uniforms),a.side=Or,a}),this.materialsDoubleSide=e.map(i=>{const a=this.cloneMaterial(i);return a.uniforms=Object.assign({},t.uniforms),a.side=Vi,a}),this.materialsFlatShaded=e.map(i=>{const a=this.cloneMaterial(i);return a.uniforms=Object.assign({},t.uniforms),a.flatShading=!0,a}),this.materialsFlatShadedBackSide=e.map(i=>{const a=this.cloneMaterial(i);return a.uniforms=Object.assign({},t.uniforms),a.flatShading=!0,a.side=Or,a}),this.materialsFlatShadedDoubleSide=e.map(i=>{const a=this.cloneMaterial(i);return a.uniforms=Object.assign({},t.uniforms),a.flatShading=!0,a.side=Vi,a})}}render(t,e,i){const a=t.shadowMap.enabled;if(t.shadowMap.enabled=!1,Il){const o=this.originalMaterials;this.meshCount=0,e.traverse(this.replaceMaterial),t.render(e,i);for(const f of o)f[0].material=f[1];this.meshCount!==o.size&&o.clear()}else{const o=e.overrideMaterial;e.overrideMaterial=this.material,t.render(e,i),e.overrideMaterial=o}t.shadowMap.enabled=a}disposeMaterials(){if(this.material!==null){const t=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const e of t)e.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return Il}static set workaroundEnabled(t){Il=t}},En=-1,$t=class extends ql{constructor(t,e=En,i=En,a=1){super(),this.resizable=t,this.baseSize=new Ce(1,1),this.preferredSize=new Ce(e,i),this.target=this.preferredSize,this.s=a,this.effectiveSize=new Ce,this.addEventListener("change",()=>this.updateEffectiveSize()),this.updateEffectiveSize()}updateEffectiveSize(){const t=this.baseSize,e=this.preferredSize,i=this.effectiveSize,a=this.scale;e.width!==En?i.width=e.width:e.height!==En?i.width=Math.round(e.height*(t.width/Math.max(t.height,1))):i.width=Math.round(t.width*a),e.height!==En?i.height=e.height:e.width!==En?i.height=Math.round(e.width/Math.max(t.width/Math.max(t.height,1),1)):i.height=Math.round(t.height*a)}get width(){return this.effectiveSize.width}set width(t){this.preferredWidth=t}get height(){return this.effectiveSize.height}set height(t){this.preferredHeight=t}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(t){this.s!==t&&(this.s=t,this.preferredSize.setScalar(En),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getScale(){return this.scale}setScale(t){this.scale=t}get baseWidth(){return this.baseSize.width}set baseWidth(t){this.baseSize.width!==t&&(this.baseSize.width=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseWidth(){return this.baseWidth}setBaseWidth(t){this.baseWidth=t}get baseHeight(){return this.baseSize.height}set baseHeight(t){this.baseSize.height!==t&&(this.baseSize.height=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(t){this.baseHeight=t}setBaseSize(t,e){(this.baseSize.width!==t||this.baseSize.height!==e)&&(this.baseSize.set(t,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}get preferredWidth(){return this.preferredSize.width}set preferredWidth(t){this.preferredSize.width!==t&&(this.preferredSize.width=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(t){this.preferredWidth=t}get preferredHeight(){return this.preferredSize.height}set preferredHeight(t){this.preferredSize.height!==t&&(this.preferredSize.height=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(t){this.preferredHeight=t}setPreferredSize(t,e){(this.preferredSize.width!==t||this.preferredSize.height!==e)&&(this.preferredSize.set(t,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}copy(t){this.s=t.scale,this.baseSize.set(t.baseWidth,t.baseHeight),this.preferredSize.set(t.preferredWidth,t.preferredHeight),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height)}static get AUTO_SIZE(){return En}},Me={ADD:0,ALPHA:1,AVERAGE:2,COLOR:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,DIVIDE:8,DST:9,EXCLUSION:10,HARD_LIGHT:11,HARD_MIX:12,HUE:13,INVERT:14,INVERT_RGB:15,LIGHTEN:16,LINEAR_BURN:17,LINEAR_DODGE:18,LINEAR_LIGHT:19,LUMINOSITY:20,MULTIPLY:21,NEGATION:22,NORMAL:23,OVERLAY:24,PIN_LIGHT:25,REFLECT:26,SATURATION:27,SCREEN:28,SOFT_LIGHT:29,SRC:30,SUBTRACT:31,VIVID_LIGHT:32},f0="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=dst.rgb+src.rgb;return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",d0="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){return mix(dst,src,src.a*opacity);}",h0="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=(dst.rgb+src.rgb)*0.5;return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",p0="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=RGBToHSL(dst.rgb);vec3 b=RGBToHSL(src.rgb);vec3 c=HSLToRGB(vec3(b.xy,a.z));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",m0="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=dst.rgb,b=src.rgb;vec3 c=mix(step(0.0,b)*(1.0-min(vec3(1.0),(1.0-a)/max(b,1e-9))),vec3(1.0),step(1.0,a));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",v0="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=dst.rgb,b=src.rgb;vec3 c=step(0.0,a)*mix(min(vec3(1.0),a/max(1.0-b,1e-9)),vec3(1.0),step(1.0,b));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",g0="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=min(dst.rgb,src.rgb);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",y0="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=abs(dst.rgb-src.rgb);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",x0="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=dst.rgb/max(src.rgb,1e-9);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",w0="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=dst.rgb+src.rgb-2.0*dst.rgb*src.rgb;return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",S0="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=min(dst.rgb,1.0);vec3 b=min(src.rgb,1.0);vec3 c=mix(2.0*a*b,1.0-2.0*(1.0-a)*(1.0-b),step(0.5,b));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",E0="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=step(1.0,dst.rgb+src.rgb);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",R0="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=RGBToHSL(dst.rgb);vec3 b=RGBToHSL(src.rgb);vec3 c=HSLToRGB(vec3(b.x,a.yz));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",M0="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=max(1.0-src.rgb,0.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",C0="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=src.rgb*max(1.0-dst.rgb,0.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",_0="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=max(dst.rgb,src.rgb);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",T0="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=clamp(src.rgb+dst.rgb-1.0,0.0,1.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",b0="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=min(dst.rgb+src.rgb,1.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",P0="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=clamp(2.0*src.rgb+dst.rgb-1.0,0.0,1.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",k0="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=RGBToHSL(dst.rgb);vec3 b=RGBToHSL(src.rgb);vec3 c=HSLToRGB(vec3(a.xy,b.z));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",z0="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=dst.rgb*src.rgb;return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",A0="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=max(1.0-abs(1.0-dst.rgb-src.rgb),0.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",N0="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){return mix(dst,src,opacity);}",I0="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=2.0*src.rgb*dst.rgb;vec3 b=1.0-2.0*(1.0-src.rgb)*(1.0-dst.rgb);vec3 c=mix(a,b,step(0.5,dst.rgb));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",L0="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 src2=2.0*src.rgb;vec3 c=mix(mix(src2,dst.rgb,step(0.5*dst.rgb,src.rgb)),max(src2-1.0,vec3(0.0)),step(dst.rgb,src2-1.0));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",F0="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=min(dst.rgb*dst.rgb/max(1.0-src.rgb,1e-9),1.0);vec3 c=mix(a,src.rgb,step(1.0,src.rgb));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",B0="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=RGBToHSL(dst.rgb);vec3 b=RGBToHSL(src.rgb);vec3 c=HSLToRGB(vec3(a.x,b.y,a.z));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",U0="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=dst.rgb+src.rgb-min(dst.rgb*src.rgb,1.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",D0="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 src2=2.0*src.rgb;vec3 d=dst.rgb+(src2-1.0);vec3 w=step(0.5,src.rgb);vec3 a=dst.rgb-(1.0-src2)*dst.rgb*(1.0-dst.rgb);vec3 b=mix(d*(sqrt(dst.rgb)-dst.rgb),d*dst.rgb*((16.0*dst.rgb-12.0)*dst.rgb+3.0),w*(1.0-step(0.25,dst.rgb)));vec3 c=mix(a,b,w);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",O0="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){return src;}",j0="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=max(dst.rgb-src.rgb,0.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",H0="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=mix(max(1.0-min((1.0-dst.rgb)/(2.0*src.rgb),1.0),0.0),min(dst.rgb/(2.0*(1.0-src.rgb)),1.0),step(0.5,src.rgb));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",G0=new Map([[Me.ADD,f0],[Me.ALPHA,d0],[Me.AVERAGE,h0],[Me.COLOR,p0],[Me.COLOR_BURN,m0],[Me.COLOR_DODGE,v0],[Me.DARKEN,g0],[Me.DIFFERENCE,y0],[Me.DIVIDE,x0],[Me.DST,null],[Me.EXCLUSION,w0],[Me.HARD_LIGHT,S0],[Me.HARD_MIX,E0],[Me.HUE,R0],[Me.INVERT,M0],[Me.INVERT_RGB,C0],[Me.LIGHTEN,_0],[Me.LINEAR_BURN,T0],[Me.LINEAR_DODGE,b0],[Me.LINEAR_LIGHT,P0],[Me.LUMINOSITY,k0],[Me.MULTIPLY,z0],[Me.NEGATION,A0],[Me.NORMAL,N0],[Me.OVERLAY,I0],[Me.PIN_LIGHT,L0],[Me.REFLECT,F0],[Me.SATURATION,B0],[Me.SCREEN,U0],[Me.SOFT_LIGHT,D0],[Me.SRC,O0],[Me.SUBTRACT,j0],[Me.VIVID_LIGHT,H0]]),W0=class extends ql{constructor(t,e=1){super(),this._blendFunction=t,this.opacity=new ke(e)}getOpacity(){return this.opacity.value}setOpacity(t){this.opacity.value=t}get blendFunction(){return this._blendFunction}set blendFunction(t){this._blendFunction=t,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(t){this.blendFunction=t}getShaderCode(){return G0.get(this.blendFunction)}},fc=class extends ql{constructor(t,e,{attributes:i=Rn.NONE,blendFunction:a=Me.NORMAL,defines:o=new Map,uniforms:f=new Map,extensions:c=null,vertexShader:p=null}={}){super(),this.name=t,this.renderer=null,this.attributes=i,this.fragmentShader=e,this.vertexShader=p,this.defines=o,this.uniforms=f,this.extensions=c,this.blendMode=new W0(a),this.blendMode.addEventListener("change",d=>this.setChanged()),this._inputColorSpace=Nu,this._outputColorSpace=Iu}get inputColorSpace(){return this._inputColorSpace}set inputColorSpace(t){this._inputColorSpace=t,this.setChanged()}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(t){this._outputColorSpace=t,this.setChanged()}set mainScene(t){}set mainCamera(t){}getName(){return this.name}setRenderer(t){this.renderer=t}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(t){this.attributes=t,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(t){this.fragmentShader=t,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(t){this.vertexShader=t,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(t,e=rs){}update(t,e,i){}setSize(t,e){}initialize(t,e,i){}dispose(){for(const t of Object.keys(this)){const e=this[t];(e instanceof Cn||e instanceof Vl||e instanceof Xl||e instanceof Gt)&&this[t].dispose()}}},Kl={MEDIUM:2,LARGE:3},V0=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <colorspace_fragment>
}`,X0="uniform vec4 texelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize.xy*vec2(kernel)+texelSize.zw)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",Y0=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],q0=class extends Ht{constructor(t=new Io){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new ke(null),texelSize:new ke(new Io),scale:new ke(1),kernel:new ke(0)},blending:cr,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:V0,vertexShader:X0}),this.setTexelSize(t.x,t.y),this.kernelSize=Kl.MEDIUM}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.inputBuffer=t}get kernelSequence(){return Y0[this.kernelSize]}get scale(){return this.uniforms.scale.value}set scale(t){this.uniforms.scale.value=t}getScale(){return this.uniforms.scale.value}setScale(t){this.uniforms.scale.value=t}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(t){this.uniforms.kernel.value=t}setKernel(t){this.kernel=t}setTexelSize(t,e){this.uniforms.texelSize.value.set(t,e,t*.5,e*.5)}setSize(t,e){const i=1/t,a=1/e;this.uniforms.texelSize.value.set(i,a,i*.5,a*.5)}},Q0=class extends Gt{constructor({kernelSize:t=Kl.MEDIUM,resolutionScale:e=.5,width:i=$t.AUTO_SIZE,height:a=$t.AUTO_SIZE,resolutionX:o=i,resolutionY:f=a}={}){super("KawaseBlurPass"),this.renderTargetA=new Cn(1,1,{depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";const c=this.resolution=new $t(this,o,f,e);c.addEventListener("change",p=>this.setSize(c.baseWidth,c.baseHeight)),this._blurMaterial=new q0,this._blurMaterial.kernelSize=t,this.copyMaterial=new uc}getResolution(){return this.resolution}get blurMaterial(){return this._blurMaterial}set blurMaterial(t){this._blurMaterial=t}get dithering(){return this.copyMaterial.dithering}set dithering(t){this.copyMaterial.dithering=t}get kernelSize(){return this.blurMaterial.kernelSize}set kernelSize(t){this.blurMaterial.kernelSize=t}get width(){return this.resolution.width}set width(t){this.resolution.preferredWidth=t}get height(){return this.resolution.height}set height(t){this.resolution.preferredHeight=t}get scale(){return this.blurMaterial.scale}set scale(t){this.blurMaterial.scale=t}getScale(){return this.blurMaterial.scale}setScale(t){this.blurMaterial.scale=t}getKernelSize(){return this.kernelSize}setKernelSize(t){this.kernelSize=t}getResolutionScale(){return this.resolution.scale}setResolutionScale(t){this.resolution.scale=t}render(t,e,i,a,o){const f=this.scene,c=this.camera,p=this.renderTargetA,d=this.renderTargetB,g=this.blurMaterial,v=g.kernelSequence;let m=e;this.fullscreenMaterial=g;for(let y=0,x=v.length;y<x;++y){const w=y&1?d:p;g.kernel=v[y],g.inputBuffer=m.texture,t.setRenderTarget(w),t.render(f,c),m=w}this.fullscreenMaterial=this.copyMaterial,this.copyMaterial.inputBuffer=m.texture,t.setRenderTarget(this.renderToScreen?null:i),t.render(f,c)}setSize(t,e){const i=this.resolution;i.setBaseSize(t,e);const a=i.width,o=i.height;this.renderTargetA.setSize(a,o),this.renderTargetB.setSize(a,o),this.blurMaterial.setSize(t,e)}initialize(t,e,i){i!==void 0&&(this.renderTargetA.texture.type=i,this.renderTargetB.texture.type=i,i!==Mn?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.copyMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):t!==null&&t.outputColorSpace===Qe&&(this.renderTargetA.texture.colorSpace=Qe,this.renderTargetB.texture.colorSpace=Qe))}static get AUTO_SIZE(){return $t.AUTO_SIZE}},Z0=`#include <common>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);float mask=1.0;
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);mask=low*high;
#elif defined(THRESHOLD)
mask=smoothstep(threshold,threshold+smoothing,l);
#endif
#ifdef COLOR
gl_FragColor=texel*mask;
#else
gl_FragColor=vec4(l*mask);
#endif
}`,K0=class extends Ht{constructor(t=!1,e=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:Lu.replace(/\D+/g,"")},uniforms:{inputBuffer:new ke(null),threshold:new ke(0),smoothing:new ke(1),range:new ke(null)},blending:cr,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Z0,vertexShader:oc}),this.colorOutput=t,this.luminanceRange=e}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}get threshold(){return this.uniforms.threshold.value}set threshold(t){this.smoothing>0||t>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=t}getThreshold(){return this.threshold}setThreshold(t){this.threshold=t}get smoothing(){return this.uniforms.smoothing.value}set smoothing(t){this.threshold>0||t>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=t}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(t){this.smoothing=t}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(t){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(t){t?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(t){return this.colorOutput}setColorOutputEnabled(t){this.colorOutput=t}get useRange(){return this.luminanceRange!==null}set useRange(t){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(t){t!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=t,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(t){this.luminanceRange=t}},J0=class extends Gt{constructor({renderTarget:t,luminanceRange:e,colorOutput:i,resolutionScale:a=1,width:o=$t.AUTO_SIZE,height:f=$t.AUTO_SIZE,resolutionX:c=o,resolutionY:p=f}={}){super("LuminancePass"),this.fullscreenMaterial=new K0(i,e),this.needsSwap=!1,this.renderTarget=t,this.renderTarget===void 0&&(this.renderTarget=new Cn(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target");const d=this.resolution=new $t(this,c,p,a);d.addEventListener("change",g=>this.setSize(d.baseWidth,d.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(t,e,i,a,o){const f=this.fullscreenMaterial;f.inputBuffer=e.texture,t.setRenderTarget(this.renderToScreen?null:this.renderTarget),t.render(this.scene,this.camera)}setSize(t,e){const i=this.resolution;i.setBaseSize(t,e),this.renderTarget.setSize(i.width,i.height)}initialize(t,e,i){i!==void 0&&i!==Mn&&(this.renderTarget.texture.type=i,this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},$0=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#define WEIGHT_INNER 0.125
#define WEIGHT_OUTER 0.0555555
varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;float clampToBorder(const in vec2 uv){return float(uv.s>=0.0&&uv.s<=1.0&&uv.t>=0.0&&uv.t<=1.0);}void main(){vec4 c=vec4(0.0);vec4 w=WEIGHT_INNER*vec4(clampToBorder(vUv00),clampToBorder(vUv01),clampToBorder(vUv02),clampToBorder(vUv03));c+=w.x*texture2D(inputBuffer,vUv00);c+=w.y*texture2D(inputBuffer,vUv01);c+=w.z*texture2D(inputBuffer,vUv02);c+=w.w*texture2D(inputBuffer,vUv03);w=WEIGHT_OUTER*vec4(clampToBorder(vUv04),clampToBorder(vUv05),clampToBorder(vUv06),clampToBorder(vUv07));c+=w.x*texture2D(inputBuffer,vUv04);c+=w.y*texture2D(inputBuffer,vUv05);c+=w.z*texture2D(inputBuffer,vUv06);c+=w.w*texture2D(inputBuffer,vUv07);w=WEIGHT_OUTER*vec4(clampToBorder(vUv08),clampToBorder(vUv09),clampToBorder(vUv10),clampToBorder(vUv11));c+=w.x*texture2D(inputBuffer,vUv08);c+=w.y*texture2D(inputBuffer,vUv09);c+=w.z*texture2D(inputBuffer,vUv10);c+=w.w*texture2D(inputBuffer,vUv11);c+=WEIGHT_OUTER*texture2D(inputBuffer,vUv);gl_FragColor=c;
#include <colorspace_fragment>
}`,em="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;void main(){vUv=position.xy*0.5+0.5;vUv00=vUv+texelSize*vec2(-1.0,1.0);vUv01=vUv+texelSize*vec2(1.0,1.0);vUv02=vUv+texelSize*vec2(-1.0,-1.0);vUv03=vUv+texelSize*vec2(1.0,-1.0);vUv04=vUv+texelSize*vec2(-2.0,2.0);vUv05=vUv+texelSize*vec2(0.0,2.0);vUv06=vUv+texelSize*vec2(2.0,2.0);vUv07=vUv+texelSize*vec2(-2.0,0.0);vUv08=vUv+texelSize*vec2(2.0,0.0);vUv09=vUv+texelSize*vec2(-2.0,-2.0);vUv10=vUv+texelSize*vec2(0.0,-2.0);vUv11=vUv+texelSize*vec2(2.0,-2.0);gl_Position=vec4(position.xy,1.0,1.0);}",tm=class extends Ht{constructor(){super({name:"DownsamplingMaterial",uniforms:{inputBuffer:new ke(null),texelSize:new ke(new Ce)},blending:cr,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:$0,vertexShader:em})}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setSize(t,e){this.uniforms.texelSize.value.set(1/t,1/e)}},nm=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;uniform mediump sampler2D supportBuffer;
#else
uniform lowp sampler2D inputBuffer;uniform lowp sampler2D supportBuffer;
#endif
uniform float radius;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vec4 c=vec4(0.0);c+=texture2D(inputBuffer,vUv0)*0.0625;c+=texture2D(inputBuffer,vUv1)*0.125;c+=texture2D(inputBuffer,vUv2)*0.0625;c+=texture2D(inputBuffer,vUv3)*0.125;c+=texture2D(inputBuffer,vUv)*0.25;c+=texture2D(inputBuffer,vUv4)*0.125;c+=texture2D(inputBuffer,vUv5)*0.0625;c+=texture2D(inputBuffer,vUv6)*0.125;c+=texture2D(inputBuffer,vUv7)*0.0625;vec4 baseColor=texture2D(supportBuffer,vUv);gl_FragColor=mix(baseColor,c,radius);
#include <colorspace_fragment>
}`,rm="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,1.0);vUv1=vUv+texelSize*vec2(0.0,1.0);vUv2=vUv+texelSize*vec2(1.0,1.0);vUv3=vUv+texelSize*vec2(-1.0,0.0);vUv4=vUv+texelSize*vec2(1.0,0.0);vUv5=vUv+texelSize*vec2(-1.0,-1.0);vUv6=vUv+texelSize*vec2(0.0,-1.0);vUv7=vUv+texelSize*vec2(1.0,-1.0);gl_Position=vec4(position.xy,1.0,1.0);}",im=class extends Ht{constructor(){super({name:"UpsamplingMaterial",uniforms:{inputBuffer:new ke(null),supportBuffer:new ke(null),texelSize:new ke(new Ce),radius:new ke(.85)},blending:cr,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:nm,vertexShader:rm})}set inputBuffer(t){this.uniforms.inputBuffer.value=t}set supportBuffer(t){this.uniforms.supportBuffer.value=t}get radius(){return this.uniforms.radius.value}set radius(t){this.uniforms.radius.value=t}setSize(t,e){this.uniforms.texelSize.value.set(1/t,1/e)}},sm=class extends Gt{constructor(){super("MipmapBlurPass"),this.needsSwap=!1,this.renderTarget=new Cn(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Upsampling.Mipmap0",this.downsamplingMipmaps=[],this.upsamplingMipmaps=[],this.downsamplingMaterial=new tm,this.upsamplingMaterial=new im,this.resolution=new Ce}get texture(){return this.renderTarget.texture}get levels(){return this.downsamplingMipmaps.length}set levels(t){if(this.levels!==t){const e=this.renderTarget;this.dispose(),this.downsamplingMipmaps=[],this.upsamplingMipmaps=[];for(let i=0;i<t;++i){const a=e.clone();a.texture.name="Downsampling.Mipmap"+i,this.downsamplingMipmaps.push(a)}this.upsamplingMipmaps.push(e);for(let i=1,a=t-1;i<a;++i){const o=e.clone();o.texture.name="Upsampling.Mipmap"+i,this.upsamplingMipmaps.push(o)}this.setSize(this.resolution.x,this.resolution.y)}}get radius(){return this.upsamplingMaterial.radius}set radius(t){this.upsamplingMaterial.radius=t}render(t,e,i,a,o){const{scene:f,camera:c}=this,{downsamplingMaterial:p,upsamplingMaterial:d}=this,{downsamplingMipmaps:g,upsamplingMipmaps:v}=this;let m=e;this.fullscreenMaterial=p;for(let y=0,x=g.length;y<x;++y){const w=g[y];p.setSize(m.width,m.height),p.inputBuffer=m.texture,t.setRenderTarget(w),t.render(f,c),m=w}this.fullscreenMaterial=d;for(let y=v.length-1;y>=0;--y){const x=v[y];d.setSize(m.width,m.height),d.inputBuffer=m.texture,d.supportBuffer=g[y].texture,t.setRenderTarget(x),t.render(f,c),m=x}}setSize(t,e){const i=this.resolution;i.set(t,e);let a=i.width,o=i.height;for(let f=0,c=this.downsamplingMipmaps.length;f<c;++f)a=Math.round(a*.5),o=Math.round(o*.5),this.downsamplingMipmaps[f].setSize(a,o),f<this.upsamplingMipmaps.length&&this.upsamplingMipmaps[f].setSize(a,o)}initialize(t,e,i){if(i!==void 0){const a=this.downsamplingMipmaps.concat(this.upsamplingMipmaps);for(const o of a)o.texture.type=i;if(i!==Mn)this.downsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.upsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1";else if(t!==null&&t.outputColorSpace===Qe)for(const o of a)o.texture.colorSpace=Qe}}dispose(){super.dispose();for(const t of this.downsamplingMipmaps.concat(this.upsamplingMipmaps))t.dispose()}},lm=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=texture2D(map,uv)*intensity;}`,am=class extends fc{constructor({blendFunction:t=Me.SCREEN,luminanceThreshold:e=1,luminanceSmoothing:i=.03,mipmapBlur:a=!0,intensity:o=1,radius:f=.85,levels:c=8,kernelSize:p=Kl.LARGE,resolutionScale:d=.5,width:g=$t.AUTO_SIZE,height:v=$t.AUTO_SIZE,resolutionX:m=g,resolutionY:y=v}={}){super("BloomEffect",lm,{blendFunction:t,uniforms:new Map([["map",new ke(null)],["intensity",new ke(o)]])}),this.renderTarget=new Cn(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.blurPass=new Q0({kernelSize:p}),this.luminancePass=new J0({colorOutput:!0}),this.luminanceMaterial.threshold=e,this.luminanceMaterial.smoothing=i,this.mipmapBlurPass=new sm,this.mipmapBlurPass.enabled=a,this.mipmapBlurPass.radius=f,this.mipmapBlurPass.levels=c,this.uniforms.get("map").value=a?this.mipmapBlurPass.texture:this.renderTarget.texture;const x=this.resolution=new $t(this,m,y,d);x.addEventListener("change",w=>this.setSize(x.baseWidth,x.baseHeight))}get texture(){return this.mipmapBlurPass.enabled?this.mipmapBlurPass.texture:this.renderTarget.texture}getTexture(){return this.texture}getResolution(){return this.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(t){this.resolution.preferredWidth=t}get height(){return this.resolution.height}set height(t){this.resolution.preferredHeight=t}get dithering(){return this.blurPass.dithering}set dithering(t){this.blurPass.dithering=t}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(t){this.blurPass.kernelSize=t}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(t){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(t){this.uniforms.get("intensity").value=t}getIntensity(){return this.intensity}setIntensity(t){this.intensity=t}getResolutionScale(){return this.resolution.scale}setResolutionScale(t){this.resolution.scale=t}update(t,e,i){const a=this.renderTarget,o=this.luminancePass;o.enabled?(o.render(t,e),this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(t,o.renderTarget):this.blurPass.render(t,o.renderTarget,a)):this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(t,e):this.blurPass.render(t,e,a)}setSize(t,e){const i=this.resolution;i.setBaseSize(t,e),this.renderTarget.setSize(i.width,i.height),this.blurPass.resolution.copy(i),this.luminancePass.setSize(t,e),this.mipmapBlurPass.setSize(t,e)}initialize(t,e,i){this.blurPass.initialize(t,e,i),this.luminancePass.initialize(t,e,i),this.mipmapBlurPass.initialize(t,e,i),i!==void 0&&(this.renderTarget.texture.type=i,t!==null&&t.outputColorSpace===Qe&&(this.renderTarget.texture.colorSpace=Qe))}},om=`#ifdef RADIAL_MODULATION
uniform float modulationOffset;
#endif
varying float vActive;varying vec2 vUvR;varying vec2 vUvB;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec2 ra=inputColor.ra;vec2 ba=inputColor.ba;
#ifdef RADIAL_MODULATION
const vec2 center=vec2(0.5);float d=distance(uv,center)*2.0;d=max(d-modulationOffset,0.0);if(vActive>0.0&&d>0.0){ra=texture2D(inputBuffer,mix(uv,vUvR,d)).ra;ba=texture2D(inputBuffer,mix(uv,vUvB,d)).ba;}
#else
if(vActive>0.0){ra=texture2D(inputBuffer,vUvR).ra;ba=texture2D(inputBuffer,vUvB).ba;}
#endif
outputColor=vec4(ra.x,inputColor.g,ba.x,max(max(ra.y,ba.y),inputColor.a));}`,um="uniform vec2 offset;varying float vActive;varying vec2 vUvR;varying vec2 vUvB;void mainSupport(const in vec2 uv){vec2 shift=offset*vec2(1.0,aspect);vActive=(shift.x!=0.0||shift.y!=0.0)?1.0:0.0;vUvR=uv+shift;vUvB=uv-shift;}",cm=class extends fc{constructor({offset:t=new Ce(.001,5e-4),radialModulation:e=!1,modulationOffset:i=.15}={}){super("ChromaticAberrationEffect",om,{vertexShader:um,attributes:Rn.CONVOLUTION,uniforms:new Map([["offset",new ke(t)],["modulationOffset",new ke(i)]])}),this.radialModulation=e}get offset(){return this.uniforms.get("offset").value}set offset(t){this.uniforms.get("offset").value=t}get radialModulation(){return this.defines.has("RADIAL_MODULATION")}set radialModulation(t){t?this.defines.set("RADIAL_MODULATION","1"):this.defines.delete("RADIAL_MODULATION"),this.setChanged()}get modulationOffset(){return this.uniforms.get("modulationOffset").value}set modulationOffset(t){this.uniforms.get("modulationOffset").value=t}getOffset(){return this.offset}setOffset(t){this.offset=t}},fm=class extends Gt{constructor(t,e,i=null){super("RenderPass",t,e),this.needsSwap=!1,this.clearPass=new cc,this.overrideMaterialManager=i===null?null:new Cu(i),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}set mainScene(t){this.scene=t}set mainCamera(t){this.camera=t}get renderToScreen(){return super.renderToScreen}set renderToScreen(t){super.renderToScreen=t,this.clearPass.renderToScreen=t}get overrideMaterial(){const t=this.overrideMaterialManager;return t!==null?t.material:null}set overrideMaterial(t){const e=this.overrideMaterialManager;t!==null?e!==null?e.setMaterial(t):this.overrideMaterialManager=new Cu(t):e!==null&&(e.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(t){this.overrideMaterial=t}get clear(){return this.clearPass.enabled}set clear(t){this.clearPass.enabled=t}getSelection(){return this.selection}setSelection(t){this.selection=t}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(t){this.ignoreBackground=t}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(t){this.skipShadowMapUpdate=t}getClearPass(){return this.clearPass}render(t,e,i,a,o){const f=this.scene,c=this.camera,p=this.selection,d=c.layers.mask,g=f.background,v=t.shadowMap.autoUpdate,m=this.renderToScreen?null:e;p!==null&&c.layers.set(p.getLayer()),this.skipShadowMapUpdate&&(t.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(f.background=null),this.clearPass.enabled&&this.clearPass.render(t,e),t.setRenderTarget(m),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(t,f,c):t.render(f,c),c.layers.mask=d,f.background=g,t.shadowMap.autoUpdate=v}},dm=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#if DEPTH_PACKING == 3201
uniform lowp sampler2D depthBuffer;
#elif defined(GL_FRAGMENT_PRECISION_HIGH)
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
float depth=unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
float depth=texture2D(depthBuffer,uv).r;
#endif
#if defined(USE_LOGARITHMIC_DEPTH_BUFFER) || defined(LOG_DEPTH)
float d=pow(2.0,depth*log2(cameraFar+1.0))-1.0;float a=cameraFar/(cameraFar-cameraNear);float b=cameraFar*cameraNear/(cameraNear-cameraFar);depth=a+b/d;
#elif defined(USE_REVERSED_DEPTH_BUFFER)
depth=1.0-depth;
#endif
return depth;}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}vec3 RGBToHCV(const in vec3 RGB){vec4 P=mix(vec4(RGB.bg,-1.0,2.0/3.0),vec4(RGB.gb,0.0,-1.0/3.0),step(RGB.b,RGB.g));vec4 Q=mix(vec4(P.xyw,RGB.r),vec4(RGB.r,P.yzx),step(P.x,RGB.r));float C=Q.x-min(Q.w,Q.y);float H=abs((Q.w-Q.y)/(6.0*C+EPSILON)+Q.z);return vec3(H,C,Q.x);}vec3 RGBToHSL(const in vec3 RGB){vec3 HCV=RGBToHCV(RGB);float L=HCV.z-HCV.y*0.5;float S=HCV.y/(1.0-abs(L*2.0-1.0)+EPSILON);return vec3(HCV.x,S,L);}vec3 HueToRGB(const in float H){float R=abs(H*6.0-3.0)-1.0;float G=2.0-abs(H*6.0-2.0);float B=2.0-abs(H*6.0-4.0);return clamp(vec3(R,G,B),0.0,1.0);}vec3 HSLToRGB(const in vec3 HSL){vec3 RGB=HueToRGB(HSL.x);float C=(1.0-abs(2.0*HSL.z-1.0))*HSL.y;return(RGB-0.5)*C+HSL.z;}FRAGMENT_HEAD void main(){FRAGMENT_MAIN_UV vec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGE color0.a=clamp(color0.a,0.0,1.0);gl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
}`,hm="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEAD void main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORT gl_Position=vec4(position.xy,1.0,1.0);}",pm=class extends Ht{constructor(t,e,i,a,o=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:Lu.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new ke(null),depthBuffer:new ke(null),resolution:new ke(new Ce),texelSize:new ke(new Ce),cameraNear:new ke(.3),cameraFar:new ke(1e3),aspect:new ke(1),time:new ke(0)},blending:cr,toneMapped:!1,depthWrite:!1,depthTest:!1,dithering:o}),t&&this.setShaderParts(t),e&&this.setDefines(e),i&&this.setUniforms(i),this.copyCameraSettings(a)}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(t){this.uniforms.depthBuffer.value=t}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(t){this.defines.DEPTH_PACKING=t.toFixed(0),this.needsUpdate=!0}setDepthBuffer(t,e=rs){this.depthBuffer=t,this.depthPacking=e}setShaderData(t){this.setShaderParts(t.shaderParts),this.setDefines(t.defines),this.setUniforms(t.uniforms),this.setExtensions(t.extensions)}setShaderParts(t){return this.fragmentShader=dm.replace(Pe.FRAGMENT_HEAD,t.get(Pe.FRAGMENT_HEAD)||"").replace(Pe.FRAGMENT_MAIN_UV,t.get(Pe.FRAGMENT_MAIN_UV)||"").replace(Pe.FRAGMENT_MAIN_IMAGE,t.get(Pe.FRAGMENT_MAIN_IMAGE)||""),this.vertexShader=hm.replace(Pe.VERTEX_HEAD,t.get(Pe.VERTEX_HEAD)||"").replace(Pe.VERTEX_MAIN_SUPPORT,t.get(Pe.VERTEX_MAIN_SUPPORT)||""),this.needsUpdate=!0,this}setDefines(t){for(const e of t.entries())this.defines[e[0]]=e[1];return this.needsUpdate=!0,this}setUniforms(t){for(const e of t.entries())this.uniforms[e[0]]=e[1];return this}setExtensions(t){this.extensions={};for(const e of t)this.extensions[e]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(t){this.encodeOutput!==t&&(t?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(t){return this.encodeOutput}setOutputEncodingEnabled(t){this.encodeOutput=t}get time(){return this.uniforms.time.value}set time(t){this.uniforms.time.value=t}setDeltaTime(t){this.uniforms.time.value+=t}adoptCameraSettings(t){this.copyCameraSettings(t)}copyCameraSettings(t){t&&(this.uniforms.cameraNear.value=t.near,this.uniforms.cameraFar.value=t.far,t instanceof Gl?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(t,e){const i=this.uniforms;i.resolution.value.set(t,e),i.texelSize.value.set(1/t,1/e),i.aspect.value=t/e}static get Section(){return Pe}};function _u(t,e,i){for(const a of e){const o="$1"+t+a.charAt(0).toUpperCase()+a.slice(1),f=new RegExp("([^\\.])(\\b"+a+"\\b)","g");for(const c of i.entries())c[1]!==null&&i.set(c[0],c[1].replace(f,o))}}function mm(t,e,i){let a=e.getFragmentShader(),o=e.getVertexShader();const f=a!==void 0&&/mainImage/.test(a),c=a!==void 0&&/mainUv/.test(a);if(i.attributes|=e.getAttributes(),a===void 0)throw new Error(`Missing fragment shader (${e.name})`);if(c&&i.attributes&Rn.CONVOLUTION)throw new Error(`Effects that transform UVs are incompatible with convolution effects (${e.name})`);if(!f&&!c)throw new Error(`Could not find mainImage or mainUv function (${e.name})`);{const p=/\w+\s+(\w+)\([\w\s,]*\)\s*{/g,d=i.shaderParts;let g=d.get(Pe.FRAGMENT_HEAD)||"",v=d.get(Pe.FRAGMENT_MAIN_UV)||"",m=d.get(Pe.FRAGMENT_MAIN_IMAGE)||"",y=d.get(Pe.VERTEX_HEAD)||"",x=d.get(Pe.VERTEX_MAIN_SUPPORT)||"";const w=new Set,M=new Set;if(c&&(v+=`	${t}MainUv(UV);
`,i.uvTransformation=!0),o!==null&&/mainSupport/.test(o)){const _=/mainSupport *\([\w\s]*?uv\s*?\)/.test(o);x+=`	${t}MainSupport(`,x+=_?`vUv);
`:`);
`;for(const b of o.matchAll(/(?:varying\s+\w+\s+([\S\s]*?);)/g))for(const A of b[1].split(/\s*,\s*/))i.varyings.add(A),w.add(A),M.add(A);for(const b of o.matchAll(p))M.add(b[1])}for(const _ of a.matchAll(p))M.add(_[1]);for(const _ of e.defines.keys())M.add(_.replace(/\([\w\s,]*\)/g,""));for(const _ of e.uniforms.keys())M.add(_);M.delete("while"),M.delete("for"),M.delete("if"),e.uniforms.forEach((_,b)=>i.uniforms.set(t+b.charAt(0).toUpperCase()+b.slice(1),_)),e.defines.forEach((_,b)=>i.defines.set(t+b.charAt(0).toUpperCase()+b.slice(1),_));const R=new Map([["fragment",a],["vertex",o]]);_u(t,M,i.defines),_u(t,M,R),a=R.get("fragment"),o=R.get("vertex");const E=e.blendMode;if(i.blendModes.set(E.blendFunction,E),f){e.inputColorSpace!==null&&e.inputColorSpace!==i.colorSpace&&(m+=e.inputColorSpace===Qe?`color0 = sRGBTransferOETF(color0);
	`:`color0 = sRGBToLinear(color0);
	`),e.outputColorSpace!==Iu?i.colorSpace=e.outputColorSpace:e.inputColorSpace!==null&&(i.colorSpace=e.inputColorSpace);const _=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;m+=`${t}MainImage(color0, UV, `,i.attributes&Rn.DEPTH&&_.test(a)&&(m+="depth, ",i.readDepth=!0),m+=`color1);
	`;const b=t+"BlendOpacity";i.uniforms.set(b,E.opacity),m+=`color0 = blend${E.blendFunction}(color0, color1, ${b});

	`,g+=`uniform float ${b};

`}if(g+=a+`
`,o!==null&&(y+=o+`
`),d.set(Pe.FRAGMENT_HEAD,g),d.set(Pe.FRAGMENT_MAIN_UV,v),d.set(Pe.FRAGMENT_MAIN_IMAGE,m),d.set(Pe.VERTEX_HEAD,y),d.set(Pe.VERTEX_MAIN_SUPPORT,x),e.extensions!==null)for(const _ of e.extensions)i.extensions.add(_)}}var vm=class extends Gt{constructor(t,...e){super("EffectPass"),this.fullscreenMaterial=new pm(null,null,null,t),this.listener=i=>this.handleEvent(i),this.effects=[],this.setEffects(e),this.skipRendering=!1,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY,this.timeScale=1}set mainScene(t){for(const e of this.effects)e.mainScene=t}set mainCamera(t){this.fullscreenMaterial.copyCameraSettings(t);for(const e of this.effects)e.mainCamera=t}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(t){this.fullscreenMaterial.encodeOutput=t}get dithering(){return this.fullscreenMaterial.dithering}set dithering(t){const e=this.fullscreenMaterial;e.dithering=t,e.needsUpdate=!0}setEffects(t){for(const e of this.effects)e.removeEventListener("change",this.listener);this.effects=t.sort((e,i)=>i.attributes-e.attributes);for(const e of this.effects)e.addEventListener("change",this.listener)}updateMaterial(){const t=new c0;let e=0;for(const c of this.effects)if(c.blendMode.blendFunction===Me.DST)t.attributes|=c.getAttributes()&Rn.DEPTH;else{if(t.attributes&c.getAttributes()&Rn.CONVOLUTION)throw new Error(`Convolution effects cannot be merged (${c.name})`);mm("e"+e++,c,t)}let i=t.shaderParts.get(Pe.FRAGMENT_HEAD),a=t.shaderParts.get(Pe.FRAGMENT_MAIN_IMAGE),o=t.shaderParts.get(Pe.FRAGMENT_MAIN_UV);const f=/\bblend\b/g;for(const c of t.blendModes.values())i+=c.getShaderCode().replace(f,`blend${c.blendFunction}`)+`
`;t.attributes&Rn.DEPTH?(t.readDepth&&(a=`float depth = readDepth(UV);

	`+a),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,t.colorSpace===Qe&&(a+=`color0 = sRGBToLinear(color0);
	`),t.uvTransformation?(o=`vec2 transformedUv = vUv;
`+o,t.defines.set("UV","transformedUv")):t.defines.set("UV","vUv"),t.shaderParts.set(Pe.FRAGMENT_HEAD,i),t.shaderParts.set(Pe.FRAGMENT_MAIN_IMAGE,a),t.shaderParts.set(Pe.FRAGMENT_MAIN_UV,o);for(const[c,p]of t.shaderParts)p!==null&&t.shaderParts.set(c,p.trim().replace(/^#/,`
#`));this.skipRendering=e===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderData(t)}recompile(){this.updateMaterial()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(t,e=rs){this.fullscreenMaterial.depthBuffer=t,this.fullscreenMaterial.depthPacking=e;for(const i of this.effects)i.setDepthTexture(t,e)}render(t,e,i,a,o){for(const f of this.effects)f.update(t,e,a);if(!this.skipRendering||this.renderToScreen){const f=this.fullscreenMaterial;f.inputBuffer=e.texture,f.time+=a*this.timeScale,t.setRenderTarget(this.renderToScreen?null:i),t.render(this.scene,this.camera)}}setSize(t,e){this.fullscreenMaterial.setSize(t,e);for(const i of this.effects)i.setSize(t,e)}initialize(t,e,i){this.renderer=t;for(const a of this.effects)a.initialize(t,e,i);this.updateMaterial(),i!==void 0&&i!==Mn&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const t of this.effects)t.removeEventListener("change",this.listener),t.dispose()}handleEvent(t){switch(t.type){case"change":this.recompile();break}}};const gm=`
varying vec2 vUv;
void main(){
  vUv = uv;
  gl_Position = vec4(position.xy, 0.0, 1.0);
}
`,ym=`
precision highp float;
uniform vec3 iResolution;
uniform float iTime;
uniform vec2 uSkew;
uniform float uTilt;
uniform float uYaw;
uniform float uLineThickness;
uniform vec3 uLinesColor;
uniform vec3 uScanColor;
uniform float uGridScale;
uniform float uLineStyle;
uniform float uLineJitter;
uniform float uScanOpacity;
uniform float uScanDirection;
uniform float uNoise;
uniform float uBloomOpacity;
uniform float uScanGlow;
uniform float uScanSoftness;
uniform float uPhaseTaper;
uniform float uCycleDuration;
varying vec2 vUv;

uniform float uScanStarts[8];
uniform float uScanCount;

const int MAX_SCANS = 8;

float smoother01(float a, float b, float x){
  float t = clamp((x - a) / max(1e-5, (b - a)), 0.0, 1.0);
  return t * t * t * (t * (t * 6.0 - 15.0) + 10.0);
}

void mainImage(out vec4 fragColor, in vec2 fragCoord)
{
    vec2 p = (2.0 * fragCoord - iResolution.xy) / iResolution.y;

    vec3 ro = vec3(0.0);
    vec3 rd = normalize(vec3(p, 2.0));

    float cR = cos(uTilt), sR = sin(uTilt);
    rd.xy = mat2(cR, -sR, sR, cR) * rd.xy;

    float cY = cos(uYaw), sY = sin(uYaw);
    rd.xz = mat2(cY, -sY, sY, cY) * rd.xz;

    vec2 skew = clamp(uSkew, vec2(-0.7), vec2(0.7));
    rd.xy += skew * rd.z;

    vec3 color = vec3(0.0);
  float minT = 1e20;
  float gridScale = max(1e-5, uGridScale);
    float fadeStrength = 2.0;
    vec2 gridUV = vec2(0.0);

  float hitIsY = 1.0;
    for (int i = 0; i < 4; i++)
    {
        float isY = float(i < 2);
        float pos = mix(-0.2, 0.2, float(i)) * isY + mix(-0.5, 0.5, float(i - 2)) * (1.0 - isY);
        float num = pos - (isY * ro.y + (1.0 - isY) * ro.x);
        float den = isY * rd.y + (1.0 - isY) * rd.x;
        float t = num / den;
        vec3 h = ro + rd * t;

        float depthBoost = smoothstep(0.0, 3.0, h.z);
        h.xy += skew * 0.15 * depthBoost;

    bool use = t > 0.0 && t < minT;
    gridUV = use ? mix(h.zy, h.xz, isY) / gridScale : gridUV;
    minT = use ? t : minT;
    hitIsY = use ? isY : hitIsY;
    }

    vec3 hit = ro + rd * minT;
    float dist = length(hit - ro);

  float jitterAmt = clamp(uLineJitter, 0.0, 1.0);
  if (jitterAmt > 0.0) {
    vec2 j = vec2(
      sin(gridUV.y * 2.7 + iTime * 1.8),
      cos(gridUV.x * 2.3 - iTime * 1.6)
    ) * (0.15 * jitterAmt);
    gridUV += j;
  }
  float fx = fract(gridUV.x);
  float fy = fract(gridUV.y);
  float ax = min(fx, 1.0 - fx);
  float ay = min(fy, 1.0 - fy);
  float wx = fwidth(gridUV.x);
  float wy = fwidth(gridUV.y);
  float halfPx = max(0.0, uLineThickness) * 0.5;

  float tx = halfPx * wx;
  float ty = halfPx * wy;

  float aax = wx;
  float aay = wy;

  float lineX = 1.0 - smoothstep(tx, tx + aax, ax);
  float lineY = 1.0 - smoothstep(ty, ty + aay, ay);
  if (uLineStyle > 0.5) {
    float dashRepeat = 4.0;
    float dashDuty = 0.5;
    float vy = fract(gridUV.y * dashRepeat);
    float vx = fract(gridUV.x * dashRepeat);
    float dashMaskY = step(vy, dashDuty);
    float dashMaskX = step(vx, dashDuty);
    if (uLineStyle < 1.5) {
      lineX *= dashMaskY;
      lineY *= dashMaskX;
    } else {
      float dotRepeat = 6.0;
      float dotWidth = 0.18;
      float cy = abs(fract(gridUV.y * dotRepeat) - 0.5);
      float cx = abs(fract(gridUV.x * dotRepeat) - 0.5);
      float dotMaskY = 1.0 - smoothstep(dotWidth, dotWidth + fwidth(gridUV.y * dotRepeat), cy);
      float dotMaskX = 1.0 - smoothstep(dotWidth, dotWidth + fwidth(gridUV.x * dotRepeat), cx);
      lineX *= dotMaskY;
      lineY *= dotMaskX;
    }
  }
  float primaryMask = max(lineX, lineY);

  vec2 gridUV2 = (hitIsY > 0.5 ? hit.xz : hit.zy) / gridScale;
  if (jitterAmt > 0.0) {
    vec2 j2 = vec2(
      cos(gridUV2.y * 2.1 - iTime * 1.4),
      sin(gridUV2.x * 2.5 + iTime * 1.7)
    ) * (0.15 * jitterAmt);
    gridUV2 += j2;
  }
  float fx2 = fract(gridUV2.x);
  float fy2 = fract(gridUV2.y);
  float ax2 = min(fx2, 1.0 - fx2);
  float ay2 = min(fy2, 1.0 - fy2);
  float wx2 = fwidth(gridUV2.x);
  float wy2 = fwidth(gridUV2.y);
  float tx2 = halfPx * wx2;
  float ty2 = halfPx * wy2;
  float aax2 = wx2;
  float aay2 = wy2;
  float lineX2 = 1.0 - smoothstep(tx2, tx2 + aax2, ax2);
  float lineY2 = 1.0 - smoothstep(ty2, ty2 + aay2, ay2);
  if (uLineStyle > 0.5) {
    float dashRepeat2 = 4.0;
    float dashDuty2 = 0.5;
    float vy2m = fract(gridUV2.y * dashRepeat2);
    float vx2m = fract(gridUV2.x * dashRepeat2);
    float dashMaskY2 = step(vy2m, dashDuty2);
    float dashMaskX2 = step(vx2m, dashDuty2);
    if (uLineStyle < 1.5) {
      lineX2 *= dashMaskY2;
      lineY2 *= dashMaskX2;
    } else {
      float dotRepeat2 = 6.0;
      float dotWidth2 = 0.18;
      float cy2 = abs(fract(gridUV2.y * dotRepeat2) - 0.5);
      float cx2 = abs(fract(gridUV2.x * dotRepeat2) - 0.5);
      float dotMaskY2 = 1.0 - smoothstep(dotWidth2, dotWidth2 + fwidth(gridUV2.y * dotRepeat2), cy2);
      float dotMaskX2 = 1.0 - smoothstep(dotWidth2, dotWidth2 + fwidth(gridUV2.x * dotRepeat2), cx2);
      lineX2 *= dotMaskY2;
      lineY2 *= dotMaskX2;
    }
  }
    float altMask = max(lineX2, lineY2);

    float edgeDistX = min(abs(hit.x - (-0.5)), abs(hit.x - 0.5));
    float edgeDistY = min(abs(hit.y - (-0.2)), abs(hit.y - 0.2));
    float edgeDist = mix(edgeDistY, edgeDistX, hitIsY);
    float edgeGate = 1.0 - smoothstep(gridScale * 0.5, gridScale * 2.0, edgeDist);
    altMask *= edgeGate;

  float lineMask = max(primaryMask, altMask);

    float fade = exp(-dist * fadeStrength);

    // 
    float cycleDur = max(1.0, uCycleDuration);
    float scanZMax = 2.0;
    float widthScale = max(0.1, uScanGlow);
    float sigma = max(0.001, 0.18 * widthScale * uScanSoftness);
    float sigmaA = sigma * 2.0;

    float combinedPulse = 0.0;
    float combinedAura = 0.0;

    // 
    float tCycle = mod(iTime, cycleDur);
    float scanPhase = tCycle / cycleDur;
    float phase = scanPhase;
    if (uScanDirection > 0.5 && uScanDirection < 1.5) {
      phase = 1.0 - phase;
    } else if (uScanDirection > 1.5) {
      // 
      phase = (scanPhase < 0.5) ? (scanPhase * 2.0) : (1.0 - (scanPhase - 0.5) * 2.0);
    }
    float scanZ = phase * scanZMax;
    float dz = abs(hit.z - scanZ);
    float lineBand = exp(-0.5 * (dz * dz) / (sigma * sigma));
    float taper = clamp(uPhaseTaper, 0.0, 0.49);
    float headW = taper;
    float tailW = taper;
    float headFade = smoother01(0.0, headW, phase);
    float tailFade = 1.0 - smoother01(1.0 - tailW, 1.0, phase);
    float phaseWindow = headFade * tailFade;
    float pulseBase = lineBand * phaseWindow;
    combinedPulse += pulseBase * clamp(uScanOpacity, 0.0, 1.0);
    float auraBand = exp(-0.5 * (dz * dz) / (sigmaA * sigmaA));
    combinedAura += (auraBand * 0.25) * phaseWindow * clamp(uScanOpacity, 0.0, 1.0);

    for (int i = 0; i < MAX_SCANS; i++) {
      if (float(i) >= uScanCount) break;
      float tActiveI = iTime - uScanStarts[i];
      float phaseI = clamp(tActiveI / cycleDur, 0.0, 1.0);
      if (uScanDirection > 0.5 && uScanDirection < 1.5) {
        phaseI = 1.0 - phaseI;
      } else if (uScanDirection > 1.5) {
        phaseI = (phaseI < 0.5) ? (phaseI * 2.0) : (1.0 - (phaseI - 0.5) * 2.0);
      }
      float scanZI = phaseI * scanZMax;
      float dzI = abs(hit.z - scanZI);
      float lineBandI = exp(-0.5 * (dzI * dzI) / (sigma * sigma));
      float headFadeI = smoother01(0.0, headW, phaseI);
      float tailFadeI = 1.0 - smoother01(1.0 - tailW, 1.0, phaseI);
      float phaseWindowI = headFadeI * tailFadeI;
      combinedPulse += lineBandI * phaseWindowI * clamp(uScanOpacity, 0.0, 1.0);
      float auraBandI = exp(-0.5 * (dzI * dzI) / (sigmaA * sigmaA));
      combinedAura += (auraBandI * 0.25) * phaseWindowI * clamp(uScanOpacity, 0.0, 1.0);
    }

  float lineVis = lineMask;
  vec3 gridCol = uLinesColor * lineVis * fade;
  vec3 scanCol = uScanColor * combinedPulse;
  vec3 scanAura = uScanColor * combinedAura;

    color = gridCol + scanCol + scanAura;

  float n = fract(sin(dot(gl_FragCoord.xy + vec2(iTime * 123.4), vec2(12.9898,78.233))) * 43758.5453123);
  color += (n - 0.5) * uNoise;
  color = clamp(color, 0.0, 1.0);
  float alpha = clamp(max(lineVis, combinedPulse), 0.0, 1.0);
  float gx = 1.0 - smoothstep(tx * 2.0, tx * 2.0 + aax * 2.0, ax);
  float gy = 1.0 - smoothstep(ty * 2.0, ty * 2.0 + aay * 2.0, ay);
  float halo = max(gx, gy) * fade;
  alpha = max(alpha, halo * clamp(uBloomOpacity, 0.0, 1.0));
  fragColor = vec4(color, alpha);
}

void main(){
  vec4 c;
  mainImage(c, vUv * iResolution.xy);
  gl_FragColor = c;
}
`,xm=({sensitivity:t=.55,lineThickness:e=1,linesColor:i="#392e4e",scanColor:a="#FF9FFC",scanOpacity:o=.4,gridScale:f=.1,lineStyle:c="solid",lineJitter:p=.1,scanDirection:d="pingpong",enablePost:g=!0,bloomIntensity:v=0,bloomThreshold:m=0,bloomSmoothing:y=0,chromaticAberration:x=.002,noiseIntensity:w=.01,scanGlow:M=.5,scanSoftness:R=2,scanPhaseTaper:E=.9,cycleDuration:_=60,enableGyro:b=!1,scanOnClick:A=!1,snapBackDelay:D=250,frozen:L=!1})=>{const O=T.useRef(null),G=T.useRef(null),W=T.useRef(null),P=T.useRef(null),z=T.useRef(null),V=T.useRef(null),X=T.useRef(null),N=T.useRef(L),Z=T.useRef(0),J=T.useRef(new Ce(0,0)),te=T.useRef(0),k=T.useRef(0),F=T.useRef(new Ce(0,0)),U=T.useRef(new Ce(0,0)),j=T.useRef(0),q=T.useRef(0),$=T.useRef(0),K=T.useRef(0),ie=8,oe=T.useRef([]);T.useEffect(()=>{N.current=L},[L]);const me=ve=>{const se=oe.current.slice();if(se.length>=ie&&se.shift(),se.push(ve),oe.current=se,W.current){const ze=W.current.uniforms,De=new Array(ie).fill(0);for(let Ge=0;Ge<se.length&&Ge<ie;Ge++)De[Ge]=se[Ge];ze.uScanStarts.value=De,ze.uScanCount.value=se.length}},de=Jt.clamp(t,0,1),xe=Jt.lerp(.06,.2,de),he=Jt.lerp(.12,.3,de),ae=Jt.lerp(.1,.28,de),we=Jt.lerp(.45,.12,de),ue=1/0,Se=Jt.lerp(1.2,1.6,de);return T.useEffect(()=>{const ve=O.current;if(!ve)return;let se=null;const ze=At=>{se&&(clearTimeout(se),se=null);const gt=ve.getBoundingClientRect(),on=(At.clientX-gt.left)/gt.width*2-1,Rt=-((At.clientY-gt.top)/gt.height*2-1);J.current.set(on,Rt)},De=async()=>{const At=performance.now()/1e3;if(A&&me(At),b&&typeof window<"u"&&window.DeviceOrientationEvent&&DeviceOrientationEvent.requestPermission)try{await DeviceOrientationEvent.requestPermission()}catch{}},Ge=()=>{se&&(clearTimeout(se),se=null)},et=()=>{se&&clearTimeout(se),se=window.setTimeout(()=>{J.current.set(0,0),te.current=0,k.current=0},Math.max(0,D||0))};return ve.addEventListener("mousemove",ze),ve.addEventListener("mouseenter",Ge),A&&ve.addEventListener("click",De),ve.addEventListener("mouseleave",et),()=>{ve.removeEventListener("mousemove",ze),ve.removeEventListener("mouseenter",Ge),ve.removeEventListener("mouseleave",et),A&&ve.removeEventListener("click",De),se&&clearTimeout(se)}},[D,A,b]),T.useEffect(()=>{const ve=O.current;if(!ve)return;const se=new Wr({antialias:!0,alpha:!0,preserveDrawingBuffer:!0});G.current=se,se.setPixelRatio(Math.min(window.devicePixelRatio||1,2)),se.setSize(ve.clientWidth,ve.clientHeight),se.outputColorSpace=Qe,se.toneMapping=ku,se.autoClear=!1,se.setClearColor(0,0),ve.appendChild(se.domElement);const ze={iResolution:{value:new Le(ve.clientWidth,ve.clientHeight,se.getPixelRatio())},iTime:{value:0},uSkew:{value:new Ce(0,0)},uTilt:{value:0},uYaw:{value:0},uLineThickness:{value:e},uLinesColor:{value:Qi(i)},uScanColor:{value:Qi(a)},uGridScale:{value:f},uLineStyle:{value:c==="dashed"?1:c==="dotted"?2:0},uLineJitter:{value:Math.max(0,Math.min(1,p||0))},uScanOpacity:{value:o},uNoise:{value:w},uBloomOpacity:{value:v},uScanGlow:{value:M},uScanSoftness:{value:R},uPhaseTaper:{value:E},uCycleDuration:{value:_},uScanDirection:{value:d==="backward"?1:d==="pingpong"?2:0},uScanStarts:{value:new Array(ie).fill(0)},uScanCount:{value:0}},De=new Ht({uniforms:ze,vertexShader:gm,fragmentShader:ym,transparent:!0,depthWrite:!1,depthTest:!1});W.current=De;const Ge=new an,et=new Gr(-1,1,1,-1,0,1),At=new nt(new Yl(2,2),De);Ge.add(At);let gt=null;if(g){gt=new u0(se),P.current=gt;const yt=new fm(Ge,et);gt.addPass(yt);const Ze=new am({intensity:1,luminanceThreshold:m,luminanceSmoothing:y});Ze.blendMode.opacity.value=Math.max(0,v),z.current=Ze;const ft=new cm({offset:new Ce(x,x),radialModulation:!0,modulationOffset:0});V.current=ft;const Nt=new vm(et,Ze,ft);Nt.renderToScreen=!0,gt.addPass(Nt)}const on=()=>{se.setSize(ve.clientWidth,ve.clientHeight),De.uniforms.iResolution.value.set(ve.clientWidth,ve.clientHeight,se.getPixelRatio()),P.current&&P.current.setSize(ve.clientWidth,ve.clientHeight)};window.addEventListener("resize",on);let Rt=performance.now();const Dn=()=>{const yt=performance.now(),Ze=Math.max(0,Math.min(.1,(yt-Rt)/1e3));Rt=yt,N.current||(Z.current+=Ze),F.current.copy(wm(F.current,J.current,U.current,we,ue,Ze));const ft=Tu(j.current,te.current,{v:q.current},we,ue,Ze);j.current=ft.value,q.current=ft.v;const Nt=Tu($.current,k.current,{v:K.current},we,ue,Ze);$.current=Nt.value,K.current=Nt.v;const un=new Ce(F.current.x*xe,-F.current.y*Se*xe);De.uniforms.uSkew.value.set(un.x,un.y),De.uniforms.uTilt.value=j.current*he,De.uniforms.uYaw.value=Jt.clamp($.current*ae,-.6,.6),De.uniforms.iTime.value=Z.current,se.clear(!0,!0,!0),P.current?P.current.render(Ze):se.render(Ge,et),X.current=requestAnimationFrame(Dn)};return X.current=requestAnimationFrame(Dn),()=>{X.current&&cancelAnimationFrame(X.current),window.removeEventListener("resize",on),De.dispose(),At.geometry.dispose(),P.current&&(P.current.dispose(),P.current=null),se.dispose(),ve.removeChild(se.domElement)}},[t,e,i,a,o,f,c,p,d,g,w,v,M,R,E,_,m,y,x,we,ue,xe,Se,he,ae]),T.useEffect(()=>{const ve=W.current;if(ve){const se=ve.uniforms;se.uLineThickness.value=e,se.uLinesColor.value.copy(Qi(i)),se.uScanColor.value.copy(Qi(a)),se.uGridScale.value=f,se.uLineStyle.value=c==="dashed"?1:c==="dotted"?2:0,se.uLineJitter.value=Math.max(0,Math.min(1,p||0)),se.uBloomOpacity.value=Math.max(0,v),se.uNoise.value=Math.max(0,w),se.uScanGlow.value=M,se.uScanOpacity.value=Math.max(0,Math.min(1,o)),se.uScanDirection.value=d==="backward"?1:d==="pingpong"?2:0,se.uScanSoftness.value=R,se.uPhaseTaper.value=E,se.uCycleDuration.value=Math.max(1,_)}z.current&&(z.current.blendMode.opacity.value=Math.max(0,v),z.current.luminanceMaterial.threshold=m,z.current.luminanceMaterial.smoothing=y),V.current&&V.current.offset.set(x,x)},[e,i,a,f,c,p,v,m,y,x,w,M,o,d,R,E,_]),T.useEffect(()=>{if(!b)return;const ve=se=>{const ze=se.gamma??0,De=se.beta??0,Ge=Jt.clamp(ze/45,-1,1),et=Jt.clamp(-De/30,-1,1);J.current.set(Ge,et),te.current=Jt.degToRad(ze)*.4};return window.addEventListener("deviceorientation",ve),()=>{window.removeEventListener("deviceorientation",ve)}},[b]),S.jsx("div",{ref:O,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"}})};function Qi(t){return new or(t).convertSRGBToLinear()}function wm(t,e,i,a,o,f){const c=t.clone();a=Math.max(1e-4,a);const p=2/a,d=p*f,g=1/(1+d+.48*d*d+.235*d*d*d);let v=t.clone().sub(e);const m=e.clone(),y=o*a;v.length()>y&&v.setLength(y),e=t.clone().sub(v);const x=i.clone().addScaledVector(v,p).multiplyScalar(f);i.sub(x.clone().multiplyScalar(p)),i.multiplyScalar(g),c.copy(e.clone().add(v.add(x).multiplyScalar(g)));const w=m.clone().sub(t),M=c.clone().sub(m);return w.dot(M)>0&&(c.copy(m),i.set(0,0)),c}function Tu(t,e,i,a,o,f){a=Math.max(1e-4,a);const c=2/a,p=c*f,d=1/(1+p+.48*p*p+.235*p*p*p);let g=t-e;const v=e,m=o*a;g=Math.sign(g)*Math.min(Math.abs(g),m),e=t-g;const y=(i.v+c*g)*f;i.v=(i.v-c*y)*d;let x=e+(g+y)*d;const w=v-t,M=x-v;return w*M>0&&(x=v,i.v=0),{value:x,v:i.v}}const Sm={name:"GridScan",nameCn:"",icon:"",description:"3D",params:[{key:"sensitivity",label:"",type:"range",min:0,max:1,step:.05,default:.55},{key:"lineThickness",label:"",type:"range",min:.5,max:3,step:.1,default:1},{key:"gridScale",label:"",type:"range",min:.05,max:.3,step:.01,default:.1},{key:"lineJitter",label:"",type:"range",min:0,max:1,step:.05,default:.1},{key:"scanOpacity",label:"",type:"range",min:0,max:1,step:.05,default:.4},{key:"scanGlow",label:"",type:"range",min:.1,max:2,step:.1,default:.5},{key:"scanSoftness",label:"",type:"range",min:.5,max:4,step:.1,default:2},{key:"cycleDuration",label:"()",type:"range",min:30,max:120,step:5,default:60,hint:""},{key:"noiseIntensity",label:"",type:"range",min:0,max:.1,step:.005,default:.01},{key:"bloomIntensity",label:"",type:"range",min:0,max:1,step:.05,default:0},{key:"chromaticAberration",label:"",type:"range",min:0,max:.01,step:.001,default:.002},{key:"snapBackDelay",label:"(ms)",type:"range",min:0,max:1e3,step:50,default:250},{key:"lineStyle",label:"",type:"select",options:[{value:"solid",label:""},{value:"dashed",label:""},{value:"dotted",label:""}],default:"solid"},{key:"scanDirection",label:"",type:"select",options:[{value:"forward",label:""},{value:"backward",label:""},{value:"pingpong",label:""}],default:"pingpong"},{key:"scanOnClick",label:"",type:"toggle",default:!1},{key:"enableGyro",label:"",type:"toggle",default:!1},{key:"enablePost",label:"",type:"toggle",default:!0},{key:"linesColor",label:"",type:"color",default:"#392e4e"},{key:"scanColor",label:"",type:"color",default:"#FF9FFC"}]},Bn={GradientBlinds:{component:Np,config:Ip},Aurora:{component:vh,config:gh},Prism:{component:yh,config:xh},Beams:{component:Sp,config:Ep},ColorBends:{component:Cp,config:_p},Galaxy:{component:Pp,config:kp},LightRays:{component:Fp,config:Bp},LaserFlow:{component:jp,config:Hp},PrismaticBurst:{component:Xp,config:Yp},Ballpit:{component:Jp,config:$p},RippleGrid:{component:e0,config:t0},GridScan:{component:xm,config:Sm}},Em=[{id:"GradientBlinds",name:"Gradient Blinds",nameCn:"",icon:""},{id:"PrismaticBurst",name:"Prismatic Burst",nameCn:"",icon:""},{id:"Prism",name:"Prism",nameCn:"",icon:""},{id:"Beams",name:"Beams",nameCn:"",icon:""},{id:"ColorBends",name:"Color Bends",nameCn:"",icon:""},{id:"Galaxy",name:"Galaxy",nameCn:"",icon:""},{id:"LightRays",name:"Light Rays",nameCn:"",icon:""},{id:"LaserFlow",name:"Laser Flow",nameCn:"",icon:""},{id:"Ballpit",name:"Ballpit",nameCn:"",icon:""},{id:"RippleGrid",name:"Ripple Grid",nameCn:"",icon:""},{id:"GridScan",name:"Grid Scan",nameCn:"",icon:""},{id:"Aurora",name:"Aurora",nameCn:"",icon:""}],Rm=({backgrounds:t,backgroundList:e,selectedBackground:i,onSelectBackground:a,params:o,onParamChange:f,onResetParams:c,onRandomizeParams:p,onRandomizeCurrentParams:d,backgroundColor:g,onBackgroundColorChange:v,onCopyCode:m,children:y})=>{const x=t[i],w=x==null?void 0:x.config,[M,R]=T.useState(!1),[E,_]=T.useState(!1),b=e.map(O=>({id:O.id,name:O.name.toLowerCase(),nameCn:O.nameCn,icon:O.icon})),A=O=>{var W;const G=o[O.key]??O.default;switch(O.type){case"range":return S.jsxs("div",{className:"control-item",children:[S.jsxs("label",{className:"control-label",children:[S.jsx("span",{children:O.label}),S.jsx("span",{className:"control-value",children:typeof G=="number"?G.toFixed(O.step<1?((W=String(O.step).split(".")[1])==null?void 0:W.length)||2:0):G})]}),S.jsx("input",{type:"range",min:O.min,max:O.max,step:O.step,value:G,onChange:P=>f(O.key,parseFloat(P.target.value))})]},O.key);case"toggle":return S.jsx("div",{className:"control-item toggle-item",children:S.jsxs("label",{className:"control-label",children:[S.jsx("span",{children:O.label}),S.jsx("div",{className:`toggle-switch ${G?"active":""}`,onClick:()=>f(O.key,!G)})]})},O.key);case"color":return S.jsxs("div",{className:"control-item",children:[S.jsxs("label",{className:"control-label",children:[S.jsx("span",{children:O.label}),S.jsx("span",{className:"control-value",children:G})]}),S.jsxs("div",{className:"color-picker-wrapper",children:[S.jsx("input",{type:"color",className:"color-picker-input",value:G,onChange:P=>f(O.key,P.target.value)}),S.jsx("span",{className:"color-hex",children:G})]})]},O.key);case"colors":return S.jsxs("div",{className:"control-item",children:[S.jsx("label",{className:"control-label",children:S.jsx("span",{children:O.label})}),S.jsxs("div",{className:"color-picker-group",children:[(G||O.default).map((P,z)=>{var V;return S.jsxs("div",{className:"color-picker-item",children:[S.jsx("input",{type:"color",className:"color-picker-input",value:(V=P.startsWith)!=null&&V.call(P,"rgba")?"#6366f1":P,onChange:X=>{const N=[...G||O.default];N[z]=X.target.value,f(O.key,N)}}),S.jsx("button",{className:"color-remove-btn",onClick:()=>{const X=[...G||O.default];X.length>1&&(X.splice(z,1),f(O.key,X))},children:""})]},z)}),S.jsx("button",{className:"color-add-btn",onClick:()=>{const P=[...G||O.default,"#ffffff"];f(O.key,P)},children:"+"})]})]},O.key);case"select":return S.jsxs("div",{className:"control-item",children:[S.jsx("label",{className:"control-label",children:S.jsx("span",{children:O.label})}),S.jsx("select",{className:"control-select",value:G,onChange:P=>{const z=P.target.value;f(O.key,isNaN(Number(z))?z:Number(z))},children:O.options.map(P=>S.jsx("option",{value:typeof P=="object"?P.value:P,children:typeof P=="object"?P.label:P},typeof P=="object"?P.value:P))})]},O.key);case"switch":return S.jsx("div",{className:"control-item toggle-item",children:S.jsxs("label",{className:"control-label",children:[S.jsx("span",{children:O.label}),S.jsx("div",{className:`toggle-switch ${G?"active":""}`,onClick:()=>f(O.key,!G)})]})},O.key);default:return null}},D=()=>{const O=Object.entries(o).filter(([G,W])=>W!==void 0).map(([G,W])=>typeof W=="string"?`  ${G}="${W}"`:Array.isArray(W)?`  ${G}={${JSON.stringify(W)}}`:typeof W=="boolean"?`  ${G}={${W}}`:`  ${G}={${W}}`).join(`
`);return`import { ${i} } from './backgrounds'

<${i}
${O}
/>`},L=b.find(O=>O.id===i)||b[0];return S.jsxs("div",{className:"control-panel",children:[S.jsxs("div",{className:"panel-header",children:[S.jsx("div",{className:"logo-icon",children:S.jsx("img",{src:"/favicon.png",alt:"logo",width:"80",height:"80",style:{borderRadius:"12px"}})}),S.jsxs("div",{className:"panel-title-group",children:[S.jsx("span",{className:"logo-text",children:""}),S.jsx("p",{className:"panel-subtitle",children:""})]})]}),S.jsxs("div",{className:"background-selector",children:[S.jsx("div",{className:"selector-label",children:" / Select Background"}),S.jsxs("div",{className:"dropdown-container",children:[S.jsxs("button",{className:"dropdown-trigger",onClick:()=>R(!M),children:[S.jsx("span",{className:"dropdown-icon",children:(L==null?void 0:L.icon)||""}),S.jsxs("span",{className:"dropdown-text",children:[S.jsx("span",{className:"dropdown-name",children:L==null?void 0:L.name}),S.jsxs("span",{className:"dropdown-name-cn",children:["/ ",L==null?void 0:L.nameCn]})]}),S.jsx("span",{className:`dropdown-arrow ${M?"open":""}`,children:S.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"currentColor",children:S.jsx("path",{d:"M3 4.5L6 7.5L9 4.5",stroke:"currentColor",strokeWidth:"1.5",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),S.jsxs("button",{className:"shuffle-btn",onClick:p,title:" - ",children:[S.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[S.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),S.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5",fill:"currentColor"}),S.jsx("circle",{cx:"15.5",cy:"8.5",r:"1.5",fill:"currentColor"}),S.jsx("circle",{cx:"8.5",cy:"15.5",r:"1.5",fill:"currentColor"}),S.jsx("circle",{cx:"15.5",cy:"15.5",r:"1.5",fill:"currentColor"}),S.jsx("circle",{cx:"12",cy:"12",r:"1.5",fill:"currentColor"})]}),S.jsx("span",{children:""})]}),M&&S.jsx("div",{className:"dropdown-menu",children:b.map(O=>S.jsxs("button",{className:`dropdown-item ${i===O.id?"active":""}`,onClick:()=>{a(O.id),R(!1)},children:[S.jsx("span",{className:"dropdown-item-icon",children:O.icon}),S.jsxs("span",{className:"dropdown-item-text",children:[S.jsx("span",{className:"dropdown-item-name",children:O.name}),S.jsxs("span",{className:"dropdown-item-name-cn",children:["/ ",O.nameCn]})]}),i===O.id&&S.jsx("span",{className:"dropdown-item-check",children:""})]},O.id))})]})]}),S.jsx("div",{className:"controls-section",children:w&&S.jsxs("div",{className:"control-group",children:[S.jsxs("div",{className:"control-group-header",children:[S.jsxs("h3",{className:"control-group-title",children:[S.jsx("span",{className:"control-group-icon",children:w.icon}),S.jsxs("span",{children:[w.nameCn||w.name," "]})]}),S.jsxs("div",{className:"control-group-actions",children:[S.jsxs("button",{className:"action-btn random-btn",onClick:d,title:"",children:[S.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[S.jsx("path",{d:"M18 4L21 7L18 10"}),S.jsx("path",{d:"M3 7H21"}),S.jsx("path",{d:"M6 20L3 17L6 14"}),S.jsx("path",{d:"M21 17H3"})]}),S.jsx("span",{children:""})]}),S.jsxs("button",{className:"action-btn reset-btn",onClick:c,title:"",children:[S.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[S.jsx("path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"}),S.jsx("path",{d:"M3 3v5h5"})]}),S.jsx("span",{children:""})]})]})]}),S.jsxs("div",{className:"controls-grid",children:[w.params.map(A),S.jsxs("div",{className:"control-item",children:[S.jsxs("label",{className:"control-label",children:[S.jsx("span",{children:""}),S.jsx("span",{className:"control-value",children:g})]}),S.jsxs("div",{className:"color-picker-wrapper",children:[S.jsx("input",{type:"color",className:"color-picker-input",value:g,onChange:O=>v(O.target.value)}),S.jsx("span",{className:"color-hex",children:g})]})]})]})]})}),y,S.jsxs("div",{className:`code-section ${E?"expanded":"collapsed"}`,children:[S.jsx("div",{className:"section-header clickable",onClick:()=>_(!E),children:S.jsxs("div",{className:"section-header-left",children:[S.jsx("span",{className:`expand-arrow ${E?"open":""}`,children:S.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"currentColor",children:S.jsx("path",{d:"M3 4.5L6 7.5L9 4.5",stroke:"currentColor",strokeWidth:"1.5",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})}),S.jsx("span",{className:"section-title",children:""}),E&&S.jsxs("button",{className:"copy-btn",onClick:O=>{O.stopPropagation(),m(D())},children:[S.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[S.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),S.jsx("path",{d:"M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"})]}),""]})]})}),E&&S.jsx("div",{className:"code-block",children:S.jsx("pre",{children:D()})})]})]})},Mm=({text:t,fontSize:e,fontFamily:i,fontWeight:a,color:o,textShadow:f,opacity:c,position:p,rotation:d,textAlign:g,onPositionChange:v,isEditing:m,onStartEdit:y,onTextChange:x,containerRef:w})=>{const M=T.useRef(null),[R,E]=T.useState(!1),[_,b]=T.useState({x:0,y:0}),[A,D]=T.useState(!1),[L,O]=T.useState(e),[G,W]=T.useState({x:0,y:0}),P=T.useCallback(F=>{F.target.classList.contains("resize-handle")||m||(F.preventDefault(),F.stopPropagation(),E(!0),b({x:F.clientX-p.x,y:F.clientY-p.y}))},[p,m]),z=T.useCallback(F=>{if(R){const U=w==null?void 0:w.current;if(!U)return;const j=U.getBoundingClientRect();let q=F.clientX-_.x,$=F.clientY-_.y;const K=M.current;if(K){const ie=K.getBoundingClientRect(),oe=j.width-ie.width/2,me=j.height-ie.height/2,de=-ie.width/2,xe=-ie.height/2;q=Math.max(de,Math.min(oe,q)),$=Math.max(xe,Math.min(me,$))}v({x:q,y:$})}if(A){const U=F.clientX-G.x,j=Math.max(12,Math.min(500,L+U*.5));x("fontSize",j)}},[R,A,_,G,L,w,v,x]),V=T.useCallback(()=>{E(!1),D(!1)},[]),X=T.useCallback(F=>{F.preventDefault(),F.stopPropagation(),D(!0),O(e),W({x:F.clientX,y:F.clientY})},[e]),N=T.useCallback(F=>{F.stopPropagation(),y()},[y]);T.useEffect(()=>{if(R||A)return window.addEventListener("mousemove",z),window.addEventListener("mouseup",V),()=>{window.removeEventListener("mousemove",z),window.removeEventListener("mouseup",V)}},[R,A,z,V]);const Z=T.useCallback(F=>{if(m)return;const U=F.touches[0];E(!0),b({x:U.clientX-p.x,y:U.clientY-p.y})},[p,m]),J=T.useCallback(F=>{if(!R)return;const U=F.touches[0],j=w==null?void 0:w.current;if(!j)return;j.getBoundingClientRect();let q=U.clientX-_.x,$=U.clientY-_.y;v({x:q,y:$})},[R,_,w,v]),te=T.useCallback(()=>{E(!1)},[]),k=()=>!f||!f.enabled?"none":`${f.offsetX||0}px ${f.offsetY||0}px ${f.blur||0}px ${f.color||"rgba(0,0,0,0.5)"}`;return t?S.jsxs("div",{ref:M,className:`text-overlay ${R?"dragging":""} ${m?"editing":""}`,style:{position:"absolute",left:p.x,top:p.y,transform:`rotate(${d||0}deg)`,fontSize:`${e}px`,fontFamily:i||"system-ui",fontWeight:a||"normal",color:o||"#ffffff",textShadow:k(),opacity:c??1,cursor:R?"grabbing":"grab",userSelect:"none",whiteSpace:"pre-wrap",textAlign:g||"center",zIndex:100,padding:"8px 12px",borderRadius:"4px",transition:R?"none":"box-shadow 0.2s ease"},onMouseDown:P,onDoubleClick:N,onTouchStart:Z,onTouchMove:J,onTouchEnd:te,children:[t,!m&&S.jsx("div",{className:"resize-handle",style:{position:"absolute",right:-8,bottom:-8,width:16,height:16,background:"var(--accent-primary, #8b5cf6)",borderRadius:"50%",cursor:"se-resize",opacity:0,transition:"opacity 0.2s ease"},onMouseDown:X})]}):null},Ll=[{label:"16:9",value:"16:9",ratio:16/9},{label:"9:16",value:"9:16",ratio:9/16},{label:"4:3",value:"4:3",ratio:4/3},{label:"3:4",value:"3:4",ratio:3/4},{label:"1:1",value:"1:1",ratio:1},{label:"7501624",value:"750x1624",ratio:750/1624,fixedWidth:750,fixedHeight:1624},{label:"",value:"auto",width:null,height:null}],dc=T.forwardRef(({BackgroundComponent:t,params:e,isRecording:i,backgroundName:a,backgroundColor:o,textConfig:f,onTextPositionChange:c,onTextChange:p,isTextEditing:d,onStartTextEdit:g,onEndTextEdit:v,onExportImage:m,onExportVideo:y,recordingProgress:x,isFrozen:w,onToggleFreeze:M,videoDuration:R},E)=>{const[_,b]=T.useState("16:9"),[A,D]=T.useState(!1),L=T.useRef(null);T.useEffect(()=>{if(f!=null&&f.enabled&&L.current&&f.position.x===0&&f.position.y===0){const z=L.current.getBoundingClientRect();c({x:60,y:z.height/2})}},[f==null?void 0:f.enabled]);const O=Ll.find(z=>z.value===_)||Ll[0],G=()=>{const z={backgroundColor:o||"#000000"};if(_==="auto")return{...z,width:"100%",height:"100%"};const V=O.ratio;return V>=1?{...z,width:"100%",height:"auto",aspectRatio:`${V}`}:{...z,width:"auto",height:"100%",aspectRatio:`${V}`}},W=z=>{L.current=z,typeof E=="function"?E(z):E&&(E.current=z)},P=z=>{if(d){v();return}z.target.closest(".preview-overlay")||M()};return S.jsxs("div",{className:"preview-container",onClick:P,children:[S.jsx("div",{className:"preview-wrapper",children:S.jsxs("div",{className:`preview-frame ${_!=="auto"?"fixed-ratio":""} ${w?"frozen":""}`,ref:W,style:G(),children:[t&&S.jsx(t,{...e,frozen:w},`${_}-${a}`),(f==null?void 0:f.enabled)&&(f==null?void 0:f.text)&&S.jsx(Mm,{text:f.text,fontSize:f.fontSize,fontFamily:f.fontFamily,fontWeight:f.fontWeight,color:f.color,textShadow:f.textShadow,opacity:f.opacity,position:f.position,rotation:f.rotation,textAlign:f.textAlign,onPositionChange:c,isEditing:d,onStartEdit:g,onTextChange:p,containerRef:L}),w&&S.jsxs("div",{className:"frozen-indicator",children:[S.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[S.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),S.jsx("path",{d:"M7 11V7a5 5 0 0110 0v4"})]}),S.jsx("span",{children:"  "})]})]})}),S.jsxs("div",{className:"preview-overlay",children:[S.jsxs("div",{className:"ratio-dropdown-container",children:[S.jsxs("button",{className:"ratio-dropdown-trigger",onClick:()=>D(!A),children:[S.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[S.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),S.jsx("path",{d:"M9 3v18M3 9h18"})]}),S.jsx("span",{children:O.label}),S.jsx("svg",{className:`ratio-arrow ${A?"open":""}`,width:"10",height:"10",viewBox:"0 0 12 12",children:S.jsx("path",{d:"M3 4.5L6 7.5L9 4.5",stroke:"currentColor",strokeWidth:"1.5",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})]}),A&&S.jsx("div",{className:"ratio-dropdown-menu ratio-dropdown-menu-up",children:Ll.map(z=>S.jsxs("button",{className:`ratio-dropdown-item ${_===z.value?"active":""}`,onClick:()=>{b(z.value),D(!1)},children:[S.jsx("span",{children:z.label}),_===z.value&&S.jsx("span",{className:"ratio-check",children:""})]},z.value))})]}),S.jsxs("button",{className:"export-pill-btn",onClick:m,children:[S.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[S.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),S.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),S.jsx("polyline",{points:"21,15 16,10 5,21"})]}),S.jsx("span",{children:""})]}),S.jsx("button",{className:`export-pill-btn ${i?"recording":"primary"}`,onClick:y,disabled:i,children:i?S.jsxs(S.Fragment,{children:[S.jsx("span",{className:"recording-dot-small"}),S.jsxs("span",{children:[" ",x,"%"]})]}):S.jsxs(S.Fragment,{children:[S.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[S.jsx("polygon",{points:"23,7 16,12 23,17"}),S.jsx("rect",{x:"1",y:"5",width:"15",height:"14",rx:"2",ry:"2"})]}),S.jsxs("span",{children:[" (",R,"s)"]})]})})]}),i&&S.jsxs("div",{className:"recording-indicator",children:[S.jsx("div",{className:"recording-dot"}),S.jsx("span",{children:"..."})]})]})});dc.displayName="PreviewArea";const bu=[{label:"",value:"system-ui, -apple-system, sans-serif"},{label:"Arial",value:"Arial, sans-serif"},{label:"Helvetica",value:"Helvetica, sans-serif"},{label:"Georgia",value:"Georgia, serif"},{label:"Times New Roman",value:'"Times New Roman", serif'},{label:"Courier New",value:'"Courier New", monospace'},{label:"Verdana",value:"Verdana, sans-serif"},{label:"Impact",value:"Impact, sans-serif"},{label:"Comic Sans MS",value:'"Comic Sans MS", cursive'}],Cm=[{label:"-",value:'"PingFang SC", sans-serif'},{label:"-",value:'"PingFang TC", sans-serif'},{label:"",value:'"STHeiti", sans-serif'},{label:"",value:'"STKaiti", serif'},{label:"",value:'"STSong", serif'},{label:"",value:'"STFangsong", serif'},{label:"",value:'"Hiragino Sans GB", sans-serif'},{label:"-",value:'"Heiti SC", sans-serif'},{label:"-",value:'"Songti SC", serif'},{label:"-",value:'"Kaiti SC", serif'}],_m=[{label:"",value:"300"},{label:"",value:"normal"},{label:"",value:"500"},{label:"",value:"bold"},{label:"",value:"800"}],Tm=[{label:"",value:"left",icon:""},{label:"",value:"center",icon:""},{label:"",value:"right",icon:""}],bm=({textConfig:t,onTextConfigChange:e,isExpanded:i,onToggleExpand:a})=>{var _,b,A,D,L,O,G,W,P,z,V,X;const[o,f]=T.useState([]),[c,p]=T.useState(!1),[d,g]=T.useState(!1),[v,m]=T.useState(""),[y,x]=T.useState(!1),w=async()=>{if("queryLocalFonts"in window)try{p(!0);const N=await window.queryLocalFonts(),Z=[...new Set(N.map(J=>J.family))].sort().map(J=>({label:J,value:`"${J}"`}));f(Z),x(!0)}catch(N){console.log(":",N),x(!1)}finally{p(!1)}};T.useEffect(()=>{"queryLocalFonts"in window&&navigator.permissions&&navigator.permissions.query({name:"local-fonts"}).then(N=>{N.state==="granted"&&w()}).catch(()=>{})},[]);const M=()=>{if(v.trim()){const N=`"${v.trim()}"`;e("fontFamily",N),m(""),g(!1)}};[...bu,...o];const R=(N,Z)=>{e(N,Z)},E=(N,Z)=>{e("textShadow",{...t.textShadow,[N]:Z})};return S.jsxs("div",{className:`text-control-panel ${i?"expanded":"collapsed"}`,children:[S.jsxs("div",{className:"section-header clickable",onClick:a,children:[S.jsxs("div",{className:"section-header-left",children:[S.jsx("span",{className:`expand-arrow ${i?"open":""}`,children:S.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"currentColor",children:S.jsx("path",{d:"M3 4.5L6 7.5L9 4.5",stroke:"currentColor",strokeWidth:"1.5",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})}),S.jsxs("span",{className:"section-title",children:[S.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{marginRight:8},children:[S.jsx("path",{d:"M4 7V4h16v3"}),S.jsx("path",{d:"M9 20h6"}),S.jsx("path",{d:"M12 4v16"})]}),""]})]}),S.jsx("div",{className:"text-toggle-wrapper",onClick:N=>N.stopPropagation(),children:S.jsx("div",{className:`toggle-switch ${t.enabled?"active":""}`,onClick:()=>R("enabled",!t.enabled)})})]}),i&&t.enabled&&S.jsxs("div",{className:"text-controls-content",children:[S.jsxs("div",{className:"control-item",children:[S.jsx("label",{className:"control-label",children:S.jsx("span",{children:""})}),S.jsx("textarea",{className:"text-input",value:t.text,onChange:N=>R("text",N.target.value),placeholder:"...",rows:2})]}),S.jsxs("div",{className:"control-item",children:[S.jsxs("label",{className:"control-label",children:[S.jsx("span",{children:""}),c&&S.jsx("span",{className:"loading-hint",children:"..."})]}),S.jsxs("select",{className:"control-select",value:t.fontFamily,onChange:N=>R("fontFamily",N.target.value),children:[S.jsx("optgroup",{label:"",children:bu.map(N=>S.jsx("option",{value:N.value,children:N.label},N.value))}),S.jsx("optgroup",{label:"",children:Cm.map(N=>S.jsx("option",{value:N.value,children:N.label},N.value))}),o.length>0&&S.jsx("optgroup",{label:"",children:o.map(N=>S.jsx("option",{value:N.value,children:N.label},N.value))})]}),S.jsxs("div",{className:"font-actions",children:[!y&&"queryLocalFonts"in window&&S.jsxs("button",{className:"font-action-btn",onClick:w,disabled:c,title:"",children:[S.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[S.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),S.jsx("polyline",{points:"7 10 12 15 17 10"}),S.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),""]}),S.jsxs("button",{className:"font-action-btn",onClick:()=>g(!d),title:"",children:[S.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[S.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),S.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),""]})]}),d&&S.jsxs("div",{className:"custom-font-input",children:[S.jsx("input",{type:"text",className:"text-input",placeholder:"",value:v,onChange:N=>m(N.target.value),onKeyDown:N=>N.key==="Enter"&&M()}),S.jsx("button",{className:"apply-font-btn",onClick:M,disabled:!v.trim(),children:""})]})]}),S.jsxs("div",{className:"control-item",children:[S.jsxs("label",{className:"control-label",children:[S.jsx("span",{children:""}),S.jsxs("span",{className:"control-value",children:[t.fontSize,"px"]})]}),S.jsx("input",{type:"range",min:12,max:500,step:1,value:t.fontSize,onChange:N=>R("fontSize",parseInt(N.target.value))})]}),S.jsxs("div",{className:"control-item",children:[S.jsx("label",{className:"control-label",children:S.jsx("span",{children:""})}),S.jsx("div",{className:"text-align-group",children:Tm.map(N=>S.jsx("button",{className:`text-align-btn ${t.textAlign===N.value?"active":""}`,onClick:()=>R("textAlign",N.value),title:N.label,children:S.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[N.value==="left"&&S.jsxs(S.Fragment,{children:[S.jsx("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),S.jsx("line",{x1:"3",y1:"12",x2:"15",y2:"12"}),S.jsx("line",{x1:"3",y1:"18",x2:"18",y2:"18"})]}),N.value==="center"&&S.jsxs(S.Fragment,{children:[S.jsx("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),S.jsx("line",{x1:"6",y1:"12",x2:"18",y2:"12"}),S.jsx("line",{x1:"4",y1:"18",x2:"20",y2:"18"})]}),N.value==="right"&&S.jsxs(S.Fragment,{children:[S.jsx("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),S.jsx("line",{x1:"9",y1:"12",x2:"21",y2:"12"}),S.jsx("line",{x1:"6",y1:"18",x2:"21",y2:"18"})]})]})},N.value))})]}),S.jsxs("div",{className:"control-item",children:[S.jsx("label",{className:"control-label",children:S.jsx("span",{children:""})}),S.jsx("select",{className:"control-select",value:t.fontWeight,onChange:N=>R("fontWeight",N.target.value),children:_m.map(N=>S.jsx("option",{value:N.value,children:N.label},N.value))})]}),S.jsxs("div",{className:"control-item",children:[S.jsxs("label",{className:"control-label",children:[S.jsx("span",{children:""}),S.jsx("span",{className:"control-value",children:t.color})]}),S.jsxs("div",{className:"color-picker-wrapper",children:[S.jsx("input",{type:"color",className:"color-picker-input",value:t.color,onChange:N=>R("color",N.target.value)}),S.jsx("span",{className:"color-hex",children:t.color})]})]}),S.jsxs("div",{className:"control-item",children:[S.jsxs("label",{className:"control-label",children:[S.jsx("span",{children:""}),S.jsxs("span",{className:"control-value",children:[Math.round(t.opacity*100),"%"]})]}),S.jsx("input",{type:"range",min:0,max:1,step:.05,value:t.opacity,onChange:N=>R("opacity",parseFloat(N.target.value))})]}),S.jsxs("div",{className:"control-item",children:[S.jsxs("label",{className:"control-label",children:[S.jsx("span",{children:""}),S.jsxs("span",{className:"control-value",children:[t.rotation,""]})]}),S.jsx("input",{type:"range",min:-180,max:180,step:1,value:t.rotation,onChange:N=>R("rotation",parseInt(N.target.value))})]}),S.jsx("div",{className:"control-item toggle-item",children:S.jsxs("label",{className:"control-label",children:[S.jsx("span",{children:""}),S.jsx("div",{className:`toggle-switch ${(_=t.textShadow)!=null&&_.enabled?"active":""}`,onClick:()=>{var N;return E("enabled",!((N=t.textShadow)!=null&&N.enabled))}})]})}),((b=t.textShadow)==null?void 0:b.enabled)&&S.jsxs(S.Fragment,{children:[S.jsxs("div",{className:"control-item",children:[S.jsx("label",{className:"control-label",children:S.jsx("span",{children:""})}),S.jsxs("div",{className:"color-picker-wrapper",children:[S.jsx("input",{type:"color",className:"color-picker-input",value:((A=t.textShadow)==null?void 0:A.color)||"#000000",onChange:N=>E("color",N.target.value)}),S.jsx("span",{className:"color-hex",children:((D=t.textShadow)==null?void 0:D.color)||"#000000"})]})]}),S.jsxs("div",{className:"control-item",children:[S.jsxs("label",{className:"control-label",children:[S.jsx("span",{children:""}),S.jsxs("span",{className:"control-value",children:[((L=t.textShadow)==null?void 0:L.blur)||0,"px"]})]}),S.jsx("input",{type:"range",min:0,max:100,step:1,value:((O=t.textShadow)==null?void 0:O.blur)||0,onChange:N=>E("blur",parseInt(N.target.value))})]}),S.jsxs("div",{className:"control-item",children:[S.jsxs("label",{className:"control-label",children:[S.jsx("span",{children:""}),S.jsxs("span",{className:"control-value",children:[((G=t.textShadow)==null?void 0:G.offsetX)||0,"px"]})]}),S.jsx("input",{type:"range",min:-50,max:50,step:1,value:((W=t.textShadow)==null?void 0:W.offsetX)||0,onChange:N=>E("offsetX",parseInt(N.target.value))})]}),S.jsxs("div",{className:"control-item",children:[S.jsxs("label",{className:"control-label",children:[S.jsx("span",{children:""}),S.jsxs("span",{className:"control-value",children:[((P=t.textShadow)==null?void 0:P.offsetY)||0,"px"]})]}),S.jsx("input",{type:"range",min:-50,max:50,step:1,value:((z=t.textShadow)==null?void 0:z.offsetY)||0,onChange:N=>E("offsetY",parseInt(N.target.value))})]}),S.jsxs("div",{className:"control-item",children:[S.jsxs("label",{className:"control-label",children:[S.jsx("span",{children:""}),S.jsxs("span",{className:"control-value",children:[((V=t.textShadow)==null?void 0:V.spread)||0,"px"]})]}),S.jsx("input",{type:"range",min:0,max:50,step:1,value:((X=t.textShadow)==null?void 0:X.spread)||0,onChange:N=>E("spread",parseInt(N.target.value))})]})]}),S.jsxs("div",{className:"text-hint",children:[S.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[S.jsx("circle",{cx:"12",cy:"12",r:"10"}),S.jsx("path",{d:"M12 16v-4"}),S.jsx("path",{d:"M12 8h.01"})]}),S.jsx("span",{children:""})]})]})]})},Pm=t=>{const[e,i]=T.useState(!1),[a,o]=T.useState(0),f=T.useRef(null),c=T.useRef(!1),p=(m,y,x=1)=>{const w=y.querySelector(".text-overlay");if(!w)return;const M=y.getBoundingClientRect(),R=w.getBoundingClientRect(),E=window.getComputedStyle(w),_=E.textAlign||"center";let b;_==="left"?b=(R.left-M.left)*x:_==="right"?b=(R.right-M.left)*x:b=(R.left-M.left+R.width/2)*x;const A=(R.top-M.top)*x;m.save();const D=parseFloat(E.fontSize)*x,L=E.fontWeight,O=E.fontFamily;m.font=`${L} ${D}px ${O}`,m.fillStyle=E.color,m.globalAlpha=parseFloat(E.opacity)||1,m.textAlign=_,m.textBaseline="top";const G=E.transform;if(G&&G!=="none"){const Z=G.match(/rotate\(([^)]+)\)/);if(Z){const J=parseFloat(Z[1])*Math.PI/180,te=(R.left-M.left+R.width/2)*x,k=(R.top-M.top+R.height/2)*x;m.translate(te,k),m.rotate(J),m.translate(-te,-k)}}const W=E.textShadow;if(W&&W!=="none"){const Z=W.match(/rgba?\([^)]+\)|#[0-9a-fA-F]+|[\d.-]+px/g);if(Z){let J="rgba(0,0,0,0.5)",te=0,k=0,F=0,U=0;Z.forEach(j=>{if(j.startsWith("rgb")||j.startsWith("#"))J=j;else if(j.includes("px")){const q=parseFloat(j);U===0?te=q:U===1?k=q:F=q,U++}}),m.shadowColor=J,m.shadowOffsetX=te*x,m.shadowOffsetY=k*x,m.shadowBlur=F*x}}const z=(w.innerText||w.textContent).split(`
`),V=D*1.2,X=parseFloat(E.paddingTop)*x||0,N=parseFloat(E.paddingLeft)*x||0;z.forEach((Z,J)=>{const te=A+X+J*V;let k=b;_==="left"?k=b+N:_==="right"&&(k=b-(parseFloat(E.paddingRight)*x||0)),m.fillText(Z,k,te)}),m.restore()},d=T.useCallback(async()=>{if(t.current)try{const m=t.current.querySelectorAll("canvas");if(!m.length){alert("");return}const y=t.current.getBoundingClientRect(),x=Math.floor(y.width),w=Math.floor(y.height),M=2,R=document.createElement("canvas");R.width=x*M,R.height=w*M;const E=R.getContext("2d"),_=t.current.style.backgroundColor||"#000000";E.fillStyle=_,E.fillRect(0,0,R.width,R.height),m.forEach(D=>{try{const L=D.getBoundingClientRect(),O=(L.left-y.left)*M,G=(L.top-y.top)*M,W=L.width*M,P=L.height*M;E.drawImage(D,O,G,W,P)}catch(L){console.warn(" canvas :",L)}}),p(E,t.current,M);const b=R.toDataURL("image/png",1),A=document.createElement("a");return A.download=`background-${Date.now()}.png`,A.href=b,A.click(),!0}catch(m){return console.error(":",m),alert(": "+m.message),!1}},[t]),g=T.useCallback(async(m=10)=>{if(t.current){if(e){c.current=!1,i(!1),o(0),f.current&&cancelAnimationFrame(f.current);return}try{const y=t.current.querySelectorAll("canvas");if(!y.length){alert("");return}const x=t.current.getBoundingClientRect(),w=Math.floor(x.width),M=Math.floor(x.height),R=document.createElement("canvas");R.width=Math.min(Math.floor(w*2/2)*2,1920),R.height=Math.min(Math.floor(M*2/2)*2,1080);const E=R.getContext("2d",{willReadFrequently:!0}),_=R.width/w,b=t.current.style.backgroundColor||"#000000",A=30,D=A*m,L=[];i(!0),c.current=!0,o(0);const O=t.current;let G=0;const W=()=>{if(!c.current||G>=D){v(L,R.width,R.height,A,m);return}E.fillStyle=b,E.fillRect(0,0,R.width,R.height),y.forEach(P=>{try{E.drawImage(P,0,0,R.width,R.height)}catch{}}),p(E,O,_),L.push(E.getImageData(0,0,R.width,R.height)),G++,o(Math.round(G/D*50)),f.current=requestAnimationFrame(W)};W()}catch(y){console.error(":",y),alert(": "+y.message),i(!1),c.current=!1}}},[t,e]),v=async(m,y,x,w,M)=>{try{o(50);const R=document.createElement("canvas");R.width=y,R.height=x;const E=R.getContext("2d"),_=R.captureStream(w);let b="video/webm;codecs=vp9",A="webm";MediaRecorder.isTypeSupported("video/mp4;codecs=avc1")?(b="video/mp4;codecs=avc1",A="mp4"):MediaRecorder.isTypeSupported("video/mp4")?(b="video/mp4",A="mp4"):MediaRecorder.isTypeSupported("video/webm;codecs=h264")?(b="video/webm;codecs=h264",A="webm"):MediaRecorder.isTypeSupported("video/webm;codecs=vp9")?(b="video/webm;codecs=vp9",A="webm"):(b="video/webm",A="webm");const D=new MediaRecorder(_,{mimeType:b,videoBitsPerSecond:15e6}),L=[];return D.ondataavailable=O=>{O.data.size>0&&L.push(O.data)},new Promise(O=>{D.onstop=()=>{const P=new Blob(L,{type:b}),z=URL.createObjectURL(P),V=document.createElement("a");V.download=`background-${M}s-${Date.now()}.${A}`,V.href=z,V.click(),URL.revokeObjectURL(z),i(!1),c.current=!1,o(0),O()},D.start();let G=0;const W=()=>{if(G>=m.length){D.stop();return}E.putImageData(m[G],0,0),G++,o(Math.round(G/m.length*50)+50),setTimeout(W,1e3/w)};W()})}catch(R){console.error(":",R),alert(": "+R.message),i(!1),c.current=!1,o(0)}};return{isRecording:e,recordingProgress:a,exportImage:d,toggleRecording:g}},km=()=>{var F,U;const[t,e]=T.useState("GradientBlinds"),[i,a]=T.useState({}),[o,f]=T.useState("#000000"),c=T.useRef(null),{isRecording:p,recordingProgress:d,exportImage:g,toggleRecording:v}=Pm(c),m=i.cycleDuration||10,[y,x]=T.useState(null),[w,M]=T.useState({enabled:!0,text:`ISUX
DESIGN`,fontSize:120,fontFamily:"Helvetica, sans-serif",fontWeight:"bold",color:"#ffffff",opacity:1,rotation:0,textAlign:"left",position:{x:0,y:0},textShadow:{enabled:!1,color:"#000000",blur:10,offsetX:2,offsetY:2,spread:0}}),[R,E]=T.useState(!1),[_,b]=T.useState(!1),[A,D]=T.useState(!1),L=Bn[t],O=L==null?void 0:L.component;T.useEffect(()=>{var q;const j=(q=Bn[t])==null?void 0:q.config;if(j){const $={};j.params.forEach(K=>{$[K.key]=K.default}),a($)}},[t]);const G=T.useCallback((j,q)=>{a($=>({...$,[j]:q}))},[]),W=T.useCallback((j,q="success")=>{x({message:j,type:q}),setTimeout(()=>x(null),3e3)},[]),P=T.useCallback(()=>{var q;const j=(q=Bn[t])==null?void 0:q.config;if(j){const $={};j.params.forEach(K=>{$[K.key]=K.default}),a($),W("")}},[t,W]),z=T.useCallback(()=>{var ie;const j=Object.keys(Bn),q=Math.floor(Math.random()*j.length),$=j[q],K=(ie=Bn[$])==null?void 0:ie.config;if(K){const oe={};K.params.forEach(de=>{var xe,he;if(de.excludeFromRandom){oe[de.key]=de.default;return}switch(de.type){case"range":const ae=de.max-de.min,we=de.min+Math.random()*ae,ue=de.step<1?((xe=String(de.step).split(".")[1])==null?void 0:xe.length)||2:0;oe[de.key]=Number(we.toFixed(ue));break;case"toggle":case"switch":oe[de.key]=Math.random()>.5;break;case"color":oe[de.key]="#"+Math.floor(Math.random()*16777215).toString(16).padStart(6,"0");break;case"colors":const Se=((he=de.default)==null?void 0:he.length)||3;oe[de.key]=Array.from({length:Se},()=>"#"+Math.floor(Math.random()*16777215).toString(16).padStart(6,"0"));break;case"select":const ve=de.options,se=Math.floor(Math.random()*ve.length),ze=ve[se];oe[de.key]=typeof ze=="object"?ze.value:ze;break;default:oe[de.key]=de.default}}),e($),a(oe);const me=K.nameCn||K.name;W(` ${me}`)}},[W]),V=T.useCallback(()=>{var q;const j=(q=Bn[t])==null?void 0:q.config;if(j){const $={};j.params.forEach(K=>{var ie,oe;if(K.excludeFromRandom){$[K.key]=K.default;return}switch(K.type){case"range":const me=K.max-K.min,de=K.min+Math.random()*me,xe=K.step<1?((ie=String(K.step).split(".")[1])==null?void 0:ie.length)||2:0;$[K.key]=Number(de.toFixed(xe));break;case"toggle":case"switch":$[K.key]=Math.random()>.5;break;case"color":$[K.key]="#"+Math.floor(Math.random()*16777215).toString(16).padStart(6,"0");break;case"colors":const he=((oe=K.default)==null?void 0:oe.length)||3;$[K.key]=Array.from({length:he},()=>"#"+Math.floor(Math.random()*16777215).toString(16).padStart(6,"0"));break;case"select":const ae=K.options,we=Math.floor(Math.random()*ae.length),ue=ae[we];$[K.key]=typeof ue=="object"?ue.value:ue;break;default:$[K.key]=K.default}}),a($),W("")}},[t,W]),X=T.useCallback(j=>{navigator.clipboard.writeText(j).then(()=>{W("")}).catch(()=>{W("","error")})},[W]),N=T.useCallback(async()=>{await g()&&W("")},[g,W]),Z=T.useCallback(async()=>{p||W(` (${m})`),await v(m)},[v,p,W,m]),J=T.useCallback((j,q)=>{M($=>({...$,[j]:q})),j==="enabled"&&q===!0&&E(!0)},[]),te=T.useCallback(()=>{D(j=>{const q=!j;return W(q?"":""),q})},[W]),k=T.useCallback(j=>{M(q=>({...q,position:j}))},[]);return S.jsxs("div",{className:"studio-container",children:[S.jsx(Rm,{backgrounds:Bn,backgroundList:Em,selectedBackground:t,onSelectBackground:e,params:i,onParamChange:G,onResetParams:P,onRandomizeParams:z,onRandomizeCurrentParams:V,backgroundColor:o,onBackgroundColorChange:f,onCopyCode:X,children:S.jsx(bm,{textConfig:w,onTextConfigChange:J,isExpanded:R,onToggleExpand:()=>E(!R)})}),S.jsx(dc,{ref:c,BackgroundComponent:O,params:i,isRecording:p,backgroundName:((F=L==null?void 0:L.config)==null?void 0:F.nameCn)||((U=L==null?void 0:L.config)==null?void 0:U.name)||t,backgroundColor:o,textConfig:w,onTextPositionChange:k,onTextChange:J,isTextEditing:_,onStartTextEdit:()=>b(!0),onEndTextEdit:()=>b(!1),onExportImage:N,onExportVideo:Z,recordingProgress:d,isFrozen:A,onToggleFreeze:te,videoDuration:m}),y&&S.jsx("div",{className:`toast ${y.type}`,children:y.message})]})},zm=()=>S.jsx(km,{});Bl.createRoot(document.getElementById("root")).render(S.jsx(Sf.StrictMode,{children:S.jsx(zm,{})}));
